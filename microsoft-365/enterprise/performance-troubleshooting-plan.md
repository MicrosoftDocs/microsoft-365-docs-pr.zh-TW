---
title: Office 365 的效能疑難排解規劃
ms.author: kvice
author: kelleyvice-msft
manager: laurawi
ms.date: 5/10/2019
audience: Admin
ms.topic: conceptual
ms.service: o365-administration
localization_priority: Normal
f1.keywords:
- CSH
ms.custom:
- Adm_O365
- seo-marvel-apr2020
search.appverid:
- MET150
- MOE150
- BCS160
ms.assetid: e241e5d9-b1d8-4f1d-a5c8-4106b7325f8c
ms.collection:
- M365-security-compliance
- Ent_O365
description: 本文可協助您疑難排解 Office 365 效能問題，甚至修正一些最常見的問題。
ms.openlocfilehash: 9287e2649a2eb126d723e7436a9178be93087bc0
ms.sourcegitcommit: 79065e72c0799064e9055022393113dfcf40eb4b
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/14/2020
ms.locfileid: "46688534"
---
# <a name="performance-troubleshooting-plan-for-office-365"></a><span data-ttu-id="f1f5b-103">Office 365 的效能疑難排解規劃</span><span class="sxs-lookup"><span data-stu-id="f1f5b-103">Performance troubleshooting plan for Office 365</span></span>

<span data-ttu-id="f1f5b-104">您需要知道採取哪些步驟來識別及修正 SharePoint 線上、商務用 Skype、Exchange Online 或商務用 Skype Online 及用戶端電腦之間的效能、懸掛及緩慢效能 OneDrive？</span><span class="sxs-lookup"><span data-stu-id="f1f5b-104">Do you need to know the steps to take to identify and fix lags, hangs, and slow performance between SharePoint Online, OneDrive for Business, Exchange Online, or Skype for Business Online, and your client computer?</span></span> <span data-ttu-id="f1f5b-105">在致電支援之前，本文可協助您疑難排解 Office 365 效能問題，甚至修正一些最常見的問題。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-105">Before you call support, this article can help you troubleshoot Office 365 performance issues and even fix some of the most common issues.</span></span>
  
<span data-ttu-id="f1f5b-106">本文實際上是一個範例行動計畫，您可以用來在發生問題時，捕獲有關效能問題的重要資料。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-106">This article is actually a sample action plan that you can use to capture valuable data about your performance issue as it's happening.</span></span> <span data-ttu-id="f1f5b-107">本文也包含一些最主要的問題。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-107">Some top issues are also included in this article.</span></span>

<span data-ttu-id="f1f5b-108">如果您是網路效能的新功能，而且想要制定長期計畫，以監視用戶端電腦與 Office 365 之間的效能，請參閱 [Office 365 效能調整和疑難排解-系統管理員和 IT 專業人員](performance-tuning-using-baselines-and-history.md)。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-108">If you're new to network performance and want to make a long term plan to monitor performance between your client machines and Office 365, take a look at [Office 365 performance tuning and troubleshooting - Admin and IT Pro](performance-tuning-using-baselines-and-history.md).</span></span>
  
## <a name="sample-performance-troubleshooting-action-plan"></a><span data-ttu-id="f1f5b-109">效能疑難排解的範例行動方案</span><span class="sxs-lookup"><span data-stu-id="f1f5b-109">Sample performance troubleshooting action plan</span></span>

<span data-ttu-id="f1f5b-110">此項行動計畫包含兩個部分;準備階段和記錄階段。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-110">This action plan contains two parts; a preparation phase, and a logging phase.</span></span> <span data-ttu-id="f1f5b-111">如果您現在有效能問題，而且需要進行資料收集，您可以立即開始使用此計畫。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-111">If you have a performance problem right now, and you need to do data collection, you can start using this plan right away.</span></span>
  
### <a name="prepare-the-client-computer"></a><span data-ttu-id="f1f5b-112">準備用戶端電腦</span><span class="sxs-lookup"><span data-stu-id="f1f5b-112">Prepare the client computer</span></span>
  
- <span data-ttu-id="f1f5b-113">尋找可能再現效能問題的用戶端電腦。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-113">Find a client computer that can reproduce the performance problem.</span></span> <span data-ttu-id="f1f5b-114">在疑難排解過程中，會使用此電腦。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-114">This computer will be used during the course of troubleshooting.</span></span>
- <span data-ttu-id="f1f5b-115">記下來引發效能問題的步驟，讓您在測試時做好準備。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-115">Write down the steps that cause the performance problem to happen so you're ready when it comes time to test.</span></span>
- <span data-ttu-id="f1f5b-116">安裝用來收集及錄製資訊的工具：</span><span class="sxs-lookup"><span data-stu-id="f1f5b-116">Install tools for gathering and recording information:</span></span>
  - <span data-ttu-id="f1f5b-117">安裝 [Netmon 3.4](https://www.microsoft.com/download/details.aspx?id=4865) (或使用對等網路追蹤工具) 。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-117">Install [Netmon 3.4](https://www.microsoft.com/download/details.aspx?id=4865) (or use an equivalent network tracing tool).</span></span>
  - <span data-ttu-id="f1f5b-118">安裝 [HTTPWatch](https://www.httpwatch.com/download/) 的免費基本版本 (或使用對等網路追蹤工具) 。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-118">Install the free Basic Edition of [HTTPWatch](https://www.httpwatch.com/download/) (or use an equivalent network Tracing tool).</span></span>
  - <span data-ttu-id="f1f5b-119">使用螢幕錄製器或執行 [步驟記錄器] ( Windows Vista 和更新版本隨附的 # A0) ，以便保留測試期間所採取的步驟記錄。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-119">Use a screen recorder or run the Steps Recorder (PSR.exe) that comes with Windows Vista and later, in order to keep a record of the steps you take during testing.</span></span>

### <a name="log-the-performance-issue"></a><span data-ttu-id="f1f5b-120">記錄效能問題</span><span class="sxs-lookup"><span data-stu-id="f1f5b-120">Log the performance issue</span></span>
  
- <span data-ttu-id="f1f5b-121">關閉所有多餘的網際網路瀏覽器。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-121">Close all extraneous Internet browsers.</span></span>
- <span data-ttu-id="f1f5b-122">啟動步驟記錄器或另一個螢幕錄製器。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-122">Start the Steps Recorder, or another screen recorder.</span></span>
- <span data-ttu-id="f1f5b-123">啟動 Netmon 捕獲 (或網路追蹤工具) 。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-123">Start your Netmon capture (or network tracing tool).</span></span>
- <span data-ttu-id="f1f5b-124">在用戶端電腦上輸入 ipconfig/flushdns.，從命令列清除您的 DNS 快取</span><span class="sxs-lookup"><span data-stu-id="f1f5b-124">Clear your DNS cache on the client computer from the command line by typing ipconfig /flushdns.</span></span>
- <span data-ttu-id="f1f5b-125">啟動新的瀏覽器會話，並開啟 HTTPWatch。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-125">Start a new browser session and turn on HTTPWatch.</span></span>
- <span data-ttu-id="f1f5b-126">選用：如果您要測試 Exchange Online，請從 Office 365 管理主控台執行 Exchange Client Performance Analyzer 工具。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-126">Optional: If you are testing Exchange Online, run the Exchange Client Performance Analyzer tool from the Office 365 admin console.</span></span>
- <span data-ttu-id="f1f5b-127">重現導致效能問題的確切步驟。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-127">Reproduce the exact steps that cause the performance issue.</span></span>
- <span data-ttu-id="f1f5b-128">停止 Netmon 或其他工具的追蹤。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-128">Stop your Netmon or other tool's trace.</span></span>
- <span data-ttu-id="f1f5b-129">在命令列中輸入下列命令，然後按 ENTER，以執行 Office 365 訂閱的追蹤路由：</span><span class="sxs-lookup"><span data-stu-id="f1f5b-129">At the command line, run a trace route to your Office 365 subscription by typing the following command and then pressing ENTER:</span></span>

  ``` cmd
  tracert <subscriptionname>.onmicrosoft.com
  ```

- <span data-ttu-id="f1f5b-130">停止步驟錄製器並儲存影片。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-130">Stop the Steps Recorder and save the video.</span></span> <span data-ttu-id="f1f5b-131">務必要包含捕獲的日期和時間，以及它是正確或不良的效能。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-131">Be sure to include the date and time of the capture and whether it demonstrates good or bad performance.</span></span>
- <span data-ttu-id="f1f5b-132">儲存追蹤檔案。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-132">Save the trace files.</span></span> <span data-ttu-id="f1f5b-133">同樣地，一定要包含捕獲的日期和時間，以及它是正確或不良的效能。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-133">Again, be sure to include the date and time of the capture and whether it demonstrates good or bad performance.</span></span>

<span data-ttu-id="f1f5b-134">如果您不熟悉如何執行本文所述的工具，請不要擔心，因為我們會在下一步提供這些步驟。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-134">If you're not familiar with running the tools mentioned in this article, don't worry because we provide those steps next.</span></span> <span data-ttu-id="f1f5b-135">如果您習慣執行這種網路捕獲，您可以略過 [收集基準](performance-tuning-using-baselines-and-history.md#how-to-collect-baselines)，以說明篩選和讀取記錄檔。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-135">If you're accustomed to doing this kind of network capturing, you can skip to [How to collect baselines](performance-tuning-using-baselines-and-history.md#how-to-collect-baselines), which describes filtering and reading the logs.</span></span>
  
### <a name="flush-the-dns-cache-first"></a><span data-ttu-id="f1f5b-136">先清除 DNS 快取</span><span class="sxs-lookup"><span data-stu-id="f1f5b-136">Flush the DNS Cache first</span></span>

<span data-ttu-id="f1f5b-137">為什麼？</span><span class="sxs-lookup"><span data-stu-id="f1f5b-137">Why?</span></span> <span data-ttu-id="f1f5b-138">透過使用全新的石板來開始測試，將會啟動您的測試。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-138">By flushing out the DNS cache you're starting your tests with a clean slate.</span></span> <span data-ttu-id="f1f5b-139">清除快取後，您會將 DNS 解析程式內容重設為最新的專案。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-139">By clearing the cache, you're resetting the DNS resolver contents to the most up-to-date entries.</span></span> <span data-ttu-id="f1f5b-140">請記住，清除不會移除主機檔專案。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-140">Remember that a flush does not remove HOSTs file entries.</span></span> <span data-ttu-id="f1f5b-141">如果您大量使用主機檔專案，則應該將這些專案複製到另一個目錄中的檔案，然後清空主機檔。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-141">If you use HOST file entries extensively, you should copy those entries out to a file in another directory and then empty the HOST file.</span></span>
  
#### <a name="flush-your-dns-resolver-cache"></a><span data-ttu-id="f1f5b-142">清除您的 DNS 解析程式快取</span><span class="sxs-lookup"><span data-stu-id="f1f5b-142">Flush your DNS resolver cache</span></span>
  
1. <span data-ttu-id="f1f5b-143">開啟命令提示字元， (**Start** \> **Run** \> **cmd** 或 **Windows key** \> **cmd**) 。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-143">Open the command prompt, (either **Start** \> **Run** \> **cmd** or **Windows key** \> **cmd**).</span></span>
2. <span data-ttu-id="f1f5b-144">輸入下列命令，然後按 ENTER：</span><span class="sxs-lookup"><span data-stu-id="f1f5b-144">Type the following command and press ENTER:</span></span>

    ``` cmd
    ipconfig /flushdns
    ```

## <a name="netmon"></a><span data-ttu-id="f1f5b-145">監視器</span><span class="sxs-lookup"><span data-stu-id="f1f5b-145">Netmon</span></span>

<span data-ttu-id="f1f5b-146">Microsoft 的網路監控工具 ([Netmon](https://www.microsoft.com/download/details.aspx?id=4865)) 會分析網路上的電腦之間傳送的封包（即流量）。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-146">Microsoft's Network Monitoring tool ([Netmon](https://www.microsoft.com/download/details.aspx?id=4865)) analyzes packets, that is traffic, that passes between computers on networks.</span></span> <span data-ttu-id="f1f5b-147">透過使用 Netmon 來追蹤使用 Office 365 的流量，您可以捕獲、查看和讀取封包標頭、識別介入的裝置、檢查網路硬體上的重要設定、尋找丟棄的封包，以及遵循公司網路與 Office 365 電腦之間的流量流程。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-147">By using Netmon to trace traffic with Office 365 you can capture, view, and read packet headers, identify intervening devices, check important settings on network hardware, look for dropped packets, and follow the flow of traffic between computers on your corporate network and Office 365.</span></span> <span data-ttu-id="f1f5b-148">由於流量的實際主體是加密的，也就是說，它 (透過 SSL/TLS 在埠443上傳輸，所以您無法讀取正在傳送的檔案。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-148">Because the actual body of the traffic is encrypted, that is, it(travels on port 443 via SSL/TLS, you can't read the files being sent.</span></span> <span data-ttu-id="f1f5b-149">相反地，您會取得封包所採取之路徑的未篩選追蹤，以協助您追蹤問題行為。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-149">Instead, you get an unfiltered trace of the path that the packet takes which can help you track down the problem behavior.</span></span>
  
<span data-ttu-id="f1f5b-150">現在請確定您沒有套用篩選器。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-150">Be sure you don't apply a filter at this time.</span></span> <span data-ttu-id="f1f5b-151">請改為執行步驟並示範問題，再停止追蹤和儲存。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-151">Instead, run through the steps and demonstrate the problem before stopping the trace and saving.</span></span>
  
<span data-ttu-id="f1f5b-152">安裝 Netmon 3.4 之後，請開啟工具並執行下列步驟：</span><span class="sxs-lookup"><span data-stu-id="f1f5b-152">After you install Netmon 3.4, open the tool and take these steps:</span></span>
  
### <a name="take-a-netmon-trace-and-reproduce-the-issue"></a><span data-ttu-id="f1f5b-153">進行 Netmon 追蹤並重現問題</span><span class="sxs-lookup"><span data-stu-id="f1f5b-153">Take a Netmon trace and reproduce the issue</span></span>
  
1. <span data-ttu-id="f1f5b-154">啟動 Netmon 3.4。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-154">Launch Netmon 3.4.</span></span>
<span data-ttu-id="f1f5b-155">**「開始」** 頁面上有三個窗格：「**最近的捕獲**」、「**網路**」和「 **Microsoft 網路監視器3.4 快速入門」。請注意**。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-155">There are three panes on the **Start** page: **Recent Captures**, **Select Networks**, and the **Getting Started with Microsoft Network Monitor 3.4. Notice**.</span></span> <span data-ttu-id="f1f5b-156">[選取網路] 面板也會提供您可以捕獲的預設網路清單。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-156">The Select Networks panel will also give you a list of the default networks from which you can capture.</span></span> <span data-ttu-id="f1f5b-157">請確定這裡已選取網卡。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-157">Be sure that network cards are selected here.</span></span>

2. <span data-ttu-id="f1f5b-158">在 [**開始**] 頁面的頂端，按一下 [**新增捕獲**]。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-158">Click **New Capture** at the top of the **Start** page.</span></span> <span data-ttu-id="f1f5b-159">這會在 [ **開始** 頁面] 索引標籤（稱為 **Capture 1**）旁新增一個索引標籤。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-159">This adds a new tab beside the **Start** page tab called **Capture 1**.</span></span>
<span data-ttu-id="f1f5b-160">![Netmon 的使用者介面，並反白顯示 [新增捕獲]、[啟動] 和 [停止] 按鈕。](../media/d4527d84-62ec-4301-82d5-e0166ff71f20.PNG)</span><span class="sxs-lookup"><span data-stu-id="f1f5b-160">![Netmon's user interface with the New Capture, Start, and Stop buttons highlighted.](../media/d4527d84-62ec-4301-82d5-e0166ff71f20.PNG)</span></span>

3. <span data-ttu-id="f1f5b-161">若要採取簡易捕獲，請按一下工具列上的 [ **啟動** ]。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-161">To take a simple capture, click **Start** on the toolbar.</span></span>

4. <span data-ttu-id="f1f5b-162">再現呈現效能問題的步驟。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-162">Reproduce the steps that present a performance issue.</span></span>

5. <span data-ttu-id="f1f5b-163">按一下 [**停止**檔案 \> **File** \> **另存**新檔]。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-163">Click **Stop** \> **File** \> **Save As**.</span></span> <span data-ttu-id="f1f5b-164">請記得為日期和時間提供時區，並提及其是否有不良或良好的效能。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-164">Remember to give the date and time with the time zone and to mention if it demonstrates bad or good performance.</span></span>

## <a name="httpwatch"></a><span data-ttu-id="f1f5b-165">HTTPWatch</span><span class="sxs-lookup"><span data-stu-id="f1f5b-165">HTTPWatch</span></span>

<span data-ttu-id="f1f5b-166">[HTTPWatch](https://www.httpwatch.com/download/) 會收費，也就是免費的 edition。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-166">[HTTPWatch](https://www.httpwatch.com/download/) comes in charged, and a free edition.</span></span> <span data-ttu-id="f1f5b-167">免費 Basic Edition 涵蓋此測試所需的一切。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-167">The free Basic Edition covers everything you need for this test.</span></span> <span data-ttu-id="f1f5b-168">HTTPWatch 會從瀏覽器視窗直接監視網路流量和頁面載入時間。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-168">HTTPWatch monitors network traffic and page load time right from your browser window.</span></span> <span data-ttu-id="f1f5b-169">HTTPWatch 是以圖形方式描述效能的 Internet Explorer 外掛程式。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-169">HTTPWatch is a plug-in to Internet Explorer that graphically describes performance.</span></span> <span data-ttu-id="f1f5b-170">分析可以儲存並在 HTTPWatch Studio 中查看。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-170">The analysis can be saved and viewed in HTTPWatch Studio.</span></span>
  
> [!NOTE]
> <span data-ttu-id="f1f5b-171">如果您使用另一個瀏覽器（例如 Firefox、Google Chrome），或是您無法在 Internet Explorer 中安裝 HTTPWatch，請開啟新的瀏覽器視窗，然後按鍵盤上的 F12 鍵。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-171">If you use another browser, such as Firefox, Google Chrome, or if you can't install HTTPWatch in Internet Explorer, open a new browser window and press F12 on your keyboard.</span></span> <span data-ttu-id="f1f5b-172">您應該會看到位於瀏覽器底部的開發人員工具快顯功能表。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-172">You should see the Developer Tool pop-up at the bottom of your browser.</span></span> <span data-ttu-id="f1f5b-173">如果您使用 Opera，請按 CTRL + SHIFT + I 做為 Web Inspector，然後按一下 [ **網路** ] 索引標籤，完成下列所述的測試。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-173">If you use Opera, press CTRL+SHIFT+I for Web Inspector, then click the **Network** tab and complete the testing outlined below.</span></span> <span data-ttu-id="f1f5b-174">此資訊會稍有不同，但是載入時間仍會以毫秒為單位顯示。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-174">The information will be slightly different, but load times will still be displayed in milliseconds.</span></span> <span data-ttu-id="f1f5b-175">> HTTPWatch 也對 SharePoint 線上頁面載入時間的問題非常有用。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-175">> HTTPWatch is also very useful for issues with SharePoint Online page load times.</span></span>
  
### <a name="run-httpwatch-and-reproduce-the-issue"></a><span data-ttu-id="f1f5b-176">執行 HTTPWatch 並重現問題</span><span class="sxs-lookup"><span data-stu-id="f1f5b-176">Run HTTPWatch and reproduce the issue</span></span>
  
<span data-ttu-id="f1f5b-177">HTTPWatch 為瀏覽器外掛程式，所以在瀏覽器中公開工具，每個版本的 Internet Explorer 會稍有不同。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-177">HTTPWatch is a browser plug-in, so exposing the tool in the browser is slightly different for each version of Internet Explorer.</span></span> <span data-ttu-id="f1f5b-178">一般來說，您可以在 Internet Explorer 瀏覽器的命令列下找到 HTTPWatch。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-178">Typically, you can find HTTPWatch under the Commands bar in the Internet Explorer browser.</span></span> <span data-ttu-id="f1f5b-179">如果您在瀏覽器視窗中看不到 HTTPWatch 外掛程式， **請按一下 [** 說明] \> ，或在 internet explorer 的較新版本中檢查您的瀏覽器 **版本，** 按一下齒輪符號及 [ **關於 internet explorer**]。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-179">If you don't see the HTTPWatch plug-in in your browser window, check the version of your browser by clicking **Help** \> **About**, or in later versions of Internet Explorer, click the gear symbol and **About Internet Explorer**.</span></span> <span data-ttu-id="f1f5b-180">若要啟動 **命令** 行，請在 Internet Explorer 中的功能表列上按一下滑鼠右鍵，然後按一下 [ **命令列**]。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-180">To launch the **Commands** bar, right-click the menu bar in Internet Explorer and click **Commands bar**.</span></span>

<span data-ttu-id="f1f5b-181">過去，HTTPWatch 已與命令和瀏覽器列產生關聯，請在安裝之後，如果您在重新開機) 檢查 **工具**，以及圖示的工具列上，您未立即看到圖示 (。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-181">In the past, HTTPWatch has been associated with both the Commands and the Explorer bars, so once you install, if you don't immediately see the icon (even after reboot) check **Tools**, and your toolbars for the icon.</span></span> <span data-ttu-id="f1f5b-182">請記住，可以自訂工具列，也可以新增選項。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-182">Remember that toolbars can be customized and options can be added to them.</span></span>

![顯示 HTTPWatch 圖示的 Internet Explorer 命令工具列。](../media/198590b0-d7b1-4bff-a6ad-e4ec3a1e83df.png)
  
1. <span data-ttu-id="f1f5b-184">在 Internet Explorer 瀏覽器視窗中啟動 HTTPWatch。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-184">Launch HTTPWatch in an Internet Explorer browser window.</span></span> <span data-ttu-id="f1f5b-185">它會顯示在該視窗底部的瀏覽器上。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-185">It will appear docked to the browser at the bottom of that window.</span></span> <span data-ttu-id="f1f5b-186">按一下 [ **記錄**]。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-186">Click **Record**.</span></span>

2. <span data-ttu-id="f1f5b-187">重現效能問題中的確切步驟。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-187">Reproduce the exact steps involved in the performance issue.</span></span> <span data-ttu-id="f1f5b-188">在 HTTPWatch 中按一下 [ **停止** ] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-188">Click the **Stop** button in HTTPWatch.</span></span>

3. <span data-ttu-id="f1f5b-189">**儲存** HTTPWatch 或透過 **電子郵件傳送**。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-189">**Save** the HTTPWatch or **Send by Email**.</span></span> <span data-ttu-id="f1f5b-190">請記得命名該檔案，使其包含日期及時間資訊，以及您的觀賞是否包含良好或不良效能的示範。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-190">Remember to name the file so that it includes date and time information and an indication of whether your Watch contains a demonstration of good or bad performance.</span></span>

![HTTPWatch，顯示 Office 365 首頁的頁面載入之 [網路] 索引標籤。](../media/021a2c64-d581-49fd-adf4-4c364f589d75.PNG)

<span data-ttu-id="f1f5b-192">這個螢幕擷取畫面來自 HTTPWatch 的專業版。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-192">This screen shot is from the Professional version of HTTPWatch.</span></span> <span data-ttu-id="f1f5b-193">您可以在具有專業版本的電腦上，開啟基本版本中所進行的追蹤，並閱讀該電腦上的追蹤。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-193">You can open traces taken in the Basic Version on a computer with a Professional version and read it there.</span></span> <span data-ttu-id="f1f5b-194">透過該方法，可在追蹤中取得額外資訊。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-194">Extra information may be available from the trace through that method.</span></span>

## <a name="problem-steps-recorder"></a><span data-ttu-id="f1f5b-195">問題步驟記錄器</span><span class="sxs-lookup"><span data-stu-id="f1f5b-195">Problem Steps Recorder</span></span>

<span data-ttu-id="f1f5b-196">步驟記錄器或 PSR.exe 可讓您記錄發生的問題。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-196">Steps Recorder, or PSR.exe, allows you to record issues as they are occurring.</span></span> <span data-ttu-id="f1f5b-197">這是非常實用的工具，而且非常易於執行。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-197">It's a very useful tool and very simple to run.</span></span>
  
### <a name="run-problem-steps-recorder-psrexe-to-record-your-work"></a><span data-ttu-id="f1f5b-198">執行問題步驟錄影機 ( # A0) 錄製您的工作</span><span class="sxs-lookup"><span data-stu-id="f1f5b-198">Run Problem Steps Recorder (PSR.exe) to record your work</span></span>
  
1. <span data-ttu-id="f1f5b-199">使用 **開始** \> **執行** \> 類型 **PSR.exe** \> **確定**，或按一下 **Windows 鍵** \> 類型 **PSR.exe** \> 然後按 ENTER 鍵。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-199">Either use **Start** \> **Run** \> type **PSR.exe** \> **OK**, or, click the **Windows Key** \> type **PSR.exe** \> and then press ENTER.</span></span>

2. <span data-ttu-id="f1f5b-200">當 [小型 PSR.exe] 視窗出現時，請按一下 [ **開始記錄** ] 並重現再現效能問題的步驟。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-200">When the small PSR.exe window appears, click **Start Record** and reproduce the steps that reproduce the performance issue.</span></span> <span data-ttu-id="f1f5b-201">您可以視需要新增批註（按一下 [ **新增批註**]）。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-201">You can add comments as needed, by clicking **Add Comments**.</span></span>

3. <span data-ttu-id="f1f5b-202">完成步驟後，按一下 [ **停止錄製** ]。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-202">Click **Stop Record** when you have completed the steps.</span></span> <span data-ttu-id="f1f5b-203">如果效能問題是頁面轉譯，請等到頁面轉譯後，再停止錄製。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-203">If the performance issue is a page render, wait for the page to render before you stop the recording.</span></span>

4. <span data-ttu-id="f1f5b-204">按一下 **[儲存]**。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-204">Click **Save**.</span></span>

![步驟記錄器或 PSR.exe 的螢幕擷取畫面。](../media/8542b0aa-a3ff-4718-8dc4-43f5521c6c34.PNG)
  
<span data-ttu-id="f1f5b-206">會為您記錄日期和時間。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-206">The date and time is recorded for you.</span></span> <span data-ttu-id="f1f5b-207">這會將您的 PSR 連結到 Netmon 追蹤和 HTTPWatch 時間，並協助精確度疑難排解。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-207">This links your PSR to your Netmon trace and HTTPWatch in time, and helps with precision troubleshooting.</span></span> <span data-ttu-id="f1f5b-208">PSR 記錄中的日期和時間會顯示一分鐘，可在 URL 的登入與流覽及管理網站的部分轉譯（例如）之間傳遞。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-208">The date and time in the PSR record can show that a minute passed between the login and browsing of the URL and the partial render of the admin site, for example.</span></span>
  
## <a name="read-your-traces"></a><span data-ttu-id="f1f5b-209">閱讀追蹤</span><span class="sxs-lookup"><span data-stu-id="f1f5b-209">Read your traces</span></span>

<span data-ttu-id="f1f5b-210">您無法講授網路和效能疑難排解的所有事項，因為有人必須透過文章瞭解。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-210">It isn't possible to teach everything about network and performance troubleshooting that someone would need to know via an article.</span></span> <span data-ttu-id="f1f5b-211">取得良好效能的經驗，以及您的網路運作方式及一般執行方式的知識。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-211">Getting good at performance takes experience, and knowledge of how your network works and usually performs.</span></span> <span data-ttu-id="f1f5b-212">不過，您可以將首要問題的清單加以舍入，並示範工具如何更輕鬆地消除最常見的問題。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-212">But it is possible to round up a list of top issues and show how tools can make it easier for you to eliminate the most common problems.</span></span>
  
<span data-ttu-id="f1f5b-213">如果您想要為您的 Office 365 網站挑選技能讀取網路追蹤，就不會有更好的教師定期建立頁面載入追蹤，並取得閱讀經驗。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-213">If you want to pick up skills reading network traces for your Office 365 sites, there is no better teacher than creating traces of page loads regularly and gaining experience reading them.</span></span> <span data-ttu-id="f1f5b-214">例如，當您有機會時，請載入 Office 365 服務並追蹤處理常式。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-214">For example, when you have a chance, load an Office 365 service and trace the process.</span></span> <span data-ttu-id="f1f5b-215">篩選追蹤的 DNS 流量，或在 FrameData 中搜尋您所流覽之服務的名稱。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-215">Filter the trace for DNS traffic, or search the FrameData for the name of the service you browsed.</span></span> <span data-ttu-id="f1f5b-216">掃描追蹤以瞭解服務載入時所發生的步驟。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-216">Scan the trace to get an idea of the steps that occur when the service loads.</span></span> <span data-ttu-id="f1f5b-217">這將協助您瞭解一般的頁面負載應類似的情況，而且在疑難排解的情況下，尤其是在效能中，比較好的追蹤不良追蹤可能會非常教您。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-217">This will help you learn what normal page load should look like, and in the case of troubleshooting, particularly around performance, comparing good to bad traces can teach you a lot.</span></span>
  
<span data-ttu-id="f1f5b-218">Netmon 會在顯示篩選欄位中使用 Microsoft Intellisense。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-218">Netmon uses Microsoft Intellisense in the Display filter field.</span></span> <span data-ttu-id="f1f5b-219">Intellisense 或智慧程式碼完成，是指您在期間內輸入的秘訣和所有可用選項會顯示在下拉式選取範圍中。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-219">Intellisense, or intelligent code completion, is that trick where you type in a period and all available options are displayed in a drop-down selection box.</span></span> <span data-ttu-id="f1f5b-220">例如，如果您擔心 TCP 視窗縮放，您可以尋找篩選 (例如  `.protocol.tcp.window < 100` 此方式) 。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-220">If, for example, you are worried about TCP window scaling, you can find your way to a filter (such as  `.protocol.tcp.window < 100`) by this means.</span></span>
  
![Netmon 的螢幕擷取畫面，顯示 [顯示篩選] 欄位使用 intellisense。](../media/75a56c11-9a60-47ee-a100-aabdfb1ba10f.PNG)
  
<span data-ttu-id="f1f5b-222">Netmon 追蹤可能會有許多流量。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-222">Netmon traces can have a lot of traffic in them.</span></span> <span data-ttu-id="f1f5b-223">如果您沒有閱讀過的經驗，您可能會在第一次開啟追蹤時淹沒。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-223">If you aren't experienced with reading them, it's likely you will be overwhelmed opening the trace the first time.</span></span> <span data-ttu-id="f1f5b-224">您要做的第一件事是在追蹤時，將背景雜音的信號分開。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-224">The first thing to do is separate the signal from the background noise in the trace.</span></span> <span data-ttu-id="f1f5b-225">您可以對照 Office 365 進行測試，這就是您想要看到的流量。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-225">You tested against Office 365, and that's the traffic you want to see.</span></span> <span data-ttu-id="f1f5b-226">如果您使用流覽追蹤，您可能不需要此清單。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-226">If you are used to navigating through traces, you may not need this list.</span></span>
  
<span data-ttu-id="f1f5b-227">您的用戶端和 Office 365 之間的流量透過 TLS 進行，這表示流量的主體會加密，而且在一般 Netmon 追蹤中不可讀取。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-227">Traffic between your client and Office 365 travels via TLS, which means that the body of the traffic will be encrypted and not readable in a generic Netmon trace.</span></span> <span data-ttu-id="f1f5b-228">您的性能分析不需要知道資料包中的資訊細節。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-228">Your performance analysis doesn't need to know the specifics of the information in the packet.</span></span> <span data-ttu-id="f1f5b-229">不過，它非常關心封包標頭及其所包含的資訊。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-229">It is, however, very interested in packet headers and the information that they contain.</span></span>
  
### <a name="tips-to-get-a-good-trace"></a><span data-ttu-id="f1f5b-230">取得好追蹤的秘訣</span><span class="sxs-lookup"><span data-stu-id="f1f5b-230">Tips to get a good trace</span></span>
  
- <span data-ttu-id="f1f5b-231">知道用戶端電腦 IPv4 或 IPv6 位址的值。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-231">Know the value of the IPv4 or IPv6 address of your client computer.</span></span> <span data-ttu-id="f1f5b-232">您可以在命令提示字元中輸入 **IPConfig** ，然後按 enter 鍵來取得。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-232">You can get this from the command prompt by typing **IPConfig** and then pressing ENTER.</span></span> <span data-ttu-id="f1f5b-233">知道此位址可讓您快速瞭解追蹤中的流量是否直接包含用戶端電腦。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-233">Knowing this address will let you tell at a glance whether the traffic in the trace directly involves your client computer.</span></span> <span data-ttu-id="f1f5b-234">如果有已知 proxy，請 ping 它，並同時取得其 IP 位址。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-234">If there is a known proxy, ping it and get its IP address as well.</span></span>

- <span data-ttu-id="f1f5b-235">請清除您的 DNS 解析程式快取，並在可能的情況下，關閉所有執行測試的瀏覽器以外的瀏覽器。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-235">Flush your DNS resolver cache and, if possible, close all browsers except the one in which you are running your tests.</span></span> <span data-ttu-id="f1f5b-236">例如，如果支援使用某些瀏覽器型工具來查看用戶端電腦的桌面，請先準備好篩選追蹤。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-236">If you are not able to do this, for instance, if support is using some browser-based tool to see your client computer's desktop, be prepared to filter your trace.</span></span>

- <span data-ttu-id="f1f5b-237">在 [繁忙追蹤] 中，找出您所使用的 Office 365 服務。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-237">In a busy trace, locate the Office 365 service that you're using.</span></span> <span data-ttu-id="f1f5b-238">如果您以前從未或很少看到您的流量，這是將效能問題與其他網路噪音分開的有用步驟。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-238">If you've never or seldom seen your traffic before, this is a helpful step in separating the performance issue from other network noise.</span></span> <span data-ttu-id="f1f5b-239">有幾種方式可以做到這一點。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-239">There are a few ways to do this.</span></span> <span data-ttu-id="f1f5b-240">在測試之前，您可以對特定服務 (的 URL 使用 _ping_ 或 _PsPing_ `ping outlook.office365.com` `psping -4 microsoft-my.sharepoint.com:443` ，例如) 。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-240">Directly before your test, you can use _ping_ or _PsPing_ against the URL of the specific service (`ping outlook.office365.com` or `psping -4 microsoft-my.sharepoint.com:443`, for example).</span></span> <span data-ttu-id="f1f5b-241">您也可以在 Netmon 追蹤 (中輕鬆找到該 ping 或 PsPing，其進程名稱) 。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-241">You can also easily find that ping or PsPing in a Netmon trace (by its process name).</span></span> <span data-ttu-id="f1f5b-242">這將提供您開始查看的位置。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-242">That will give you a place to start looking.</span></span>

<span data-ttu-id="f1f5b-243">如果發生問題時，您只是使用 Netmon 追蹤，也沒關係。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-243">If you're only using Netmon tracing at the time of the problem, that's okay too.</span></span> <span data-ttu-id="f1f5b-244">若要自行確定方向，請使用類似或的篩選 `ContainsBin(FrameData, ASCII, "office")` `ContainsBin(FrameData, ASCII, "outlook")` 。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-244">To orient yourself, use a filter like `ContainsBin(FrameData, ASCII, "office")` or `ContainsBin(FrameData, ASCII, "outlook")`.</span></span> <span data-ttu-id="f1f5b-245">您可以從追蹤檔案錄製您的框架編號。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-245">You can record your frame number from the trace file.</span></span> <span data-ttu-id="f1f5b-246">您也可以將 [ _框架摘要_ ] 窗格向右移動，並尋找 [交談識別碼] 欄。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-246">You may also want to scroll the _Frame Summary_ pane all the way to the right and look for the Conversation ID column.</span></span> <span data-ttu-id="f1f5b-247">您也可以在此顯示特定交談的識別碼，以日後進行記錄和查看。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-247">There is a number indicated there for the ID of this specific conversation that you can also record and look at in isolation later.</span></span> <span data-ttu-id="f1f5b-248">請記得先移除此篩選器，再套用其他任何篩選。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-248">Remember to remove this filter before applying any other filtering.</span></span>

> [!TIP]
> <span data-ttu-id="f1f5b-249">Netmon 具有許多有用的內建篩選。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-249">Netmon has a lot of helpful built-in filters.</span></span> <span data-ttu-id="f1f5b-250">嘗試 [_顯示_篩選] 窗格頂端的 [**負載篩選**] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-250">Try the **Load Filter** button at the top of the _Display_ filter pane.</span></span>
  
![在用戶端電腦上的命令列中使用 PSPing，尋找您的 IP。](../media/4c43ac67-e28e-4536-842d-7add7aa28847.PNG)
  
![來自用戶端的 Netmon 追蹤會透過篩選 TCP 顯示相同的 PSPing 命令。旗標。 Syn = = 1。](../media/0ae7ef7d-e003-4d01-a006-dc49bd1fcef2.PNG)
  
<span data-ttu-id="f1f5b-253">熟悉您的流量，並瞭解如何找到您需要的資訊。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-253">Get familiar with your traffic, and learn to locate the information you need.</span></span> <span data-ttu-id="f1f5b-254">例如，瞭解如何使用 (例如 "Outlook" ) ，判斷追蹤中的哪個封包具有您所使用的 Office 365 服務的第一個參考。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-254">For example, learn to determine which packet in the trace has the first reference to the Office 365 service you're using (like "Outlook").</span></span>

<span data-ttu-id="f1f5b-255">採用 Office 365 Outlook Online 範例，流量的開始如下：</span><span class="sxs-lookup"><span data-stu-id="f1f5b-255">Taking Office 365 Outlook Online as an example, the traffic begins something like this:</span></span>
  
- <span data-ttu-id="f1f5b-256">具有相符 QueryIDs 之 outlook.office365.com 的 DNS 標準查詢和 DNS 回應。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-256">DNS Standard Query and DNS Response for outlook.office365.com with matching QueryIDs.</span></span> <span data-ttu-id="f1f5b-257">請務必記下此轉彎的時間偏移量，以及 Office 365 全域 DNS 會傳送名稱解析要求的位置。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-257">It's important to note the time offset for this turn-around, as well as where in the world the Office 365 Global DNS sends the request for name resolution.</span></span> <span data-ttu-id="f1f5b-258">最理想的方式是從本機，而不是世界的一半。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-258">Ideally, as locally as possible, rather than halfway across the world.</span></span>

- <span data-ttu-id="f1f5b-259">其狀態報表已永久移動的 HTTP GET 要求 (301) </span><span class="sxs-lookup"><span data-stu-id="f1f5b-259">A HTTP GET Request whose status report Moved Permanently (301)</span></span>

- <span data-ttu-id="f1f5b-260">RWS 流量包括 RWS Connect requests 和 Connect 回復。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-260">RWS Traffic including RWS Connect requests and Connect replies.</span></span> <span data-ttu-id="f1f5b-261"> (此為您建立連線的遠端 Winsock。 ) </span><span class="sxs-lookup"><span data-stu-id="f1f5b-261">(This is Remote Winsock making a connection for you.)</span></span>

- <span data-ttu-id="f1f5b-262">TCP SYN 和 TCP SYN/ACK 交談。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-262">A TCP SYN and TCP SYN/ACK conversation.</span></span> <span data-ttu-id="f1f5b-263">此對話中的許多設定會影響您的效能。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-263">A lot of the settings in this conversation impact your performance.</span></span>

- <span data-ttu-id="f1f5b-264">然後是一系列的 TLS： tls 握手和 TLS 憑證交談所在的 tls 流量。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-264">Then a series of TLS:TLS traffic which is where the TLS handshake and TLS certificate conversations take place.</span></span> <span data-ttu-id="f1f5b-265"> (記得資料是透過 SSL/TLS 加密。 ) </span><span class="sxs-lookup"><span data-stu-id="f1f5b-265">(Remember the data is encrypted via SSL/TLS.)</span></span>

<span data-ttu-id="f1f5b-266">流量的所有部分都很重要且已連接，但是部分追蹤的小部分包含有關效能疑難排解的資訊，因此我們將重點放在這些區域。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-266">All parts of the traffic are important and connected, but small portions of the trace contain information particularly important in terms of performance troubleshooting, so we'll focus on those areas.</span></span> <span data-ttu-id="f1f5b-267">另外，由於我們已完成 Microsoft 的 Office 365 效能疑難排解，所以若要編譯前10個常見問題清單，我們將著重討論這些問題，以及如何使用我們所需的工具，讓您在下一個位置找到。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-267">Also, since we've done enough Office 365 performance troubleshooting at Microsoft to compile a Top Ten list of common problems, we'll focus on those issues and how to use the tools we have to root them out next.</span></span>
  
<span data-ttu-id="f1f5b-268">如果尚未安裝所有的現有工具，請使用下列矩陣進行數項工具。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-268">If you haven't installed them all ready, the matrix below makes use of several tools.</span></span> <span data-ttu-id="f1f5b-269">盡可能。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-269">Where possible.</span></span> <span data-ttu-id="f1f5b-270">在安裝點中提供連結。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-270">Links are provided to the installation points.</span></span> <span data-ttu-id="f1f5b-271">此清單包含常見網路追蹤工具（例如 [Netmon](https://www.microsoft.com/download/details.aspx?id=4865) 和 [Wireshark](https://www.wireshark.org/)），但使用您熟悉的任何追蹤工具，而且您習慣于篩選網路流量。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-271">The list includes common network tracing tools like [Netmon](https://www.microsoft.com/download/details.aspx?id=4865) and [Wireshark](https://www.wireshark.org/), but use any tracing tool you are comfortable with, and in which you're accustomed to filtering network traffic.</span></span> <span data-ttu-id="f1f5b-272">當您進行測試時，請記得：</span><span class="sxs-lookup"><span data-stu-id="f1f5b-272">When you're testing, remember:</span></span>
  
- <span data-ttu-id="f1f5b-273">*關閉您的瀏覽器，並僅在執行一個瀏覽器的情況下進行測試*  -這會降低所捕獲的整體流量。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-273">*Close your browsers, and test with only one browser running*  - This will reduce the overall traffic you capture.</span></span> <span data-ttu-id="f1f5b-274">它會進行較少的繁忙追蹤。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-274">It makes for a less busy trace.</span></span>
- <span data-ttu-id="f1f5b-275">*在用戶端電腦上清除您的 DNS 解析程式*  快取-這可在您開始進行捕獲時，提供全新的蓋板，以供清除追蹤。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-275">*Flush your DNS resolver cache on the client computer*  - This will give you a clean slate when you start to take your capture, for a cleaner trace.</span></span>

## <a name="common-issues"></a><span data-ttu-id="f1f5b-276">常見問題</span><span class="sxs-lookup"><span data-stu-id="f1f5b-276">Common issues</span></span>

<span data-ttu-id="f1f5b-277">您可能面臨的一些常見問題，以及如何在網路追蹤中尋找這些問題。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-277">Some common issues you may face and how to find them in your Network trace.</span></span>

### <a name="tcp-windows-scaling"></a><span data-ttu-id="f1f5b-278">TCP 視窗擴充</span><span class="sxs-lookup"><span data-stu-id="f1f5b-278">TCP Windows Scaling</span></span>

<span data-ttu-id="f1f5b-279">在 SYN-SYN/ACK 中找到。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-279">Found in the SYN - SYN/ACK.</span></span> <span data-ttu-id="f1f5b-280">傳統或計齡硬體可能不會利用 TCP windows 擴充功能。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-280">Legacy or aging hardware may not take advantage of TCP windows scaling.</span></span>  <span data-ttu-id="f1f5b-281">若沒有適當的 TCP 視窗擴充設定，TCP 標頭中的預設16位緩衝區會填滿毫秒。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-281">Without proper TCP windows scaling settings, the default 16-bit buffer in TCP headers fills in milliseconds.</span></span>  <span data-ttu-id="f1f5b-282">流量無法繼續傳送，直到用戶端收到已接收到原始資料的確認，從而導致延遲。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-282">Traffic cannot continue to send until the client receives an acknowledgment that the original data has been received, causing delays.</span></span>

#### <a name="tools"></a><span data-ttu-id="f1f5b-283">工具</span><span class="sxs-lookup"><span data-stu-id="f1f5b-283">Tools</span></span>

- <span data-ttu-id="f1f5b-284">監視器</span><span class="sxs-lookup"><span data-stu-id="f1f5b-284">Netmon</span></span>
- <span data-ttu-id="f1f5b-285">Wireshark</span><span class="sxs-lookup"><span data-stu-id="f1f5b-285">Wireshark</span></span>

#### <a name="what-to-look-for"></a><span data-ttu-id="f1f5b-286">要尋找的專案</span><span class="sxs-lookup"><span data-stu-id="f1f5b-286">What to look for</span></span>

<span data-ttu-id="f1f5b-287">在網路追蹤中尋找 SYN-SYN/ACK 流量。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-287">Look for the SYN - SYN/ACK traffic in your network trace.</span></span>  <span data-ttu-id="f1f5b-288">在 Netmon 中，使用類似的篩選器  `tcp.flags.syn == 1` 。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-288">In Netmon, use a filter like  `tcp.flags.syn == 1`.</span></span> <span data-ttu-id="f1f5b-289">在 Wireshark 中此篩選器是相同的。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-289">This filter is the same in Wireshark.</span></span>  

![篩選 Netmon 或 Wireshark 中的兩個工具： TCP 的 Syn 封包。旗標。 Syn = = 1。](../media/4b9a12a1-c915-43c8-ac2f-a679d0435a29.PNG)

<span data-ttu-id="f1f5b-291">請注意，每個 SYN 都有一個來源埠 (SrcPort) 編號會在目的地埠 (DstPort) （如相關的認可 (SYN/ACK) ）。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-291">Notice that for every SYN there is a source port (SrcPort) number that is matched in the destination port (DstPort) of the related Acknowledgment (SYN/ACK).</span></span>

<span data-ttu-id="f1f5b-292">若要查看網路連線所使用的 Windows 縮放值，請先展開 SYN，然後再展開相關的 SYN/ACK。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-292">To see the Windows Scaling value that is used by your network connection, expand first the SYN, and then the related SYN/ACK.</span></span>  

![顯示如何在追蹤中將 SrcPort 與 DstPort 相符的圖形，以取得時間差。](../media/6a4ca573-0253-4fbd-93e8-92821ee1c351.png)  

### <a name="tcp-idle-time-settings"></a><span data-ttu-id="f1f5b-294">TCP 閒置時間設定</span><span class="sxs-lookup"><span data-stu-id="f1f5b-294">TCP Idle Time Settings</span></span>

<span data-ttu-id="f1f5b-295">在過去，大部分周邊網路都是針對暫時性的連線進行設定，這表示一般會終止閒置連線。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-295">Historically, most perimeter networks are configured for transient connections, meaning idle connections are generally terminated.</span></span> <span data-ttu-id="f1f5b-296">閒置的 TCP 會話可由 proxy 和防火牆終止超過100到300秒。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-296">Idle TCP sessions can be terminated by proxies and firewalls at greater than 100 to 300 seconds.</span></span> <span data-ttu-id="f1f5b-297">這對 Outlook Online 是有問題的，因為它會建立及使用長期連線，不論是否閒置。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-297">This is problematic for Outlook Online because it creates and uses long-term connections, whether they are idle or not.</span></span>  

<span data-ttu-id="f1f5b-298">當 proxy 或防火牆裝置終止連線時，系統不會通知用戶端，而且嘗試使用 Outlook Online 會表示用戶端電腦會嘗試重複，以 revive 連線，然後再進行新的連接。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-298">When connections are terminated by proxy or firewall devices, the client is not informed, and an attempt to use Outlook Online will mean a client computer will try, repeatedly, to revive the connection before making a new one.</span></span> <span data-ttu-id="f1f5b-299">頁面載入時，您可能會看到產品中的懸掛、提示或降低效能。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-299">You may see hangs in the product, prompts, or slow performance on page load.</span></span>

#### <a name="tools"></a><span data-ttu-id="f1f5b-300">工具</span><span class="sxs-lookup"><span data-stu-id="f1f5b-300">Tools</span></span>

- <span data-ttu-id="f1f5b-301">監視器</span><span class="sxs-lookup"><span data-stu-id="f1f5b-301">Netmon</span></span>
- <span data-ttu-id="f1f5b-302">Wireshark</span><span class="sxs-lookup"><span data-stu-id="f1f5b-302">Wireshark</span></span>

#### <a name="what-to-look-for"></a><span data-ttu-id="f1f5b-303">要尋找的專案</span><span class="sxs-lookup"><span data-stu-id="f1f5b-303">What to look for</span></span>

<span data-ttu-id="f1f5b-304">在 Netmon 中，查看往返行程的 [時間偏移] 欄位。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-304">In Netmon, look at the Time Offset field for a round-trip.</span></span> <span data-ttu-id="f1f5b-305">來回行程是用戶端將要求傳送至伺服器及接收回應的時間。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-305">A round-trip is the time between client sending a request to the server and receiving a response back.</span></span> <span data-ttu-id="f1f5b-306">檢查用戶端與出局點之間 (ex。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-306">Check between the Client and the egress point (ex.</span></span> <span data-ttu-id="f1f5b-307">用戶端-- \> Proxy) ，或用戶端至 office 365 (client-- \> office 365) 。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-307">Client --\> Proxy), or the Client to Office 365 (Client --\> Office 365).</span></span> <span data-ttu-id="f1f5b-308">您可以在多種類型的封包中看到這種情況。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-308">You can see this in many types of packets.</span></span>

<span data-ttu-id="f1f5b-309">舉例來說，Netmon 中的篩選器看起來可能像是 Wireshark 中的篩選器  `.Protocol.IPv4.Address == 10.102.14.112 AND .Protocol.IPv4.Address == 10.201.114.12`  `ip.addr == 10.102.14.112 &amp;&amp; ip.addr == 10.201.114.12` 。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-309">As an example, the filter in Netmon may look like  `.Protocol.IPv4.Address == 10.102.14.112 AND .Protocol.IPv4.Address == 10.201.114.12`, or, in Wireshark,  `ip.addr == 10.102.14.112 &amp;&amp; ip.addr == 10.201.114.12`.</span></span>  

> [!TIP]
> <span data-ttu-id="f1f5b-310">不知道追蹤中的 IP 位址是否屬於您的 DNS 伺服器？</span><span class="sxs-lookup"><span data-stu-id="f1f5b-310">Don't know if the IP address in your trace belongs to your DNS server?</span></span> <span data-ttu-id="f1f5b-311">請嘗試在命令列上查看。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-311">Try looking it up at the command line.</span></span> <span data-ttu-id="f1f5b-312">按一下 [ **開始** \> **執行**]， \> 輸入 **cmd**，或按 **Windows 鍵** \> 並輸入 **cmd**。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-312">Click **Start** \> **Run** \> and type **cmd**, or press **Windows Key** \> and type **cmd**.</span></span> <span data-ttu-id="f1f5b-313">在提示字元下輸入  `nslookup <the IP address from the network trace>` 。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-313">At the prompt, type  `nslookup <the IP address from the network trace>`.</span></span> <span data-ttu-id="f1f5b-314">若要測試，對您自己的電腦 IP 位址使用 nslookup。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-314">To test, use nslookup against your own computer's IP address.</span></span> <span data-ttu-id="f1f5b-315">> 若要查看 Microsoft 的 IP 範圍清單，請參閱 [Office 365 URLs 和 IP 位址範圍](https://technet.microsoft.com/library/hh373144.aspx)。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-315">> To see a list of Microsoft's IP ranges, see [Office 365 URLs and IP address ranges](https://technet.microsoft.com/library/hh373144.aspx).</span></span>

<span data-ttu-id="f1f5b-316">如果發生問題，預期會出現長時間偏移，在此情況下 (Outlook Online) ，尤其是在 TLS：顯示應用程式資料之 (的 TLS 封包例如，在 Netmon 中，您可以透過) 尋找應用程式資料封包  `.Protocol.TLS AND Description == "TLS:TLS Rec Layer-1 SSL Application Data"` 。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-316">If there is a problem, expect long Time Offsets to appear, in this case (Outlook Online), particularly in TLS:TLS packets that show the passage of Application Data (for example, in Netmon you can find application data packets via  `.Protocol.TLS AND Description == "TLS:TLS Rec Layer-1 SSL Application Data"`).</span></span> <span data-ttu-id="f1f5b-317">您應該會在會話間看到一段時間的順利進展。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-317">You should see a smooth progression in the time across the session.</span></span> <span data-ttu-id="f1f5b-318">如果您在重新整理 Outlook Online 時看到長時間延遲，這可能是因為傳送高重設。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-318">If you see long delays when refreshing your Outlook Online, this could be caused by a high degree of resets being sent.</span></span>

### <a name="latencyround-trip-time"></a><span data-ttu-id="f1f5b-319">延遲/來回行程時間</span><span class="sxs-lookup"><span data-stu-id="f1f5b-319">Latency/Round Trip Time</span></span>

<span data-ttu-id="f1f5b-320">延遲是一種可根據許多因素變更大量的量值，例如升級老化裝置、將大量使用者新增至網路，以及網路連線上其他工作消耗的整體頻寬百分比。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-320">Latency is a measure that can change a lot depending on many variables, such upgrading aging devices, adding a large number of users to a network, and the percentage of overall bandwidth consumed by other tasks on a network connection.</span></span>

<span data-ttu-id="f1f5b-321">[Office 365 的頻寬計算機] 可以從這種 [網路規劃和效能調整 office 365](network-planning-and-performance.md) 頁面取得。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-321">There are bandwidth calculators for Office 365 available from this [Network planning and performance tuning for Office 365](network-planning-and-performance.md) page.</span></span>  

<span data-ttu-id="f1f5b-322">需要衡量連線速度或您的 ISP 連線的頻寬？</span><span class="sxs-lookup"><span data-stu-id="f1f5b-322">Need to measure the speed of your connection, or your ISP connection's bandwidth?</span></span> <span data-ttu-id="f1f5b-323">請嘗試此網站 (或網站（如它）) ： [Speedtest 官方網站](https://www.speedtest.net/)，或查詢您最愛的搜尋引擎以進行片語 **速度測試**。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-323">Try this site (or sites like it): [Speedtest Official Site](https://www.speedtest.net/), or query your favorite search engine for the phrase **speed test**.</span></span>

#### <a name="tools"></a><span data-ttu-id="f1f5b-324">工具</span><span class="sxs-lookup"><span data-stu-id="f1f5b-324">Tools</span></span>

- <span data-ttu-id="f1f5b-325">坪</span><span class="sxs-lookup"><span data-stu-id="f1f5b-325">Ping</span></span>
- <span data-ttu-id="f1f5b-326">PsPing</span><span class="sxs-lookup"><span data-stu-id="f1f5b-326">PsPing</span></span>
- <span data-ttu-id="f1f5b-327">監視器</span><span class="sxs-lookup"><span data-stu-id="f1f5b-327">Netmon</span></span>
- <span data-ttu-id="f1f5b-328">Wireshark</span><span class="sxs-lookup"><span data-stu-id="f1f5b-328">Wireshark</span></span>

#### <a name="what-to-look-for"></a><span data-ttu-id="f1f5b-329">要尋找的專案</span><span class="sxs-lookup"><span data-stu-id="f1f5b-329">What to look for</span></span>

<span data-ttu-id="f1f5b-330">為了追蹤追蹤中的延遲，您會受益于記錄用戶端電腦的 IP 位址和 Office 365 中 DNS 伺服器的 IP 位址。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-330">To track latency in a trace, you will benefit from having recorded the client computer IP address and the IP address of the DNS server in Office 365.</span></span> <span data-ttu-id="f1f5b-331">這是為了簡化追蹤篩選的目的。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-331">This is for the purpose of easier trace filtering.</span></span> <span data-ttu-id="f1f5b-332">如果您透過 proxy 進行連線，您將需要用戶端電腦的 IP 位址、proxy/出局 IP 位址，以及 Office 365 DNS IP 位址，以簡化工作。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-332">If you connect through a proxy, you will need your client computer IP address, the proxy/egress IP address, and the Office 365 DNS IP address, to make the work easier.</span></span>  

<span data-ttu-id="f1f5b-333">傳送至 outlook.office365.com 的 ping 要求會告訴您接收要求的資料中心名稱，即使 ping  *可能*  無法連線以傳送商標連續 ICMP 封包。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-333">A ping request sent to outlook.office365.com will tell you the name of the datacenter receiving the request, even if ping  *may*  not be able to connect to send the trademark consecutive ICMP packets.</span></span> <span data-ttu-id="f1f5b-334">如果您使用 PsPing (免費的下載) 工具，並指定埠 (443) ，而且可能使用 IPv4 (-4) 您會獲得傳送之封包的平均往返時間。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-334">If you use PsPing (a free tool for download), and specific the port (443) and perhaps to use IPv4 (-4) you will get an average round-trip-time for packets sent.</span></span> <span data-ttu-id="f1f5b-335">這會針對 Office 365 服務中的其他 URLs 執行這項作業，例如 `psping -4 yourSite.sharepoint.com:443` 。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-335">This will work this for other URLs in the Office 365 services, like `psping -4 yourSite.sharepoint.com:443`.</span></span> <span data-ttu-id="f1f5b-336">實際上，您可以指定 ping 以取得您平均平均的範例，嘗試使用一些類似的範例 `psping -4 -n 20 yourSite-my.sharepoint.com:443` 。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-336">In fact, you can specify a number of pings to get a larger sample for your average, try something like `psping -4 -n 20 yourSite-my.sharepoint.com:443`.</span></span>  

> [!NOTE]
> <span data-ttu-id="f1f5b-337">PsPing 不會傳送 ICMP 封包。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-337">PsPing doesn't send ICMP packets.</span></span> <span data-ttu-id="f1f5b-338">它會 ping 透過特定埠的 TCP 封包，讓您可以使用任何一種您知道的開啟。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-338">It pings with TCP packets over a specific port, so you can use any one you know to be open.</span></span> <span data-ttu-id="f1f5b-339">在 Office 365 中使用 SSL/TLS，嘗試將埠：443附加到您的 PsPing。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-339">In Office 365, which uses SSL/TLS, try attaching port :443 to your PsPing.</span></span>

![螢幕擷取畫面顯示的 ping 解析 outlook.office365.com，以及443執行相同的 PSPing，但同時又報告6.5 毫秒平均 RTT。](../media/c64339f2-2c96-45b8-b168-c2a060430266.PNG)

<span data-ttu-id="f1f5b-341">如果在進行網路追蹤時，載入 [執行 Office 365 的速度變慢] 頁面，則應該篩選 Netmon 或 Wireshark 追蹤 `DNS` 。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-341">If you loaded the slow performing Office 365 page while doing a network trace, you should filter a Netmon or Wireshark trace for `DNS`.</span></span> <span data-ttu-id="f1f5b-342">這是我們要尋找的其中一個 Ip。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-342">This is one of the IPs we're looking for.</span></span>  

<span data-ttu-id="f1f5b-343">以下是用來篩選 Netmon 以取得 IP 位址 (，並查看 DNS 延遲) 的步驟。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-343">Here are the steps to take to filter your Netmon to get the IP address (and take a look at DNS Latency).</span></span> <span data-ttu-id="f1f5b-344">本範例會使用 outlook.office365.com，但也可以使用 SharePoint Online 租使用者 (hithere.sharepoint.com 的 URL，例如) 。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-344">This example uses outlook.office365.com, but may also use the URL of a SharePoint Online tenant (hithere.sharepoint.com for example).</span></span>  

1. <span data-ttu-id="f1f5b-345">Ping URL， `ping outlook.office365.com` 然後在結果中記錄已傳送 ping 要求之 DNS 伺服器的名稱和 IP 位址。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-345">Ping the URL `ping outlook.office365.com` and, in the results, record the name and IP address of the DNS server the ping request was sent to.</span></span>
2. <span data-ttu-id="f1f5b-346">網路追蹤開啟頁面，或執行使您產生效能問題的動作，或者，如果您在 ping 上看到過高的延遲，它本身就是網路追蹤。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-346">Network trace opening the page, or doing the action that gives you the performance problem, or, if you see a high latency on the ping, itself, network trace it.</span></span>
3. <span data-ttu-id="f1f5b-347">在 Netmon 中開啟追蹤並篩選 DNS (此篩選也可在 Wireshark 中運作，但對) 大小寫敏感 `-- dns` 。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-347">Open the trace in Netmon and filter for DNS (this filter also works in Wireshark, but is sensitive to case `-- dns`).</span></span> <span data-ttu-id="f1f5b-348">由於您知道從您的 ping 知道 DNS 伺服器的名稱，因此您也可以在 Netmon 中篩選更多 speedily，如下所示： `DNS AND ContainsBin(FrameData, ASCII, "namnorthwest")` 在 Wireshark DNS 及 frame 包含 "namnorthwest" 的情況下，它看起來就像這樣。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-348">Since you know the name of the DNS server from your ping you may also filter more speedily in Netmon like this: `DNS AND ContainsBin(FrameData, ASCII, "namnorthwest")`, which looks like this in Wireshark dns and frame contains "namnorthwest".</span></span><br/><span data-ttu-id="f1f5b-349">開啟回應封包，然後在 [Netmon **框架詳細資料** ] 視窗中，按一下 [ **DNS** ] 以展開詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-349">Open the response packet and, in the Netmon **Frame Details** window, click **DNS** to expand for more information.</span></span> <span data-ttu-id="f1f5b-350">在 [DNS 資訊] 中，您會找到要求在 Office 365 中進入之 DNS 伺服器的 IP 位址。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-350">In the DNS information you'll find the IP address of the DNS server the request went to in Office 365.</span></span> <span data-ttu-id="f1f5b-351">您將需要此 IP 位址進行下一個步驟 (PsPing 工具) 。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-351">You'll need this IP address for the next step (the PsPing tool).</span></span> <span data-ttu-id="f1f5b-352">移除篩選，以滑鼠右鍵按一下 Netmon 中的 DNS 回應 (**框架摘要** \> **尋找交談** \> **dns**) 以並排查看 dns 查詢和回應。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-352">Remove the filter, right-click on the DNS Response in Netmon (**Frame Summary** \> **Find Conversations** \> **DNS**) to see the DNS Query and Response side-by-side.</span></span>
4. <span data-ttu-id="f1f5b-353">在 Netmon 中，也請記下 DNS 要求和回應之間的時間位移欄。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-353">In Netmon, also note the Time Offset  column between the DNS Request and Response.</span></span> <span data-ttu-id="f1f5b-354">在下一個步驟中，易於安裝和使用的 [PsPing](https://technet.microsoft.com/sysinternals/jj729731.aspx) 工具會非常方便，因為這兩者是因為 ICMP 通常會封鎖在防火牆上，而且因為 PsPing elegantly 追蹤延遲（以毫秒為單位）。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-354">In the next step, the easy-to-install and use [PsPing](https://technet.microsoft.com/sysinternals/jj729731.aspx) tool comes in very handy, both because ICMP is often blocked on Firewalls, and because PsPing elegantly tracks latency in milliseconds.</span></span> <span data-ttu-id="f1f5b-355">PsPing 會在我們的案例開啟埠 443) 中完成 TCP 連線到位址及埠 (。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-355">PsPing completes a TCP connection to an address and port (in our case open port 443).</span></span>
5. <span data-ttu-id="f1f5b-356">安裝 PsPing。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-356">Install PsPing.</span></span>
6. <span data-ttu-id="f1f5b-357">\> \> 在您安裝 PsPing 以執行 PsPing 命令的目錄上，開啟命令提示字元 (Start Run type Cmd 或 Windows Key \> type cmd) 並將目錄變更為您安裝的目錄。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-357">Open a command prompt (Start \> Run \> type cmd, or Windows Key \> type cmd) and change directory to the directory where you installed PsPing to run the PsPing command.</span></span> <span data-ttu-id="f1f5b-358">在 [我的範例] 中，您可以看到 I 是 C 的根的「Perf」資料夾。您可以使用相同的快速存取。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-358">In my examples you can see I made a 'Perf' folder on the root of C. You can do the same for quick access.</span></span>
7. <span data-ttu-id="f1f5b-359">輸入命令，讓您從舊版的 Netmon 追蹤（包括埠號碼） PsPing Office 365 DNS 伺服器的 IP 位址 `psping -n 20 132.245.24.82:445` 。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-359">Type the command so that you're making your PsPing against the IP address of the Office 365 DNS server from your earlier Netmon trace, including the port number, like `psping -n 20 132.245.24.82:445`.</span></span> <span data-ttu-id="f1f5b-360">這可讓您在 PsPing 停止時，為您提供20個 ping 的抽樣，並平均延遲時間。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-360">This will give you a sampling of 20 pings and average the latency when PsPing stops.</span></span>

<span data-ttu-id="f1f5b-361">如果您是透過 proxy 伺服器前往 Office 365，步驟會不同。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-361">If you're going to Office 365 through a proxy server, the steps are a little different.</span></span> <span data-ttu-id="f1f5b-362">您會先 PsPing 至 proxy 伺服器，以毫秒為單位取得 proxy/出局及回復的平均延遲值，然後在 proxy 上執行 PsPing，或是在具有直接網際網路連線的電腦上執行) ，以取得遺失的值 (一至 Office 365 及後。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-362">You would first PsPing to your proxy server to get an average latency value in milliseconds to proxy/egress and back, and then either run PsPing on the proxy, or on a computer with a direct Internet connection to get the missing value (the one to Office 365 and back).</span></span>  

<span data-ttu-id="f1f5b-363">如果您選擇從 proxy 執行 PsPing，則會有兩個毫秒值：用戶端電腦到 proxy 伺服器或出局點，以及 proxy 伺服器到 Office 365。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-363">If you choose to run PsPing from the proxy, you'll have two millisecond values: Client computer to proxy server or egress point, and proxy server to Office 365.</span></span> <span data-ttu-id="f1f5b-364">您已經完成！</span><span class="sxs-lookup"><span data-stu-id="f1f5b-364">And you're done!</span></span> <span data-ttu-id="f1f5b-365">哦，還是要記錄的值。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-365">Well, recording values, anyway.</span></span>  

<span data-ttu-id="f1f5b-366">如果您在另一部用戶端電腦上執行 PsPing，但該電腦上有直接連線至網際網路，也就是沒有 proxy，您會有兩個毫秒值：用戶端電腦到 proxy 伺服器或出局點，以及用戶端電腦到 Office 365。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-366">If you run PsPing on another client computer that has a direct connection to the Internet, that is, without a proxy, you will have two millisecond values: Client computer to proxy server or egress point, and client computer to Office 365.</span></span> <span data-ttu-id="f1f5b-367">在此情況下，將用戶端電腦的值減去為 proxy 伺服器或出局點從用戶端電腦的值，到 Office 365，而您的用戶端電腦上的 RTT 編號則為 proxy 伺服器或出局點，而來自 proxy 伺服器或出局點至 Office 365。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-367">In this case, subtract the value of client computer to proxy server or egress point from the value of client computer to Office 365, and you will have the RTT numbers from your client computer to the proxy server or egress point, and from proxy server or egress point to Office 365.</span></span>

<span data-ttu-id="f1f5b-368">不過，如果您可以在受影響的位置上找到直接連線的用戶端電腦，或略過此 proxy，您可以選擇查看問題是否會在開頭產生，並在此後進行測試。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-368">However, if you can find a client computer in the impacted location that is directly connected, or bypasses the proxy, you may choose to see if the issue reproduces there to begin with, and test using it thereafter.</span></span>

<span data-ttu-id="f1f5b-369">延遲（如 Netmon 追蹤中所示），在任何指定的會話中，只要有足夠的時間，這些額外的毫秒數便可增加。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-369">Latency, as seen in a Netmon trace, those extra milliseconds can add up, if there are enough of them in any given session.</span></span>  

![Netmon 中的一般延遲，並將 Netmon 預設時間差異欄位新增至框架摘要。](../media/7ad17380-8527-4bc2-9b9b-6310cf19ba6b.PNG)

> [!NOTE]
> <span data-ttu-id="f1f5b-371">您的 IP 位址可能不同于這裡顯示的 ip 位址，例如，您的 ping 可能會傳回如 157.56.0.0/16 或類似範圍的內容。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-371">Your IP address may be different than the IPs shown here, for example, your ping may return something more like 157.56.0.0/16 or a similar range.</span></span> <span data-ttu-id="f1f5b-372">如需 Office 365 所用範圍的清單，請參閱 [office 365 URLs 和 IP 位址範圍](https://technet.microsoft.com/library/hh373144.aspx)。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-372">For a list of ranges used by Office 365, check out [Office 365 URLs and IP address ranges](https://technet.microsoft.com/library/hh373144.aspx).</span></span>

<span data-ttu-id="f1f5b-373">請記得展開所有節點，如果您想要搜尋，請在此) 的上方 (按鈕（例如，132.245）。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-373">Remember to expand all the nodes (there's a button at the top for this) if you want to search for, for example, 132.245.</span></span>

### <a name="proxy-authentication"></a><span data-ttu-id="f1f5b-374">Proxy 驗證</span><span class="sxs-lookup"><span data-stu-id="f1f5b-374">Proxy Authentication</span></span>

<span data-ttu-id="f1f5b-375">如果您是透過 proxy 伺服器，這只適用于您。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-375">This only applies to you if you're going through a proxy server.</span></span> <span data-ttu-id="f1f5b-376">如果不是，您可以略過這些步驟。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-376">If not, you can skip these steps.</span></span> <span data-ttu-id="f1f5b-377">當正常運作時，proxy 驗證應以毫秒為單位進行一致。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-377">When working properly, proxy authentication should take place in milliseconds, consistently.</span></span> <span data-ttu-id="f1f5b-378">您不應該看到峰值使用時段的效能不良， (例如) 。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-378">You shouldn't see intermittent bad performance during peak usage periods (for example).</span></span>  

<span data-ttu-id="f1f5b-379">若已開啟 Proxy 驗證，每當您建立 Office 365 的新 TCP 連線以取得資訊時，您必須透過幕後的驗證程式來進行傳遞。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-379">If Proxy authentication is on, each time you make a new TCP connection to Office 365 to get information, you need to pass through an authentication process behind the scenes.</span></span> <span data-ttu-id="f1f5b-380">例如，在 Outlook Online 中從行事曆切換到郵件時，您會進行驗證。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-380">So, for example, when switching from Calendar to Mail in Outlook Online, you will authenticate.</span></span> <span data-ttu-id="f1f5b-381">在 [SharePoint 線上] 中，如果頁面顯示多個網站或位置的媒體或資料，您將會驗證每個不同的 TCP 連線，以便呈現資料。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-381">And in SharePoint Online, if a page displays media or data from multiple sites or locations, you will authenticate for each different TCP connection that is needed in order to render the data.</span></span>  

<span data-ttu-id="f1f5b-382">在 Outlook Online 中，每當您在 [行事曆] 和 [信箱] 之間切換時，或在 SharePoint Online 中載入慢速網頁時，可能會遇到載入速度緩慢的情況</span><span class="sxs-lookup"><span data-stu-id="f1f5b-382">In Outlook Online, you may experience slow load times whenever you switch between Calendar and your mailbox, or slow page loads in SharePoint Online.</span></span> <span data-ttu-id="f1f5b-383">不過，這裡還有其他一些問題未列出。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-383">However, there are other symptoms not listed here.</span></span>

<span data-ttu-id="f1f5b-384">Proxy 驗證是您的出口 proxy 伺服器上的設定。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-384">Proxy authentication is a setting on your egress proxy server.</span></span> <span data-ttu-id="f1f5b-385">如果是導致 Office 365 出現效能問題，您必須諮詢網路小組。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-385">If it is causing a performance issue with Office 365, you must consult your networking team.</span></span>  

#### <a name="tools"></a><span data-ttu-id="f1f5b-386">工具</span><span class="sxs-lookup"><span data-stu-id="f1f5b-386">Tools</span></span>

- <span data-ttu-id="f1f5b-387">監視器</span><span class="sxs-lookup"><span data-stu-id="f1f5b-387">Netmon</span></span>
- <span data-ttu-id="f1f5b-388">Wireshark</span><span class="sxs-lookup"><span data-stu-id="f1f5b-388">Wireshark</span></span>

#### <a name="what-to-look-for"></a><span data-ttu-id="f1f5b-389">要尋找的專案</span><span class="sxs-lookup"><span data-stu-id="f1f5b-389">What to look for</span></span>

<span data-ttu-id="f1f5b-390">每當新的 TCP 會話都必須旋轉時，通常會從伺服器要求檔案或資訊，或提供資訊，便會進行 Proxy 驗證。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-390">Proxy authentication takes place whenever a new TCP session must be spun up, commonly to request files or info from the server, or to supply info.</span></span> <span data-ttu-id="f1f5b-391">例如，您可能會在 HTTP GET 或 HTTP POST 要求周圍看到 proxy 驗證。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-391">For example, you may see proxy authentication around HTTP GET or HTTP POST requests.</span></span> <span data-ttu-id="f1f5b-392">如果您想要查看在追蹤中驗證要求的框架，請將「NTLMSSP 摘要」欄新增至 Netmon，然後篩選  `.property.NTLMSSPSummary` 。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-392">If you want to see the frames where you are authenticating requests in your trace, add the 'NTLMSSP Summary' column to Netmon and filter for  `.property.NTLMSSPSummary`.</span></span> <span data-ttu-id="f1f5b-393">若要查看驗證所花費的時間，請新增 [時間增量] 欄位。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-393">To see how long the authentication is taking, add the Time Delta column.</span></span>

<span data-ttu-id="f1f5b-394">若要將欄新增至 Netmon：</span><span class="sxs-lookup"><span data-stu-id="f1f5b-394">To add a column to Netmon:</span></span>

1. <span data-ttu-id="f1f5b-395">以滑鼠右鍵按一下欄（如 [ **描述**]）。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-395">Right-click on a column such as **Description**.</span></span>
2. <span data-ttu-id="f1f5b-396">按一下 **[選擇欄**]。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-396">Click **Choose Columns**.</span></span>
3. <span data-ttu-id="f1f5b-397">在清單中找出 _NTLMSSP 摘要_ 和 _時間 Delta_ ，然後按一下 [ **新增**]。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-397">Locate _NTLMSSP Summary_ and _Time Delta_ in the list and click **Add**.</span></span>
4. <span data-ttu-id="f1f5b-398">將新的欄移至 [ _描述_ ] 欄之前或之後的位置，以便您可以並列閱讀。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-398">Move the new columns into place before or behind the _Description_ column so you can read them side-by-side.</span></span>
5. <span data-ttu-id="f1f5b-399">按一下 [確定]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-399">Click **OK**.</span></span>

<span data-ttu-id="f1f5b-400">即使您沒有新增欄，Netmon 篩選也會運作。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-400">Even if you don't add the column, the Netmon filter will work.</span></span> <span data-ttu-id="f1f5b-401">不過，如果您可以看到您在哪個驗證階段，您的疑難排解會變得更容易。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-401">But your troubleshooting will be much easier if you can see what stage of authentication you're in.</span></span>

<span data-ttu-id="f1f5b-402">在尋找 Proxy 驗證的實例時，請務必在所有出現 NTLM 質詢的幀上進行探索，否則會顯示驗證郵件。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-402">When looking for instances of Proxy Authentication, be sure to study all frames where there is an NTLM Challenge, or an Authenticate Message is present.</span></span> <span data-ttu-id="f1f5b-403">如有必要，請以滑鼠右鍵按一下特定的流量，並尋找 [交談 \> TCP]。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-403">If necessary, right-click the specific piece of traffic and Find Conversations \> TCP.</span></span> <span data-ttu-id="f1f5b-404">請注意這些交談中的時間差值。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-404">Be aware of the Time Delta values in these Conversations.</span></span>

![顯示透過交談篩選之 proxy 驗證的 Netmon 追蹤。](../media/b640f176-0a52-4bbb-972e-60fb3d6aece2.PNG)

<span data-ttu-id="f1f5b-406">Proxy 驗證中的4秒延遲（如 Wireshark 所示）。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-406">A four second delay in proxy authentication as seen in Wireshark.</span></span> <span data-ttu-id="f1f5b-407">在 [框架詳細資料] 中，以滑鼠右鍵按一下具有相同名稱的欄位，然後選取 [新增為欄]，即可進行 **先前所顯示之框架** 欄的時間差。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-407">The **Time delta from previous displayed frame** column was made via right-clicking the field of the same name in the frame details and selecting Add as Column.</span></span>  <br/> <span data-ttu-id="f1f5b-408">![在 Wireshark 中，您可以透過以滑鼠右鍵按一下 [框架詳細資料] 中的相同名稱欄位，然後選取 [新增為欄]，來進行「先前顯示的 frame 的時間差」欄。](../media/f5b7bde4-8067-4ee0-bc7f-e9062ce1ba6f.PNG)</span><span class="sxs-lookup"><span data-stu-id="f1f5b-408">![In Wireshark, the 'Time delta from previous displayed frame' column can be made via right-clicking the field of the same name in the frame details and selecting Add as Column.](../media/f5b7bde4-8067-4ee0-bc7f-e9062ce1ba6f.PNG)</span></span>

### <a name="dns-performance"></a><span data-ttu-id="f1f5b-409">DNS 效能</span><span class="sxs-lookup"><span data-stu-id="f1f5b-409">DNS Performance</span></span>

<span data-ttu-id="f1f5b-410">當盡可能接近客戶的國家/地區時，名稱解析的運作方式最佳，速度會很快。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-410">Name resolution works best and most quickly when it takes place as close to the client's country as possible.</span></span>

<span data-ttu-id="f1f5b-411">若要在國外進行 DNS 名稱解析，則可以在頁面負載中增加秒數。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-411">If DNS name resolution is taking place overseas, it can add seconds to page loads.</span></span> <span data-ttu-id="f1f5b-412">理想狀況下，名稱解析會出現在100ms 之下。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-412">Ideally, name resolution happens in under 100ms.</span></span> <span data-ttu-id="f1f5b-413">如果不是，您應該進行進一步的調查。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-413">If not, you should do further investigation.</span></span>

> [!TIP]
> <span data-ttu-id="f1f5b-414">不確定 Client Connectivity in Office 365 的運作方式？</span><span class="sxs-lookup"><span data-stu-id="f1f5b-414">Not sure how Client Connectivity works in Office 365?</span></span> <span data-ttu-id="f1f5b-415">請參閱下列的用戶端連線[參考檔。](https://technet.microsoft.com/library/dn741250.aspx)</span><span class="sxs-lookup"><span data-stu-id="f1f5b-415">Take a look at the Client Connectivity Reference document [here](https://technet.microsoft.com/library/dn741250.aspx).</span></span>

#### <a name="tools"></a><span data-ttu-id="f1f5b-416">工具</span><span class="sxs-lookup"><span data-stu-id="f1f5b-416">Tools</span></span>

- <span data-ttu-id="f1f5b-417">監視器</span><span class="sxs-lookup"><span data-stu-id="f1f5b-417">Netmon</span></span>
- <span data-ttu-id="f1f5b-418">Wireshark</span><span class="sxs-lookup"><span data-stu-id="f1f5b-418">Wireshark</span></span>
- <span data-ttu-id="f1f5b-419">PsPing</span><span class="sxs-lookup"><span data-stu-id="f1f5b-419">PsPing</span></span>

#### <a name="what-to-look-for"></a><span data-ttu-id="f1f5b-420">要尋找的專案</span><span class="sxs-lookup"><span data-stu-id="f1f5b-420">What to look for</span></span>

<span data-ttu-id="f1f5b-421">分析 DNS 效能通常是網路追蹤的另一個工作。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-421">Analyzing DNS performance is typically another job for a network trace.</span></span> <span data-ttu-id="f1f5b-422">不過，PsPing 對於可能的原因或可能的原因，也很有説明。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-422">However, PsPing is also helpful in ruling in, or out, a possible cause.</span></span>

<span data-ttu-id="f1f5b-423">DNS 流量是以 TCP 及 UDP 要求和回應明確標示，其識別碼會協助您以特定的回應來符合特定的要求。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-423">DNS traffic is based on TCP and UDP requests and responses are clearly marked with an ID that will help to match a specific request with its specific response.</span></span> <span data-ttu-id="f1f5b-424">例如，當線上 SharePoint 線上使用網路名稱或 URL 網頁時，您會看到 DNS 流量。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-424">You'll see DNS traffic when, for example, SharePoint Online uses a network name or URL on a web page.</span></span> <span data-ttu-id="f1f5b-425">一般來說，在傳輸區域時，除了透過 UDP 執行這種流量以外，其他的流量都是如此。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-425">As a rule of thumb, most of this traffic, except when transferring Zones, runs over UDP.</span></span>

<span data-ttu-id="f1f5b-426">在 Netmon 和 Wireshark 中，可讓您查看 DNS 流量的最基本篩選只是 `dns` 。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-426">In both Netmon and Wireshark, the most basic filter that will let you look at DNS traffic is simply `dns`.</span></span> <span data-ttu-id="f1f5b-427">指定篩選時，請務必使用低的大小寫。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-427">Be sure to use lower case when specifying the filter.</span></span> <span data-ttu-id="f1f5b-428">在您開始在用戶端電腦上再現問題之前，請記得先清除您的 DNS 解析程式快取。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-428">Remember to flush your DNS resolver cache before you begin to reproduce the issue on your client computer.</span></span> <span data-ttu-id="f1f5b-429">例如，如果您有慢速 SharePoint 線上頁面負載的首頁，您應該關閉所有的瀏覽器、開啟新的瀏覽器、啟動追蹤、清除 DNS 解析程式快取，然後流覽至您的 SharePoint Online 網站。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-429">For example, if you have a slow SharePoint Online page load for the Home page, you should close all browsers, open a new browser, start tracing, flush your DNS resolver cache, and browse to your SharePoint Online site.</span></span> <span data-ttu-id="f1f5b-430">整個頁面解析完畢後，您應該停止並儲存追蹤。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-430">Once the entire page resolves, you should stop and save the trace.</span></span>

![在 Netmon 中，DNS 的基本篩選器是 DNS。](../media/1bebc118-ca13-45f3-803f-ab73e7af401d.png)

<span data-ttu-id="f1f5b-432">您想要查看此處的時間位移。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-432">You want to look at the time offset here.</span></span> <span data-ttu-id="f1f5b-433">您可以完成下列步驟，將 **Time Delta** 欄新增至 Netmon，這樣做可能會有所説明：</span><span class="sxs-lookup"><span data-stu-id="f1f5b-433">And it may be helpful to add the **Time Delta** column to Netmon which you can do by completing these steps:</span></span>

1. <span data-ttu-id="f1f5b-434">以滑鼠右鍵按一下欄（如 [ **描述**]）。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-434">Right-click on a column such as **Description**.</span></span>
2. <span data-ttu-id="f1f5b-435">按一下 **[選擇欄**]。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-435">Click **Choose Columns**.</span></span>
3. <span data-ttu-id="f1f5b-436">找到清單中的 _時間差_ ，然後按一下 [ **新增**]。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-436">Locate _Time Delta_ in the list and click **Add**.</span></span>
4. <span data-ttu-id="f1f5b-437">將新欄移至 [ _描述_ ] 欄前面或後面的位置，以便您可以並列閱讀。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-437">Move the new column into place before or behind the _Description_ column so you can read them side-by-side.</span></span>
5. <span data-ttu-id="f1f5b-438">按一下 [確定]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-438">Click **OK**.</span></span>

<span data-ttu-id="f1f5b-439">如果您找到感興趣的查詢，請考慮在 [框架詳細資料] 面板中以滑鼠右鍵按一下該查詢以隔離它，然後選擇 [ **尋找交談** \> **DNS**]。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-439">If you find a query of interest, consider isolating it by right-clicking that query in the frame details panel, choosing **Find Conversations** \> **DNS**.</span></span> <span data-ttu-id="f1f5b-440">請注意，網路交談面板會直接跳至其 UDP 流量記錄中的特定交談。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-440">Notice that the Network Conversations panel jumps right to the specific conversation in its log of UDP traffic.</span></span>

![透過 DNS 篩選的 Outlook Online 負載的 Netmon 追蹤，然後使用 [尋找交談]，然後使用 DNS 來縮小結果。](../media/763cf20e-7b48-4a37-9449-c9978cfe118b.PNG)

<span data-ttu-id="f1f5b-442">在 Wireshark 中，您可以建立 DNS 時間欄。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-442">In Wireshark you can make a column for DNS time.</span></span> <span data-ttu-id="f1f5b-443">使用追蹤 (或開啟追蹤) 在 Wireshark 中，或在 [篩選依據] `dns` 或 [更多 helpfully] 中開啟  `dns.time` 。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-443">Take your trace (or open a trace) in Wireshark and filter by `dns`, or, more helpfully,  `dns.time`.</span></span> <span data-ttu-id="f1f5b-444">按一下任何 DNS 查詢，然後在顯示詳細資料的窗格中，展開  `Domain Name System (response)` 詳細資料。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-444">Click on any DNS query, and, in the panel showing details, expand the  `Domain Name System (response)` details.</span></span> <span data-ttu-id="f1f5b-445">例如，您會看到一個用於 time (的欄位 `[Time: 0.001111100 seconds]` 。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-445">You'll see a field for time (for example, `[Time: 0.001111100 seconds]`.</span></span> <span data-ttu-id="f1f5b-446">在此時間按一下滑鼠右鍵，然後選取 [套用 **成] 欄**。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-446">Right-click this time and select **Apply as Column**.</span></span> <span data-ttu-id="f1f5b-447">這可讓您快速排序追蹤的 **時間** 欄。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-447">This will give you a **Time** column for quicker sorting of your trace.</span></span> <span data-ttu-id="f1f5b-448">按一下 [新增] 欄，依遞減的數值排序，以查看哪個 DNS 通話所用的時間最長。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-448">Click on the new column to sort by descending values to see which DNS call took the longest to resolve.</span></span>

[<span data-ttu-id="f1f5b-449">在 Wireshark 中由 (小寫) dns.time 篩選的 SharePoint Online 瀏覽，時間起點為將詳細資料納入欄位和遞增排序起。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-449">A browse of SharePoint Online filtered in Wireshark by (lowercase) dns.time, with the time from the details made into a column and sorted ascending.</span></span>](../media/1439dcc2-12ff-4ee2-9ef3-1484cf79c384.PNG)

<span data-ttu-id="f1f5b-450">如果您想要進一步調查 DNS 解析時間，請嘗試針對 TCP (所使用的 DNS 埠 PsPing，例如  `psping <IP address of DNS server>:53`) 。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-450">If you would like to do more investigation of the DNS resolution time, try a PsPing against the DNS port used by TCP (for example,  `psping <IP address of DNS server>:53`) .</span></span> <span data-ttu-id="f1f5b-451">您是否仍會看到效能問題？</span><span class="sxs-lookup"><span data-stu-id="f1f5b-451">Do you still see a performance issue?</span></span> <span data-ttu-id="f1f5b-452">如果您這麼做，則問題可能會比特定的網路問題更廣泛，而不是特定的 DNS 應用程式在解決時所遇到的問題。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-452">If you do, then the problem is more likely to be a broader network issue than an issue of specific the DNS application you're hitting to do resolution.</span></span> <span data-ttu-id="f1f5b-453">另外也值得一提的是，ping 至 outlook.office365.com，會告訴您 Outlook Online 的 DNS 名稱解析在採取的地方 (例如，outlook-namnorthwest.office365.com) 。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-453">It's also worth mentioning, again, that a ping to outlook.office365.com will tell you where DNS name resolution for Outlook Online is taking place (for example, outlook-namnorthwest.office365.com).</span></span>

<span data-ttu-id="f1f5b-454">如果問題似乎是以 DNS 為依據，則可能需要聯繫您的 IT 部門，以查看 DNS 設定和 DNS 轉寄站，以進一步調查此問題。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-454">If the issue looks to be DNS specific, it may be necessary to contact your IT department to look at DNS configurations and DNS Forwarders to further investigate this issue.</span></span>

### <a name="proxy-scalability"></a><span data-ttu-id="f1f5b-455">Proxy 擴充性</span><span class="sxs-lookup"><span data-stu-id="f1f5b-455">Proxy Scalability</span></span>

<span data-ttu-id="f1f5b-456">Office 365 中的 Outlook Online 服務會授與用戶端多項長期連線。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-456">Services like Outlook Online in Office 365 grant clients multiple long-term connections.</span></span> <span data-ttu-id="f1f5b-457">因此，每一位使用者可能會使用更多需要較長壽命的連線。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-457">Therefore, each user may use more connections that require a longer life.</span></span>  

#### <a name="tools"></a><span data-ttu-id="f1f5b-458">工具</span><span class="sxs-lookup"><span data-stu-id="f1f5b-458">Tools</span></span>

<span data-ttu-id="f1f5b-459">數學</span><span class="sxs-lookup"><span data-stu-id="f1f5b-459">Math</span></span>  

#### <a name="what-to-look-for"></a><span data-ttu-id="f1f5b-460">要尋找的專案</span><span class="sxs-lookup"><span data-stu-id="f1f5b-460">What to look for</span></span>

<span data-ttu-id="f1f5b-461">這個功能沒有專門的網路追蹤或疑難排解工具。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-461">There is no network trace or troubleshooting tool specific to this.</span></span> <span data-ttu-id="f1f5b-462">相反地，它是以頻寬計算限制和其他變數為基礎。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-462">Instead, it's based upon bandwidth calculations given limitations and other variables.</span></span>  

### <a name="tcp-max-segment-size"></a><span data-ttu-id="f1f5b-463">TCP 最大區段大小</span><span class="sxs-lookup"><span data-stu-id="f1f5b-463">TCP Max Segment Size</span></span>

<span data-ttu-id="f1f5b-464">在 SYN-SYN/ACK 中找到。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-464">Found in the SYN - SYN/ACK.</span></span>  <span data-ttu-id="f1f5b-465">請在您採取的任何效能網路追蹤中檢查，以確保 TCP 封包已設定為盡可能具有最大的資料量。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-465">Do this check in any performance network trace you've taken to ensure that TCP packets are configured to carry the maximum amount of data possible.</span></span>

<span data-ttu-id="f1f5b-466">目標是要查看1460位元組的 MSS，以傳輸資料。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-466">The goal is to see a MSS of 1460 bytes for transmission of data.</span></span> <span data-ttu-id="f1f5b-467">如果您正在使用 proxy，或您使用的是 NAT，請記得從用戶端到 proxy/出局/NAT，以及從 proxy/出局/NAT 對 Office 365 執行這種測試，以取得最佳結果！</span><span class="sxs-lookup"><span data-stu-id="f1f5b-467">If you're behind a proxy, or you are using a NAT, remember to run this test from client to proxy/egress/NAT, and from proxy/egress/NAT to Office 365 for best results!</span></span> <span data-ttu-id="f1f5b-468">這些是不同的 TCP 會話。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-468">These are different TCP sessions.</span></span>

#### <a name="tools"></a><span data-ttu-id="f1f5b-469">工具</span><span class="sxs-lookup"><span data-stu-id="f1f5b-469">Tools</span></span>

<span data-ttu-id="f1f5b-470">監視器</span><span class="sxs-lookup"><span data-stu-id="f1f5b-470">Netmon</span></span>

#### <a name="what-to-look-for"></a><span data-ttu-id="f1f5b-471">要尋找的專案</span><span class="sxs-lookup"><span data-stu-id="f1f5b-471">What to look for</span></span>

<span data-ttu-id="f1f5b-472">TCP 最大區段大小 (MSS) 為網路追蹤中的三向握手的另一個參數，這表示您會在 SYN-SYN/ACK 封包中找到您需要的資料。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-472">TCP Max Segment Size (MSS) is another parameter of the three-way handshake in your network trace, that means you'll find the data you need in the SYN - SYN/ACK packet.</span></span> <span data-ttu-id="f1f5b-473">MSS 實際上很容易看到。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-473">MSS is actually pretty simple to see.</span></span>

<span data-ttu-id="f1f5b-474">開啟您所擁有的任何效能網路追蹤，並尋找您想要的連線，或展示效能問題。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-474">Open any performance network trace you have and find the connection you're curious about, or that demonstrates the performance problem.</span></span>

> [!NOTE]
> <span data-ttu-id="f1f5b-475">如果您正在尋找追蹤，且需要找出與交談相關的流量，請依用戶端的 IP 篩選，或 proxy 伺服器或出局點的 IP 進行篩選，或是兩者皆有。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-475">If you are looking at a trace and need to find the traffic relevant to your conversation, filter by the IP of the Client, or the IP of the proxy server or egress point, or both.</span></span> <span data-ttu-id="f1f5b-476">直接前往，您必須在追蹤時，ping 您要測試的 URL，以取得 Office 365 的 IP 位址，並加以篩選。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-476">Going directly, you will need to ping the URL that you're testing for the IP address of Office 365 in the trace, and filter by it.</span></span>

<span data-ttu-id="f1f5b-477">要尋找追蹤第二筆？</span><span class="sxs-lookup"><span data-stu-id="f1f5b-477">Looking at the trace second-hand?</span></span> <span data-ttu-id="f1f5b-478">請嘗試使用篩選器來調整您的方向。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-478">Try using filters to orient yourself.</span></span> <span data-ttu-id="f1f5b-479">在 Netmon 中，根據 URL 執行搜尋，例如 `Containsbin(framedata, ascii, "sphybridExample")` ，記下 [框架編號]。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-479">In Netmon, run a search based on the URL, such as `Containsbin(framedata, ascii, "sphybridExample")`, take note of the frame number.</span></span>

<span data-ttu-id="f1f5b-480">在 Wireshark 中使用類似  `frame contains "sphybridExample"` 的專案。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-480">In Wireshark use something like  `frame contains "sphybridExample"`.</span></span> <span data-ttu-id="f1f5b-481">如果您發現) 流量中發現遠端 Winsock (RWS， (其可能會在) Wireshark 中顯示為 [PSH，ACK]，請記住，在相關的 SYN-SYN/Ack 之前，如前文所述，可以立即看到 RWS 連線。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-481">If you notice that you've found Remote Winsock (RWS) traffic (it may appear as a [PSH, ACK] in Wireshark), remember that RWS connects can be seen shortly before relevant SYN - SYN/ACKs, as discussed earlier.</span></span>

<span data-ttu-id="f1f5b-482">此時，您可以記錄該幀編號、放下篩選器、按一下 Netmon 中 [網路交談] 視窗中的 [ **所有流量** ]，以查看最接近的 SYN。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-482">At this point, you can record the frame number, drop the filter, click **All Traffic** in the Network Conversations window in Netmon to look at the nearest SYN.</span></span>

<span data-ttu-id="f1f5b-483">重要的是，如果您在追蹤時未收到任何 IP 位址資訊，請在追蹤 (一部分找到您的 URL `sphybridExample-my.sharepoint.com` ，例如) ，將會為您提供篩選的 ip 位址。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-483">Importantly, if you didn't receive any of the IP address information at the time of the trace, finding your URL in the trace (part of `sphybridExample-my.sharepoint.com`, for example), will give you IP addresses to filter by.</span></span>

<span data-ttu-id="f1f5b-484">在您想要查看的追蹤中找出連接。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-484">Locate the connection in the trace that you're interested in seeing.</span></span> <span data-ttu-id="f1f5b-485">若要這麼做，您可以掃描追蹤、透過 IP 位址進行篩選，或是使用 Netmon 中的 [網路交談] 視窗來選取特定交談 IDs。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-485">You may do this by either scanning the trace, by filtering by IP addresses, or by selecting specific Conversation IDs using the Network Conversations window in Netmon.</span></span> <span data-ttu-id="f1f5b-486">找到 SYN 資料包之後，請展開 [框架詳細資料] 面板中的 [Wireshark) 中的 [在 Netmon) 中的 TCP (] 或 [傳輸控制通訊協定 (]。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-486">Once you've found the SYN packet, expand TCP (in Netmon), or Transmission Control Protocol (in Wireshark) in the Frame Details panel.</span></span> <span data-ttu-id="f1f5b-487">展開 [TCP 選項和 MaxSegmentSize]。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-487">Expand TCP Options and MaxSegmentSize.</span></span> <span data-ttu-id="f1f5b-488">找到相關的 SYN-ACK frame，並展開 TCP 選項及 MaxSegmentSize。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-488">Locate the related SYN-ACK frame and Expand TCP Options and MaxSegmentSize.</span></span> <span data-ttu-id="f1f5b-489">這兩個值中較小的值將是最大的區段大小。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-489">The smaller of the two values will be your Maximum Segment Size.</span></span> <span data-ttu-id="f1f5b-490">在此圖中，我在稱為 TCP 疑難排解的 Netmon 中使用內建的資料行。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-490">In this picture, I make use of the built-in Column in Netmon called TCP Troubleshoot.</span></span>  

![使用內建欄在 Netmon 中篩選的網路追蹤。](../media/e073df13-71f8-497a-83b4-bb9f70bd9833.PNG)

<span data-ttu-id="f1f5b-492">內建欄位於 [ **框架詳細資料** ] 面板的頂端。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-492">The built-in column is at the top of the **Frame Details** panel.</span></span> <span data-ttu-id="f1f5b-493"> (若要切換回普通模式，請再次按一下 [ **欄** ]，然後選擇 [ **時區**]。 ) </span><span class="sxs-lookup"><span data-stu-id="f1f5b-493">(To switch back to your normal view, click **Columns** again, and then choose **Time Zone**.)</span></span>

![在欄位下拉式清單中尋找 TCP 疑難排解選項 (在框架摘要的頂端)。](../media/64fd4baa-a872-4f07-b959-752d7d37fd62.PNG)

<span data-ttu-id="f1f5b-495">以下是 Wireshark 中的篩選追蹤。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-495">Here's a filtered trace in Wireshark.</span></span> <span data-ttu-id="f1f5b-496"> () 的 MSS 值都有特定的篩選準則 `tcp.options.mss` 。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-496">There is a filter specific to the MSS value ( `tcp.options.mss`).</span></span> <span data-ttu-id="f1f5b-497">SYN、SYN/ACK 和 ACK 握手的框架都是在 Wireshark 的底層，連結在對等方的詳細資料 (so 47 ACK，連結至 46 SYN/ACK，其連結至 43 SYN) ，以簡化這類工作。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-497">The frames of a SYN, SYN/ACK, ACK handshake are linked at the bottom of the Wireshark equivalent to Frame Details (so frame 47 ACK, links to 46 SYN/ACK, links to 43 SYN) to make this kind of work easier.</span></span>

![Wireshark 依 tcp 篩選的追蹤。 options。 mss 為最大區段大小 (MSS) 。](../media/51e278db-801b-48bc-9b68-87cf92f03fd6.PNG)

<span data-ttu-id="f1f5b-499">如果您需要在此矩陣) 中檢查 **選擇性的認可** (下一個主題，請勿關閉追蹤！</span><span class="sxs-lookup"><span data-stu-id="f1f5b-499">If you need to check **Selective Acknowledgment** (next topic in this matrix), don't close your trace!</span></span>

### <a name="selective-acknowledgment"></a><span data-ttu-id="f1f5b-500">選擇性認可</span><span class="sxs-lookup"><span data-stu-id="f1f5b-500">Selective Acknowledgment</span></span>

<span data-ttu-id="f1f5b-501">在 SYN-SYN/ACK 中找到。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-501">Found in the SYN - SYN/ACK.</span></span> <span data-ttu-id="f1f5b-502">必須在 SYN 和 SYN/ACK 中以允許的方式報告。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-502">Must be reported as Permitted in both SYN and SYN/ACK.</span></span> <span data-ttu-id="f1f5b-503">選擇性認可 (SACK) 允許資料包或封包遺失時，傳輸資料的順利。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-503">Selective Acknowledgment (SACK) allows for smoother retransmission of data when a packet or packets go missing.</span></span> <span data-ttu-id="f1f5b-504">裝置可以停用此功能，這可能會導致效能問題。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-504">Devices can disable this feature, which can lead to performance problems.</span></span>

<span data-ttu-id="f1f5b-505">如果您正在使用 proxy，或您使用的是 NAT，請記得從用戶端到 proxy/出局/NAT，以及從 proxy/出局/NAT 對 Office 365 執行這種測試，以取得最佳結果！</span><span class="sxs-lookup"><span data-stu-id="f1f5b-505">If you're behind a proxy, or you are using a NAT, remember to run this test from client to proxy/egress/NAT, and from proxy/egress/NAT to Office 365 for best results!</span></span> <span data-ttu-id="f1f5b-506">這些是不同的 TCP 會話。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-506">These are different TCP sessions.</span></span>

#### <a name="tools"></a><span data-ttu-id="f1f5b-507">工具</span><span class="sxs-lookup"><span data-stu-id="f1f5b-507">Tools</span></span>

<span data-ttu-id="f1f5b-508">監視器</span><span class="sxs-lookup"><span data-stu-id="f1f5b-508">Netmon</span></span>

#### <a name="what-to-look-for"></a><span data-ttu-id="f1f5b-509">要尋找的專案</span><span class="sxs-lookup"><span data-stu-id="f1f5b-509">What to look for</span></span>

<span data-ttu-id="f1f5b-510">選擇性認可 (SACK) 是 SYN-SYN/ACK 握手中的另一個參數。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-510">Selective Acknowledgment (SACK) is another parameter in the SYN-SYN/ACK handshake.</span></span> <span data-ttu-id="f1f5b-511">您可以透過許多方式，篩選追蹤以取得 SYN/ACK。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-511">You can filter your trace for SYN - SYN/ACK many ways.</span></span>

<span data-ttu-id="f1f5b-512">使用 Netmon 中的 [網路交談] 視窗，在要查看的追蹤中找出您想要查看的連線，方法是掃描追蹤、依 IP 位址篩選，或按一下交談識別碼。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-512">Locate the connection in the trace that you're interested in seeing either by scanning the trace, filtering by IP addresses, or by clicking a Conversation ID using the Network Conversations window in Netmon.</span></span> <span data-ttu-id="f1f5b-513">當您找到 SYN 資料包、展開 Netmon 中的 TCP 或「框架詳細資料」區段中的 Wireshark 傳輸控制通訊協定。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-513">Once you've found the SYN packet, expand TCP in Netmon, or Transmission Control Protocol in Wireshark in the Frame Details section.</span></span> <span data-ttu-id="f1f5b-514">展開 [TCP 選項]，然後按 [SACK]。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-514">Expand TCP Options and then SACK.</span></span> <span data-ttu-id="f1f5b-515">找到相關的 SYN-ACK frame，並展開 [TCP 選項] 和 [SACK] 欄位。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-515">Locate the related SYN-ACK frame and Expand TCP Options and its SACK field.</span></span> <span data-ttu-id="f1f5b-516">在 SYN 和 SYN/ACK 中皆允許某些 SACK。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-516">Make certain SACK is permitted in both SYN and SYN/ACK.</span></span> <span data-ttu-id="f1f5b-517">以下是 Netmon 和 Wireshark 中所看到的 SACK 值。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-517">Here are SACK values as seen in both Netmon and Wireshark.</span></span>

![選擇性認可 (Netmon 中的 SACK) （tcp）。 flags = = 1。](../media/216f556f-5031-4ed2-b066-a0d9b3251fa2.PNG)

![Wireshark 中所示的 SACK 及篩選器 tcp.flags.syn == 1。](../media/0a6e26e5-43dc-403b-adc9-3349a55f4e4b.PNG)

### <a name="dns-geolocation"></a><span data-ttu-id="f1f5b-520">DNS 地理位置</span><span class="sxs-lookup"><span data-stu-id="f1f5b-520">DNS Geolocation</span></span>

<span data-ttu-id="f1f5b-521">在世界上 Office 365 的何處，嘗試解決您的 DNS 通話影響您的連線速度。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-521">Where in the world Office 365 tries to resolve your DNS call effects your connection speed.</span></span>

<span data-ttu-id="f1f5b-522">在 Outlook Online 中，在第一個 DNS 查找完成之後，該 DNS 的位置將用來連線至最接近的資料中心。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-522">In Outlook Online, after the first DNS lookup is completed, the location of that DNS will be used to connect to your nearest datacenter.</span></span> <span data-ttu-id="f1f5b-523">您將會連線至 Outlook Online CAS 伺服器，此伺服器會使用主幹網路連接至儲存資料的資料中心 (dC) 。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-523">You will be connected to an Outlook Online CAS server, which will use the backbone network to connect to the datacenter (dC) where your data is stored.</span></span> <span data-ttu-id="f1f5b-524">速度較快。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-524">This is faster.</span></span>

<span data-ttu-id="f1f5b-525">當存取 SharePoint 線上時，向國外進行的使用者將會定向到其作用中的資料中心，也就是說，其位置是以 SPO 租使用者的家用基底 (成為基礎，因此，如果使用者是美國（) 美國），則為 USA 中的 dC。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-525">When accessing SharePoint Online, a user traveling abroad will be directed to their active datacenter -- that's the dC whose location is based on their SPO tenant's home-base (so, a dC in the USA if the user if USA-based).</span></span>

<span data-ttu-id="f1f5b-526">Lync online 一次有一個以上的 dC 中有主動節點。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-526">Lync online has active nodes in more than one dC at a time.</span></span> <span data-ttu-id="f1f5b-527">當您傳送 Lync online 實例的要求時，Microsoft 的 DNS 會判斷要求在世界上的位置，並傳回最近使用 Lync online 之地區 dC 中的 IP 位址。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-527">When requests are sent for Lync online instances, Microsoft's DNS will determine where in the world the request came from, and return IP addresses from the nearest regional dC where Lync online is active.</span></span>

> [!TIP]
> <span data-ttu-id="f1f5b-528">需要進一步瞭解用戶端如何連接至 Office 365？</span><span class="sxs-lookup"><span data-stu-id="f1f5b-528">Need to know more about how clients connect to Office 365?</span></span> <span data-ttu-id="f1f5b-529">請參閱 [Client Connectivity](https://technet.microsoft.com/library/dn741250.aspx) reference 文章 (及其有説明的圖形) 。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-529">Take a look at the [Client Connectivity](https://technet.microsoft.com/library/dn741250.aspx) reference article (and its helpful graphics).</span></span>

#### <a name="tools"></a><span data-ttu-id="f1f5b-530">工具</span><span class="sxs-lookup"><span data-stu-id="f1f5b-530">Tools</span></span>

- <span data-ttu-id="f1f5b-531">坪</span><span class="sxs-lookup"><span data-stu-id="f1f5b-531">Ping</span></span>
- <span data-ttu-id="f1f5b-532">PsPing</span><span class="sxs-lookup"><span data-stu-id="f1f5b-532">PsPing</span></span>

#### <a name="what-to-look-for"></a><span data-ttu-id="f1f5b-533">要尋找的專案</span><span class="sxs-lookup"><span data-stu-id="f1f5b-533">What to look for</span></span>

<span data-ttu-id="f1f5b-534">從用戶端的 DNS 伺服器對 Microsoft DNS 伺服器進行名稱解析的要求，在大部分情況下，會導致 Microsoft DNS 傳回地區性資料中心的 IP 位址 (dC) 。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-534">Requests for name resolution from the client's DNS servers to Microsoft's DNS servers should in most cases result in Microsoft DNS returning the IP address of a regional datacenter (dC).</span></span> <span data-ttu-id="f1f5b-535">這對您有何意義？</span><span class="sxs-lookup"><span data-stu-id="f1f5b-535">What does this mean for you?</span></span> <span data-ttu-id="f1f5b-536">如果您的總部是在 Bangalore、印度，但您是在美國舉行，當您的瀏覽器要求 Outlook Online 時，Microsoft 的 DNS 伺服器應該會將您的 IP 位址傳送至美國的資料中心（地區性資料中心）。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-536">If your headquarters are in Bangalore, India, but you are traveling in the United States, when your browser makes a request for Outlook Online, Microsoft's DNS servers should hand you IP addresses to datacenters in the United States -- a regional datacenter.</span></span> <span data-ttu-id="f1f5b-537">若 Outlook 需要郵件，該資料將會透過整個 Microsoft 的快速骨幹絡傳送到資料中心。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-537">If mail is needed from Outlook, that data will travel across Microsoft's quick backbone network between the datacenters.</span></span>

<span data-ttu-id="f1f5b-538">當以盡可能接近的使用者位置進行名稱解析時，DNS 的運作速度最快。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-538">DNS works fastest when name resolution is done as close to the user location as possible.</span></span> <span data-ttu-id="f1f5b-539">如果您是在歐洲，您想要移至歐洲的 Microsoft DNS，並 (理想的) 與歐洲的資料中心打交道。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-539">If you're in Europe, you want to go to a Microsoft DNS in Europe, and (ideally) deal with a datacenter in Europe.</span></span> <span data-ttu-id="f1f5b-540">從歐洲客戶前往 DNS 和北美的資料中心的效能將會變慢。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-540">Performance from a client in Europe going to DNS and a datacenter in America will be slower.</span></span>

<span data-ttu-id="f1f5b-541">針對 outlook.office365.com 執行 Ping 工具，以判斷您的 DNS 要求在世界上的路由。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-541">Run the Ping tool against outlook.office365.com to determine where in the world your DNS request is being routed.</span></span> <span data-ttu-id="f1f5b-542">如果您在歐洲，您應該會看到類似 outlook-emeawest.office365.com 的回復。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-542">If you are in Europe, you should see a reply from something like outlook-emeawest.office365.com.</span></span> <span data-ttu-id="f1f5b-543">在美洲，預期的類似 outlook-namnorthwest.office365.com。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-543">In the Americas, expect something like outlook-namnorthwest.office365.com.</span></span>

<span data-ttu-id="f1f5b-544">透過 [開始 \> 執行 \> cmd] 或 [Windows key type cmd) ]，在用戶端 (電腦上開啟命令提示字元 \> 。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-544">Open the command prompt on the client computer (via Start \> Run \> cmd or Windows key \> type cmd).</span></span> <span data-ttu-id="f1f5b-545">輸入 ping outlook.office365.com，然後按 ENTER 鍵。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-545">Type ping outlook.office365.com and press ENTER.</span></span> <span data-ttu-id="f1f5b-546">請記住，若要透過 IPv4 指定 ping，請指定-4。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-546">Remember, to specify -4 if you want to specify to ping via IPv4.</span></span> <span data-ttu-id="f1f5b-547">您可能無法從 ICMP 封包取得回復，但您應該會看到路由傳送要求的 DNS 名稱。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-547">You may fail to get a reply from the ICMP packets, but you should see the name of the DNS to which the request was routed.</span></span> <span data-ttu-id="f1f5b-548">如果您想要查看此連線的延遲號碼，請嘗試 PsPing 至 ping 傳回之伺服器的 IP 位址。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-548">If you want to see the latency numbers for this connection try PsPing to the IP address of the server that is returned by ping.</span></span>  

![outlook.office365.com 的 Ping，顯示 outlook-namnorthwest 中的解析。](../media/06c944d5-6159-43ec-aa31-757770695e8b.PNG)

![PSPing 至 ping 至 outlook.office365.com 所傳回的 IP 位址，顯示平均28毫秒延遲。](../media/f2b25a75-1a87-4479-b8a7-fa4375683507.PNG)

### <a name="office-365-application-troubleshooting"></a><span data-ttu-id="f1f5b-551">Office 365 應用程式疑難排解</span><span class="sxs-lookup"><span data-stu-id="f1f5b-551">Office 365 Application Troubleshooting</span></span>

#### <a name="tools"></a><span data-ttu-id="f1f5b-552">工具</span><span class="sxs-lookup"><span data-stu-id="f1f5b-552">Tools</span></span>

- <span data-ttu-id="f1f5b-553">監視器</span><span class="sxs-lookup"><span data-stu-id="f1f5b-553">Netmon</span></span>
- <span data-ttu-id="f1f5b-554">HTTPWatch</span><span class="sxs-lookup"><span data-stu-id="f1f5b-554">HTTPWatch</span></span>
- <span data-ttu-id="f1f5b-555">瀏覽器中的 F12 主控台</span><span class="sxs-lookup"><span data-stu-id="f1f5b-555">F12 Console in the browser</span></span>

<span data-ttu-id="f1f5b-556">在此網路特有的文章中，我們並未涵蓋應用程式特定疑難排解中所用的工具。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-556">We don't cover tools used in application-specific troubleshooting in this network-specific article.</span></span> <span data-ttu-id="f1f5b-557">不過，您會找到您*可以*[在此頁面上使用的](https://support.office.com/article/Network-planning-and-performance-tuning-for-Office-365-e5f1228c-da3c-4654-bf16-d163daee8848)資源。</span><span class="sxs-lookup"><span data-stu-id="f1f5b-557">But you'll find resources you  *can*  use [on this page](https://support.office.com/article/Network-planning-and-performance-tuning-for-Office-365-e5f1228c-da3c-4654-bf16-d163daee8848).</span></span>

## <a name="related-topics"></a><span data-ttu-id="f1f5b-558">相關主題</span><span class="sxs-lookup"><span data-stu-id="f1f5b-558">Related Topics</span></span>

[<span data-ttu-id="f1f5b-559">管理 Office 365 端點</span><span class="sxs-lookup"><span data-stu-id="f1f5b-559">Managing Office 365 endpoints</span></span>](https://support.office.com/article/99cab9d4-ef59-4207-9f2b-3728eb46bf9a)
  
<span data-ttu-id="f1f5b-560">[Office 365 端點常見問題集](https://support.office.com/article/d4088321-1c89-4b96-9c99-54c75cae2e6d) (機器翻譯)</span><span class="sxs-lookup"><span data-stu-id="f1f5b-560">[Office 365 endpoints FAQ](https://support.office.com/article/d4088321-1c89-4b96-9c99-54c75cae2e6d)</span></span>
