---
title: 使用郵件流程規則來封鎖具有可執行附件的郵件
f1.keywords:
- NOCSH
ms.author: chrisda
author: chrisda
manager: dansimp
ms.date: ''
audience: ITPro
ms.topic: article
ms.service: O365-seccomp
localization_priority: Normal
ms.assetid: c4fb4a86-b772-49d0-8773-e8ee897e175d
ms.custom:
- seo-marvel-apr2020
description: 系統管理員可以瞭解如何建立郵件流程規則（傳輸規則），以封鎖包含可執行附件的郵件。
ms.openlocfilehash: 97647906103458a4189f6d1e47df13db8a4e1f01
ms.sourcegitcommit: 8e655c6cbb91bfb97efda9a99c39fac33eaa974a
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 05/13/2020
ms.locfileid: "44213149"
---
# <a name="use-mail-flow-rules-to-block-messages-with-executable-attachments-in-eop"></a>使用郵件流程規則，在 EOP 中封鎖具有可執行附件的郵件

在未使用 Exchange online 信箱的 Exchange Online 或獨立 Exchange Online Protection （EOP）組織中使用信箱的 Microsoft 365 組織中，EOP 會使用反惡意程式碼原則來封鎖有害的郵件，包括具有可執行附件的郵件。 如需詳細資訊，請參閱[EOP 中的反惡意程式碼保護](anti-malware-protection.md)。

若要進一步增強保護，您可以使用郵件流程規則（也稱為傳輸規則）來識別及封鎖包含可執行附件的郵件，如本主題所述。

例如，在惡意程式碼發作的情況下，公司可以套用此規則的時間限制，讓受影響的使用者可以在指定的時間長度後傳回傳送附件。

## <a name="what-do-you-need-to-know-before-you-begin"></a>開始之前有哪些須知？

- 您必須已獲指派許可權，才能執行這些程式：

  - 在 Exchange Online 中，請參閱在[Exchange online 中的功能許可權中](https://docs.microsoft.com/Exchange/permissions-exo/feature-permissions)的「郵件流程」專案。
  
  - 在獨立 EOP 中，您需要傳輸規則角色，預設會指派給 OrganizationManagement、ComplianceManagement 和 RecordsManagement 角色。 如需詳細資訊，請參閱[獨立 EOP 中的許可權](feature-permissions-in-eop.md)和[使用 EAC 修改角色群組中的成員清單](manage-admin-role-group-permissions-in-eop.md#use-the-eac-modify-the-list-of-members-in-role-groups)。

- 若要在 Exchange Online 中開啟 EAC，請參閱 exchange [online 中的 exchange admin center](https://docs.microsoft.com/Exchange/exchange-admin-center)。 若要在獨立 EOP 中開啟 EAC，請參閱[Exchange admin center in 獨立 EOP](exchange-admin-center-in-exchange-online-protection-eop.md)。

- 若要連線至 Exchange Online PowerShell，請參閱[連線至 Exchange Online PowerShell](https://docs.microsoft.com/powershell/exchange/exchange-online/connect-to-exchange-online-powershell/connect-to-exchange-online-powershell)。 若要連線至獨立 EOP PowerShell，請參閱[connect To Exchange Online Protection PowerShell](https://docs.microsoft.com/powershell/exchange/exchange-eop/connect-to-exchange-online-protection-powershell)。

- 如需 Exchange Online 和獨立 EOP 中郵件流程規則的相關資訊，請參閱下列主題：

  - [Exchange Online 中的郵件流程規則 (傳輸規則)](https://docs.microsoft.com/Exchange/security-and-compliance/mail-flow-rules/mail-flow-rules)

  - [Exchange Online 中的郵件流程規則條件和例外狀況 (述詞)](https://docs.microsoft.com/Exchange/security-and-compliance/mail-flow-rules/conditions-and-exceptions)

  - [Exchange Online 中的郵件流程規則動作](https://docs.microsoft.com/Exchange/security-and-compliance/mail-flow-rules/mail-flow-rule-actions)

## <a name="use-the-eac-to-create-a-rule-that-blocks-messages-with-executable-attachments"></a>使用 EAC 來建立一個規則，以封鎖具有可執行附件的郵件

1. 在 EAC 中，移至 [郵件流程]**** \> [規則]****。

2. 按一下 [**新增** ![ 加入圖示] ](../../media/ITPro-EAC-AddIcon.png) ，然後選取 [**建立新的規則**]。

3. 在開啟的 [**新增規則**] 頁面中，設定下列設定：

   - **名稱**：輸入規則的唯一描述性名稱。

   - 按一下 [**更多選項**]。

   - **在下列情況中套用此規則**：選取**任何附件** \> **都有可執行檔內容**。

   - **請執行下列**動作：選取 [**封鎖郵件**]，然後選擇您想要的動作：

     - **拒絕郵件並包含說明**：在出現的 [**指定拒絕原因**] 對話方塊中，輸入您要顯示在未傳遞回報（也稱為 NDR 或退回的郵件）中的文字。 使用的預設增強型狀態碼為5.7.1。

     - **使用增強型狀態碼拒絕郵件**：在出現的 [**輸入增強型狀態碼**] 對話方塊中，輸入您要顯示在 NDR 中的增強狀態碼。 有效的值為5.7.1 或5.7.900 到5.7.999 的值。 預設拒絕文字為：傳遞未獲授權，郵件被拒絕。

     - **拒絕郵件而不通知任何人**

4. 完成後，按一下 [儲存]****。 您的附件封鎖規則目前處於強制狀態。

## <a name="use-powershell-to-create-a-rule-that-blocks-messages-with-executable-attachments"></a>使用 PowerShell 建立封鎖郵件與可執行附件的規則

使用下列語法來建立規則，以封鎖包含可執行附件的郵件：

```powershell
New-TransportRule -Name "<UniqueName>" -AttachmentHasExecutableContent $true [-RejectMessageEnhancedStatusCode <5.7.1 | 5.7.900 to 5.7.999>] [-RejectMessageReasonText "<Text>"] [-DeleteMessage $true]
```

**附註**：

- 如果您使用不是_RejectMessageReasonText_參數的_RejectMessageEnhancedStatusCode_參數，則預設文字為：傳遞未獲授權，郵件會遭到拒絕。

- 如果您使用不是_RejectMessageEnhancedStatusCode_參數的_RejectMessageReasonText_參數，則預設的程式碼為5.7.1。

這個範例會建立一個名為 Block 的可執行附件的新規則，此規則會以無訊息方式刪除包含可執行附件

```powershell
New-TransportRule -Name "Block Executable Attachments" -AttachmentHasExecutableContent $true -DeleteMessage $true
```

如需詳細的語法和參數資訊，請參閱 [New-TransportRule](https://docs.microsoft.com/powershell/module/exchange/policy-and-compliance/new-transportrule)。

## <a name="how-do-you-know-this-worked"></a>如何知道這是否正常運作？

若要確認您是否已成功建立郵件流程規則，以封鎖包含可執行附件的郵件，請執行下列任一步驟：

- 在 EAC 中，移至 [**郵件流程** \> **規則**] \> 選取規則 \> ，然後按一下 [**編輯** ![ 編輯圖示] ](../../media/ITPro-EAC-EditIcon.png) ，然後驗證設定。

- 在 PowerShell 中，執行下列命令來確認設定：

  ```powershell
  Get-TransportRule -Identity "<Rule Name>" | Format-List Name,AttachmentHasExecutableContent,RejectMessage*,DeleteMessage
  ```
