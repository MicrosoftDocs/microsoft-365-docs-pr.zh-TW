---
title: 設定反惡意程式碼原則
f1.keywords:
- NOCSH
ms.author: chrisda
author: chrisda
manager: dansimp
ms.date: ''
audience: ITPro
ms.topic: how-to
ms.service: O365-seccomp
localization_priority: Normal
search.appverid:
- MET150
ms.assetid: b0cfc21f-e3c6-41b6-8670-feb2b2e252e5
ms.collection:
- M365-security-compliance
- m365initiative-defender-office365
description: 系統管理員可以瞭解如何在 Exchange Online Protection (EOP) 中查看、建立、修改和移除反惡意程式碼原則。
ms.custom: seo-marvel-apr2020
ms.openlocfilehash: 1b96b2832af894ee943028fd7460c5eb17e8cc43
ms.sourcegitcommit: d81c7cea85af6ad5fef81d3c930514a51464368c
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 12/04/2020
ms.locfileid: "49572546"
---
# <a name="configure-anti-malware-policies-in-eop"></a><span data-ttu-id="22e41-103">在 EOP 中設定反惡意程式碼原則</span><span class="sxs-lookup"><span data-stu-id="22e41-103">Configure anti-malware policies in EOP</span></span>

[!INCLUDE [Microsoft 365 Defender rebranding](../includes/microsoft-defender-for-office.md)]


<span data-ttu-id="22e41-104">在有信箱在 Exchange Online 或獨立 Exchange Online Protection 中的 Microsoft 365 組織中 (EOP) 不含 Exchange Online 信箱的組織，電子郵件會自動受到 EOP 的惡意程式碼保護。</span><span class="sxs-lookup"><span data-stu-id="22e41-104">In Microsoft 365 organizations with mailboxes in Exchange Online or standalone Exchange Online Protection (EOP) organizations without Exchange Online mailboxes, email messages are automatically protected against malware by EOP.</span></span> <span data-ttu-id="22e41-105">EOP 會使用反惡意程式碼原則進行惡意程式碼保護設定。</span><span class="sxs-lookup"><span data-stu-id="22e41-105">EOP uses anti-malware policies for malware protection settings.</span></span> <span data-ttu-id="22e41-106">如需詳細資訊，請參閱 [反惡意程式碼保護](anti-malware-protection.md)。</span><span class="sxs-lookup"><span data-stu-id="22e41-106">For more information, see [Anti-malware protection](anti-malware-protection.md).</span></span>

<span data-ttu-id="22e41-107">系統管理員可以查看、編輯和設定 (，但不會刪除預設反惡意程式碼原則) ，以符合組織的需求。</span><span class="sxs-lookup"><span data-stu-id="22e41-107">Admins can view, edit, and configure (but not delete) the default anti-malware policy to meet the needs of their organizations.</span></span> <span data-ttu-id="22e41-108">為了獲得更多細微性，您也可以建立適用于組織中特定使用者、群組或網域的自訂反惡意程式碼原則。</span><span class="sxs-lookup"><span data-stu-id="22e41-108">For greater granularity, you can also create custom anti-malware policies that apply to specific users, groups, or domains in your organization.</span></span> <span data-ttu-id="22e41-109">自訂原則一律優先於預設原則，但您可以變更自訂原則的優先順序 (執行順序)。</span><span class="sxs-lookup"><span data-stu-id="22e41-109">Custom policies always take precedence over the default policy, but you can change the priority (running order) of your custom policies.</span></span>

<span data-ttu-id="22e41-110">您可以使用 Exchange Online 中的信箱，在安全性 & 合規性中心或 PowerShell (Exchange Online PowerShell 中設定 Microsoft 365 組織的反惡意程式碼原則;沒有 Exchange Online 信箱) 之組織的獨立 EOP PowerShell。</span><span class="sxs-lookup"><span data-stu-id="22e41-110">You can configure anti-malware policies in the Security & Compliance Center or in PowerShell (Exchange Online PowerShell for Microsoft 365 organizations with mailboxes in Exchange Online; standalone EOP PowerShell for organizations without Exchange Online mailboxes).</span></span>

## <a name="what-do-you-need-to-know-before-you-begin"></a><span data-ttu-id="22e41-111">開始之前有哪些須知？</span><span class="sxs-lookup"><span data-stu-id="22e41-111">What do you need to know before you begin?</span></span>

- <span data-ttu-id="22e41-112">您要在 <https://protection.office.com/> 開啟安全性與合規性中心。</span><span class="sxs-lookup"><span data-stu-id="22e41-112">You open the Security & Compliance Center at <https://protection.office.com/>.</span></span> <span data-ttu-id="22e41-113">若要直接移至 **反惡意** 字碼頁面，請使用 <https://protection.office.com/antimalware> 。</span><span class="sxs-lookup"><span data-stu-id="22e41-113">To go directly to the **Anti-malware** page, use <https://protection.office.com/antimalware>.</span></span>

- <span data-ttu-id="22e41-114">若要連線至 Exchange Online PowerShell，請參閱[連線至 Exchange Online PowerShell](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-powershell)。</span><span class="sxs-lookup"><span data-stu-id="22e41-114">To connect to Exchange Online PowerShell, see [Connect to Exchange Online PowerShell](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-powershell).</span></span> <span data-ttu-id="22e41-115">若要連接至獨立版 EOP PowerShell，請參閱[連線到 Exchange Online Protection PowerShell](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-protection-powershell)。</span><span class="sxs-lookup"><span data-stu-id="22e41-115">To connect to standalone EOP PowerShell, see [Connect to Exchange Online Protection PowerShell](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-protection-powershell).</span></span>

- <span data-ttu-id="22e41-116">您必須在安全性 & 合規性中心指派許可權，才能執行本文中的程式：</span><span class="sxs-lookup"><span data-stu-id="22e41-116">You need to be assigned permissions in the Security & Compliance Center before you can do the procedures in this article:</span></span>
  - <span data-ttu-id="22e41-117">若要新增、修改和刪除反惡意程式碼原則，您必須是「 **組織管理** 」或「 **安全性管理員** 」角色群組的成員。</span><span class="sxs-lookup"><span data-stu-id="22e41-117">To add, modify, and delete anti-malware policies, you need to be a member of the **Organization Management** or **Security Administrator** role groups.</span></span>
  - <span data-ttu-id="22e41-118">若要唯讀的反惡意程式碼原則的存取權，您必須是 **全域讀取器** 或 **安全性讀取器** 角色群組的成員。</span><span class="sxs-lookup"><span data-stu-id="22e41-118">For read-only access to anti-malware policies, you need to be a member of the **Global Reader** or **Security Reader** role groups.</span></span>

  <span data-ttu-id="22e41-119">如需詳細資訊，請參閱[安全性與合規性中心中的權限](permissions-in-the-security-and-compliance-center.md)。</span><span class="sxs-lookup"><span data-stu-id="22e41-119">For more information, see [Permissions in the Security & Compliance Center](permissions-in-the-security-and-compliance-center.md).</span></span>

  <span data-ttu-id="22e41-120">**附註**：</span><span class="sxs-lookup"><span data-stu-id="22e41-120">**Notes**:</span></span>

  - <span data-ttu-id="22e41-121">將使用者新增至 Microsoft 365 系統管理中心的對應 Azure Active Directory 角色，可讓使用者具備安全性 & 合規性中心的必要許可權 _，以及_ Microsoft 365 中其他功能的許可權。</span><span class="sxs-lookup"><span data-stu-id="22e41-121">Adding users to the corresponding Azure Active Directory role in the Microsoft 365 admin center gives users the required permissions in the Security & Compliance Center _and_ permissions for other features in Microsoft 365.</span></span> <span data-ttu-id="22e41-122">如需詳細資訊，請參閱[關於系統管理員角色](https://docs.microsoft.com/microsoft-365/admin/add-users/about-admin-roles)。</span><span class="sxs-lookup"><span data-stu-id="22e41-122">For more information, see [About admin roles](https://docs.microsoft.com/microsoft-365/admin/add-users/about-admin-roles).</span></span>
  - <span data-ttu-id="22e41-123">[Exchange Online](https://docs.microsoft.com/Exchange/permissions-exo/permissions-exo#role-groups)中的「 **View-Only 組織管理**」角色群組也會提供該功能的唯讀存取權。</span><span class="sxs-lookup"><span data-stu-id="22e41-123">The **View-Only Organization Management** role group in [Exchange Online](https://docs.microsoft.com/Exchange/permissions-exo/permissions-exo#role-groups) also gives read-only access to the feature.</span></span>

- <span data-ttu-id="22e41-124">如需有關反惡意程式碼原則的建議設定，請參閱 [EOP 防盜-惡意程式碼原則設定](recommended-settings-for-eop-and-office365-atp.md#eop-anti-malware-policy-settings)。</span><span class="sxs-lookup"><span data-stu-id="22e41-124">For our recommended settings for anti-malware policies, see [EOP anti-malware policy settings](recommended-settings-for-eop-and-office365-atp.md#eop-anti-malware-policy-settings).</span></span>

## <a name="use-the-security--compliance-center-to-create-anti-malware-policies"></a><span data-ttu-id="22e41-125">使用安全性 & 規範中心建立反惡意程式碼原則</span><span class="sxs-lookup"><span data-stu-id="22e41-125">Use the Security & Compliance Center to create anti-malware policies</span></span>

<span data-ttu-id="22e41-126">在安全性 & 合規性中心建立自訂的反惡意程式碼原則，會同時使用相同的名稱建立惡意軟體篩選規則和相關聯的惡意程式碼篩選原則。</span><span class="sxs-lookup"><span data-stu-id="22e41-126">Creating a custom anti-malware policy in the Security & Compliance Center creates the malware filter rule and the associated malware filter policy at the same time using the same name for both.</span></span>

1. <span data-ttu-id="22e41-127">在 [安全性 & 規範中心] 中，移至 [ **威脅管理** \> **原則**] \> **Anti-Malware**，然後按一下 [新增] [ **新增**] ![ 圖示 ](../../media/ITPro-EAC-AddIcon.png) 。</span><span class="sxs-lookup"><span data-stu-id="22e41-127">In the Security & Compliance Center, go to **Threat management** \> **Policy** \> **Anti-Malware**, and then click **New** ![Add Icon](../../media/ITPro-EAC-AddIcon.png).</span></span>

2. <span data-ttu-id="22e41-128">在開啟的 [新增反惡意程式碼原則] 頁面中，進行以下設定：</span><span class="sxs-lookup"><span data-stu-id="22e41-128">In the **New anti-malware policy** page that opens, configure these settings:</span></span>

   - <span data-ttu-id="22e41-129">**名稱**：輸入原則的唯一描述性名稱。</span><span class="sxs-lookup"><span data-stu-id="22e41-129">**Name**: Enter a unique, descriptive name for the policy.</span></span>

   - <span data-ttu-id="22e41-130">**說明**：輸入原則的選擇性說明。</span><span class="sxs-lookup"><span data-stu-id="22e41-130">**Description**: Enter an optional description for the policy.</span></span>

   - <span data-ttu-id="22e41-131">**惡意程式碼偵測回應**：針對 [您是否要在收件者的郵件遭到隔離時通知收件者？] 設定，選取下列其中一個值：</span><span class="sxs-lookup"><span data-stu-id="22e41-131">**Malware detection response**: Select one of these values for the **Do you want to notify recipients if their messages are quarantined?** setting:</span></span>

     - <span data-ttu-id="22e41-132">**No**：會隔離郵件，但不會通知預定的收件者。</span><span class="sxs-lookup"><span data-stu-id="22e41-132">**No**: The message is quarantined with no notification to the intended recipients.</span></span> <span data-ttu-id="22e41-133">這是預設值。</span><span class="sxs-lookup"><span data-stu-id="22e41-133">This is the default value.</span></span>

     - <span data-ttu-id="22e41-134">**是，並使用預設通知文字**：會隔離郵件。</span><span class="sxs-lookup"><span data-stu-id="22e41-134">**Yes and use the default notification text**: The message is quarantined.</span></span> <span data-ttu-id="22e41-135">郵件的複本會傳送給收件者，但是 *所有* 附件 (都不只是偵測到的檔案) 會以包含預設文字的單一文字檔（名為 **惡意程式碼警示 Text.txt** ）取代。</span><span class="sxs-lookup"><span data-stu-id="22e41-135">A copy of the message is delivered to the recipients, but *all* attachments (not just the detected ones) are replaced with a single text file named **Malware Alert Text.txt** that contains the default text.</span></span> <span data-ttu-id="22e41-136">針對預設文字，請參閱 [反惡意程式碼原則](anti-malware-protection.md#anti-malware-policies)。</span><span class="sxs-lookup"><span data-stu-id="22e41-136">For the default text, see [Anti-malware policies](anti-malware-protection.md#anti-malware-policies).</span></span>

     - <span data-ttu-id="22e41-137">**是和使用自訂通知文字**：會隔離郵件。</span><span class="sxs-lookup"><span data-stu-id="22e41-137">**Yes and use the custom notification text**: The message is quarantined.</span></span> <span data-ttu-id="22e41-138">郵件的複本會傳送給收件者，但 *所有* 附件 (都不只是偵測到的檔案) 會取代為單一文字檔（名為 **惡意程式碼警示** ），Text.txt包含您在 **自訂警示文字方塊** 中指定的自訂文字。</span><span class="sxs-lookup"><span data-stu-id="22e41-138">A copy of the message is delivered to the recipients, but *all* attachments (not just the detected ones) are replaced with a single text file named **Malware Alert Text.txt** contains custom text you specify in the **Custom alert text** box.</span></span>

   - <span data-ttu-id="22e41-139">**常見附件類型篩選**：請選取下列其中一個值，以 **封鎖可能會損害您電腦的附件類型。**：</span><span class="sxs-lookup"><span data-stu-id="22e41-139">**Common Attachment Types Filter**: Select one of these values for **blocking attachment types that may harm your computer.**:</span></span>

     - <span data-ttu-id="22e41-140">**關閉**</span><span class="sxs-lookup"><span data-stu-id="22e41-140">**Off**</span></span>

     - <span data-ttu-id="22e41-141">**開啟**：具有指定附件的郵件會被視為惡意程式碼偵測，而且會自動隔離。</span><span class="sxs-lookup"><span data-stu-id="22e41-141">**On**: Messages with the specified attachments are treated as malware detections and are automatically quarantined.</span></span> <span data-ttu-id="22e41-142">您可以修改清單備份按一下 [ **新增**  ] 和 [ **移除** ] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="22e41-142">You can modify the list bu clicking the **Add**  and **Remove** buttons.</span></span>

   - <span data-ttu-id="22e41-143">**惡意程式碼零小時自動清除**：惡意程式碼 ZAP 會隔離已傳遞的郵件。</span><span class="sxs-lookup"><span data-stu-id="22e41-143">**Malware Zero-hour Auto Purge**: Malware ZAP quarantines messages that have already been delivered.</span></span> <span data-ttu-id="22e41-144">如需詳細資訊，請參閱 [0 小時自動清除 (ZAP) 在 Exchange Online 中](zero-hour-auto-purge.md)。</span><span class="sxs-lookup"><span data-stu-id="22e41-144">For more information, see [Zero-hour auto purge (ZAP) in Exchange Online](zero-hour-auto-purge.md).</span></span> <span data-ttu-id="22e41-145">選取下列其中一個值：</span><span class="sxs-lookup"><span data-stu-id="22e41-145">Select one of these values:</span></span>

     - <span data-ttu-id="22e41-146">**關閉**</span><span class="sxs-lookup"><span data-stu-id="22e41-146">**Off**</span></span>

     - <span data-ttu-id="22e41-147">**開啟 (建議使用)**</span><span class="sxs-lookup"><span data-stu-id="22e41-147">**On (Recommended)**</span></span>

   - <span data-ttu-id="22e41-148">**通知**：此區段中的設定會在郵件中偵測到惡意軟體時，控制寄件者和系統管理員通知。</span><span class="sxs-lookup"><span data-stu-id="22e41-148">**Notification**: The settings in this section control sender and admin notifications when malware is detected in a message.</span></span>

     - <span data-ttu-id="22e41-149">**寄件者通知**：選取下列其中一個選項或兩者皆選取：</span><span class="sxs-lookup"><span data-stu-id="22e41-149">**Sender Notifications**: Select one or both of these options:</span></span>

       - <span data-ttu-id="22e41-150">**通知內部寄件者**：內部寄件者是在組織內。</span><span class="sxs-lookup"><span data-stu-id="22e41-150">**Notify internal senders**: An internal sender is inside the organization.</span></span>

       - <span data-ttu-id="22e41-151">**通知外部寄件者**：外部寄件者是在組織外。</span><span class="sxs-lookup"><span data-stu-id="22e41-151">**Notify external senders**: An external sender is outside the organization.</span></span>

     - <span data-ttu-id="22e41-152">**系統管理員通知**：選取下列其中一個選項或兩者皆選取：</span><span class="sxs-lookup"><span data-stu-id="22e41-152">**Administrator Notifications**: Select one or both of these options:</span></span>

       - <span data-ttu-id="22e41-153">**通知系統管理員來自內部寄件者的未傳遞郵件**：如果您選取此選項，請在 [ **系統管理員電子郵件地址** ] 方塊中輸入通知電子郵件地址。</span><span class="sxs-lookup"><span data-stu-id="22e41-153">**Notify administrator about undelivered messages from internal senders**: If you select this option, enter a notification email address in the **Administrator email address** box.</span></span>

       - <span data-ttu-id="22e41-154">**通知系統管理員來自外部寄件者的未傳遞郵件**：如果您選取此選項，請在 [ **系統管理員電子郵件地址** ] 方塊中輸入通知電子郵件地址。</span><span class="sxs-lookup"><span data-stu-id="22e41-154">**Notify administrator about undelivered messages from external senders**: If you select this option, enter a notification email address in the **Administrator email address** box.</span></span>

     - <span data-ttu-id="22e41-155">**自訂通知**：這些設定會取代用於寄件者或系統管理員的預設通知文字。</span><span class="sxs-lookup"><span data-stu-id="22e41-155">**Customize Notifications**: These settings replace the default notification text that's used for senders or administrators.</span></span> <span data-ttu-id="22e41-156">如需預設值的詳細資訊，請參閱[反惡意程式碼原則](anti-malware-protection.md#anti-malware-policies)。</span><span class="sxs-lookup"><span data-stu-id="22e41-156">For more information about the default values, see [Anti-malware policies](anti-malware-protection.md#anti-malware-policies).</span></span>

       - <span data-ttu-id="22e41-157">**使用自訂的通知文字**：如果您選取此選項，則必須使用 [寄件者 **名稱** ] 和 [寄件者 **位址** ] 方塊來指定自訂通知訊息中所使用的寄件者名稱和電子郵件地址。</span><span class="sxs-lookup"><span data-stu-id="22e41-157">**Use customized notification text**: If you select this option, you need to use the **From name** and **From address** boxes to specify the sender's name and email address that's used in the customized notification message.</span></span>

       - <span data-ttu-id="22e41-158">**來自內部寄件者的郵件**：如果選擇通知寄件者或系統管理員無法從內部寄件者傳遞郵件，您必須使用主旨及 **消息** 框來指定自訂通知訊息的 **主旨和郵件** 內文。</span><span class="sxs-lookup"><span data-stu-id="22e41-158">**Messages from internal senders**: If you elected to notify senders or administrators about undeliverable messages from internal senders, you need to use the **Subject** and **Message** boxes to specify the subject and message body of the custom notification message.</span></span>

       - <span data-ttu-id="22e41-159">**來自外部寄件者的郵件**：如果選擇通知寄件者或系統管理員無法傳遞來自外部寄件者的郵件，您必須使用主旨及 **消息** 框來指定自訂通知訊息的 **主旨和郵件** 內文。</span><span class="sxs-lookup"><span data-stu-id="22e41-159">**Messages from external senders**: If you elected to notify senders or administrators about undeliverable messages from external senders, you need to use the **Subject** and **Message** boxes to specify the subject and message body of the custom notification message.</span></span>

   - <span data-ttu-id="22e41-160">**套用至**：此區段中的設定會識別原則套用目標的內部收件者。</span><span class="sxs-lookup"><span data-stu-id="22e41-160">**Applied to**: The settings in this section identify the internal recipients that the policy applies to.</span></span>

     - <span data-ttu-id="22e41-161">**If**：按一下 [ **選取一個** 下拉式清單]，然後選取規則的條件：</span><span class="sxs-lookup"><span data-stu-id="22e41-161">**If**: Click on the **Select one** drop-down, and select conditions for the rule:</span></span>

       - <span data-ttu-id="22e41-162">**收件者是**：指定您組織中的一或多個信箱、郵件使用者或郵件連絡人。</span><span class="sxs-lookup"><span data-stu-id="22e41-162">**The recipient is**: Specifies one or more mailboxes, mail users, or mail contacts in your organization.</span></span> <span data-ttu-id="22e41-163">在顯示的 [選取成員] 對話方塊中，從清單選取一或多個收件者，然後按一下 [新增 -\>]。</span><span class="sxs-lookup"><span data-stu-id="22e41-163">In the **Select members** dialog box that appears, select one or more recipients from the list, and then click **add -\>**.</span></span> <span data-ttu-id="22e41-164">在 [ **檢查名稱** ] 方塊中，您可以將萬用字元用於多個電子郵件地址 (例如： \* @fabrikam .com) 。</span><span class="sxs-lookup"><span data-stu-id="22e41-164">In the **Check names** box, you can use wildcards for multiple email addresses (for example: \*@fabrikam.com).</span></span> <span data-ttu-id="22e41-165">完成後，按一下 [確定]。</span><span class="sxs-lookup"><span data-stu-id="22e41-165">When you're finished, click **OK**.</span></span>

       - <span data-ttu-id="22e41-166">**收件者網域為**：指定您的組織中一或多個已設定公認的網域中的收件者。</span><span class="sxs-lookup"><span data-stu-id="22e41-166">**The recipient domain is**: Specifies recipients in one or more of the configured accepted domains your organization.</span></span> <span data-ttu-id="22e41-167">在顯示的對話方塊中，選取一或多個網域，然後按一下 [新增 -\>]。</span><span class="sxs-lookup"><span data-stu-id="22e41-167">In the dialog box that appears, select one or more domains, and then click **add -\>**.</span></span> <span data-ttu-id="22e41-168">完成後，按一下 [確定]。</span><span class="sxs-lookup"><span data-stu-id="22e41-168">When you're finished, click **OK**.</span></span>

       - <span data-ttu-id="22e41-169">**收件者以成員的身分存在於**：指定您組織中的一或多個群組。</span><span class="sxs-lookup"><span data-stu-id="22e41-169">**The recipient is a member of**: Specifies one or more groups in your organization.</span></span> <span data-ttu-id="22e41-170">在顯示的 [選取成員] 對話方塊中，從清單選取一或多個群組，然後按一下 [新增 -\>]。</span><span class="sxs-lookup"><span data-stu-id="22e41-170">In the **Select members** dialog box that appears, select one or more groups from the list, and then click **add -\>**.</span></span> <span data-ttu-id="22e41-171">完成後，按一下 [確定]。</span><span class="sxs-lookup"><span data-stu-id="22e41-171">When you're finished, click **OK**.</span></span>

     <span data-ttu-id="22e41-172">您只能使用一次條件，但是您可以指定條件的多個值。</span><span class="sxs-lookup"><span data-stu-id="22e41-172">You can only use a condition once, but you can specify multiple values for the condition.</span></span> <span data-ttu-id="22e41-173">相同條件使用或邏輯 (的多個值，例如 _\<recipient1\>_ 或 _\<recipient2\>_) 。</span><span class="sxs-lookup"><span data-stu-id="22e41-173">Multiple values of the same condition use OR logic (for example, _\<recipient1\>_ or _\<recipient2\>_).</span></span> <span data-ttu-id="22e41-174">使用不同的條件和邏輯 (例如， _\<recipient1\>_ 及 _\<member of group 1\>_) 。</span><span class="sxs-lookup"><span data-stu-id="22e41-174">Different conditions use AND logic (for example, _\<recipient1\>_ and _\<member of group 1\>_).</span></span> <span data-ttu-id="22e41-175">若要新增其他條件，請按一下 [新增條件]，然後從剩餘選項中進行選取。</span><span class="sxs-lookup"><span data-stu-id="22e41-175">To add more conditions, click **Add condition** and select from the remaining options.</span></span>

     - <span data-ttu-id="22e41-176">**除非**：若要新增規則的例外狀況，請按一下 [ **新增例外** 狀況]，然後按一下 [ **選取一個** 下拉式清單]，然後設定例外狀況。</span><span class="sxs-lookup"><span data-stu-id="22e41-176">**Except if**: To add exceptions for the rule, click **Add exception**, click on the **Select one** drop-down, and configure the exceptions.</span></span> <span data-ttu-id="22e41-177">設定和行為就像是條件。</span><span class="sxs-lookup"><span data-stu-id="22e41-177">The settings and behavior are exactly like the conditions.</span></span>

3. <span data-ttu-id="22e41-178">完成後，按一下 [儲存]。</span><span class="sxs-lookup"><span data-stu-id="22e41-178">When you're finished, click **Save**.</span></span>

## <a name="use-the-security--compliance-center-to-view-anti-malware-policies"></a><span data-ttu-id="22e41-179">使用安全性 & 規範中心來查看反惡意程式碼原則</span><span class="sxs-lookup"><span data-stu-id="22e41-179">Use the Security & Compliance Center to view anti-malware policies</span></span>

1. <span data-ttu-id="22e41-180">在 [安全性 & 規範中心] 中，移至 [ **威脅管理** \> **原則**] \> **Anti-Malware**。</span><span class="sxs-lookup"><span data-stu-id="22e41-180">In the Security & Compliance Center, go to **Threat management** \> **Policy** \> **Anti-Malware**.</span></span>

2. <span data-ttu-id="22e41-181">當您選取原則時，原則的相關資訊會顯示在詳細資料窗格中。</span><span class="sxs-lookup"><span data-stu-id="22e41-181">When you select a policy, information about the policy is displayed in the details pane.</span></span> <span data-ttu-id="22e41-182">若要查看原則的詳細資訊，請按一下 [編輯] ![編輯圖示](../../media/ITPro-EAC-EditIcon.png)。</span><span class="sxs-lookup"><span data-stu-id="22e41-182">To see more information about the policy, click **Edit** ![Edit icon](../../media/ITPro-EAC-EditIcon.png).</span></span>

   - <span data-ttu-id="22e41-183">**Enabled** 屬性值、**Priority** 屬性值及 [套用至] 索引標籤上的設定，是在惡意程式碼篩選規則中。</span><span class="sxs-lookup"><span data-stu-id="22e41-183">The **Enabled** property value, the **Priority** property value, and the settings on the **Applied to** tab are in the malware filter rule.</span></span>

   - <span data-ttu-id="22e41-184">[一般] 和 [設定] 索引標籤是在惡意程式碼篩選原則中。</span><span class="sxs-lookup"><span data-stu-id="22e41-184">The settings on the **General** and **Settings** tabs are in the malware filter policy.</span></span>

## <a name="use-the-security--compliance-center-to-modify-anti-malware-policies"></a><span data-ttu-id="22e41-185">使用安全性 & 規範中心來修改反惡意程式碼原則</span><span class="sxs-lookup"><span data-stu-id="22e41-185">Use the Security & Compliance Center to modify anti-malware policies</span></span>

1. <span data-ttu-id="22e41-186">在 [安全性 & 規範中心] 中，移至 [ **威脅管理** \> **原則**] \> **Anti-Malware**。</span><span class="sxs-lookup"><span data-stu-id="22e41-186">In the Security & Compliance Center, go to **Threat management** \> **Policy** \> **Anti-Malware**.</span></span>

2. <span data-ttu-id="22e41-187">選取原則，然後按一下 [編輯] ![編輯圖示](../../media/ITPro-EAC-EditIcon.png)。</span><span class="sxs-lookup"><span data-stu-id="22e41-187">Select the policy, and then click **Edit** ![Edit icon](../../media/ITPro-EAC-EditIcon.png).</span></span> <span data-ttu-id="22e41-188">如需這些設定的相關資訊，請參閱本主題中的 [使用 Security & 合規性中心建立反惡意程式碼原則](#use-the-security--compliance-center-to-create-anti-malware-policies) 一節。</span><span class="sxs-lookup"><span data-stu-id="22e41-188">For information about the settings, see the [Use the Security & Compliance Center to create anti-malware policies](#use-the-security--compliance-center-to-create-anti-malware-policies) section in this topic.</span></span>

   <span data-ttu-id="22e41-189">**附註**：</span><span class="sxs-lookup"><span data-stu-id="22e41-189">**Notes**:</span></span>

   - <span data-ttu-id="22e41-190">並非所有項目都在單一頁面上，設定分佈在 [一般]、[設定] 及 [套用至] 索引標籤中。</span><span class="sxs-lookup"><span data-stu-id="22e41-190">Instead of everything on one page, the settings are divided among the **General**, **Settings**, and **Applied to** tabs.</span></span> <span data-ttu-id="22e41-191">[套用 **至** ] 索引標籤無法在預設原則中使用，此預設 (原則會自動套用至) 的所有人。</span><span class="sxs-lookup"><span data-stu-id="22e41-191">The **Applied to** tab isn't available in the default policy named Default (which is automatically applied to everyone).</span></span>

   - <span data-ttu-id="22e41-192">您無法重新命名預設原則。</span><span class="sxs-lookup"><span data-stu-id="22e41-192">You can't rename the default policy.</span></span>

## <a name="use-the-security--compliance-center-to-enable-or-disable-anti-malware-policies"></a><span data-ttu-id="22e41-193">使用安全性 & 規範中心來啟用或停用反惡意程式碼原則</span><span class="sxs-lookup"><span data-stu-id="22e41-193">Use the Security & Compliance Center to enable or disable anti-malware policies</span></span>

1. <span data-ttu-id="22e41-194">在 [安全性 & 規範中心] 中，移至 [ **威脅管理** \> **原則**] \> **Anti-Malware**。</span><span class="sxs-lookup"><span data-stu-id="22e41-194">In the Security & Compliance Center, go to **Threat management** \> **Policy** \> **Anti-Malware**.</span></span>

2. <span data-ttu-id="22e41-195">從清單中選取原則，然後設定下列其中一項設定：</span><span class="sxs-lookup"><span data-stu-id="22e41-195">Select the policy from the list, and then configure one of the following settings:</span></span>

   - <span data-ttu-id="22e41-196">**停用原則**：清除 [啟用] 資料行中的核取方塊。</span><span class="sxs-lookup"><span data-stu-id="22e41-196">**Disable the policy**: Clear the check box in the **Enabled** column.</span></span> <span data-ttu-id="22e41-197">根據預設，當您在安全性 & 合規性中心建立反惡意程式碼原則時會啟用這些原則。</span><span class="sxs-lookup"><span data-stu-id="22e41-197">By default, anti-malware policies are enabled when you create them in the Security & Compliance Center.</span></span>

   - <span data-ttu-id="22e41-198">**啟用原則**：選取 [啟用] 資料行中的核取方塊。</span><span class="sxs-lookup"><span data-stu-id="22e41-198">**Enable the policy**: Select the check box in the **Enabled** column.</span></span>

## <a name="use-the-security--compliance-center-to-set-the-priority-of-custom-anti-malware-policies"></a><span data-ttu-id="22e41-199">使用安全性 & 規範中心設定自訂反惡意程式碼原則的優先順序</span><span class="sxs-lookup"><span data-stu-id="22e41-199">Use the Security & Compliance Center to set the priority of custom anti-malware policies</span></span>

<span data-ttu-id="22e41-200">根據預設，系統是根據反惡意程式碼原則的建立順序給予優先順序 (較新原則的優先順序比較舊原則的優先順序低)。</span><span class="sxs-lookup"><span data-stu-id="22e41-200">By default, anti-malware policies are given a priority that's based on the order they were created in (newer polices are lower priority than older policies).</span></span> <span data-ttu-id="22e41-201">較小的優先順序數字表示原則的優先順序較高，原則是依據優先順序進行處理 (較高優先順序的原則會在較低優先順序的原則前面進行處理)。</span><span class="sxs-lookup"><span data-stu-id="22e41-201">A lower priority number indicates a higher priority for the policy, and policies are processed in priority order (higher priority policies are processed before lower priority policies).</span></span> <span data-ttu-id="22e41-202">不論有幾個原則，都不會具有相同的優先順序，且在套用第一個原則之後，原則處理就會停止。</span><span class="sxs-lookup"><span data-stu-id="22e41-202">No two policies can have the same priority, and policy processing stops after the first policy is applied.</span></span>

 <span data-ttu-id="22e41-203">**附註**：</span><span class="sxs-lookup"><span data-stu-id="22e41-203">**Notes**:</span></span>

- <span data-ttu-id="22e41-204">在安全性 & 規範中心，您只能在建立反惡意程式碼原則之後變更其優先順序。</span><span class="sxs-lookup"><span data-stu-id="22e41-204">In the Security & Compliance Center, you can only change the priority of the anti-malware policy after you create it.</span></span> <span data-ttu-id="22e41-205">在 PowerShell 中，您可以在建立惡意程式碼篩選規則時覆寫預設優先順序 (會影響現有規則的優先順序)。</span><span class="sxs-lookup"><span data-stu-id="22e41-205">In PowerShell, you can override the default priority when you create the malware filter rule (which can affect the priority of existing rules).</span></span>

- <span data-ttu-id="22e41-206">在 [安全性 & 規範中心] 中，反惡意程式碼原則的處理順序是 (第一個原則的 **優先順序** 值為 0) 。</span><span class="sxs-lookup"><span data-stu-id="22e41-206">In the Security & Compliance Center, anti-malware policies are processed in the order that they're displayed (the first policy has the **Priority** value 0).</span></span> <span data-ttu-id="22e41-207">預設的反惡意程式碼原則的優先順序值為 **最低**，您無法變更。</span><span class="sxs-lookup"><span data-stu-id="22e41-207">The default anti-malware policy named Default has the priority value **Lowest**, and you can't change it.</span></span>

<span data-ttu-id="22e41-208">若要變更原則的優先順序，請在清單中將原則上移或下移 (您無法在安全性與合規性中心直接修改 [優先順序] 數字)。</span><span class="sxs-lookup"><span data-stu-id="22e41-208">To change the priority of a policy, move the policy up or down in the list (you can't directly modify the **Priority** number in the Security & Compliance Center).</span></span>

1. <span data-ttu-id="22e41-209">在 [安全性 & 規範中心] 中，移至 [ **威脅管理** \> **原則**] \> **Anti-Malware**。</span><span class="sxs-lookup"><span data-stu-id="22e41-209">In the Security & Compliance Center, go to **Threat management** \> **Policy** \> **Anti-Malware**.</span></span>

2. <span data-ttu-id="22e41-210">選取原則，然後按一下 [上移] (![向上箭頭圖示](../../media/ITPro-EAC-UpArrowIcon.png)) 或 [下移] (![向下箭頭圖示](../../media/ITPro-EAC-DownArrowIcon.png))，在清單中將規則上移或下移。</span><span class="sxs-lookup"><span data-stu-id="22e41-210">Select a policy, and then click **Move up** ![Up Arrow icon](../../media/ITPro-EAC-UpArrowIcon.png) or **Move down** ![Down Arrow icon](../../media/ITPro-EAC-DownArrowIcon.png) to move the rule up or down in the list.</span></span>

## <a name="use-the-security--compliance-center-to-remove-anti-malware-policies"></a><span data-ttu-id="22e41-211">使用安全性 & 規範中心移除反惡意程式碼原則</span><span class="sxs-lookup"><span data-stu-id="22e41-211">Use the Security & Compliance Center to remove anti-malware policies</span></span>

<span data-ttu-id="22e41-212">當您使用安全性 & 規範中心移除反惡意程式碼原則時，惡意軟體篩選規則和對應的惡意程式碼篩選原則都會同時刪除。</span><span class="sxs-lookup"><span data-stu-id="22e41-212">When you use the Security & Compliance Center to remove an anti-malware policy, the malware filter rule and the corresponding malware filter policy are both deleted.</span></span>

1. <span data-ttu-id="22e41-213">在 [安全性 & 規範中心] 中，移至 [ **威脅管理** \> **原則**] \> **Anti-Malware**。</span><span class="sxs-lookup"><span data-stu-id="22e41-213">In the Security & Compliance Center, go to **Threat management** \> **Policy** \> **Anti-Malware**.</span></span>

2. <span data-ttu-id="22e41-214">選取您想要從清單中移除的反惡意程式碼原則，然後按一下 [刪除] (![刪除圖示](../../media/ITPro-EAC-DeleteIcon.png))。</span><span class="sxs-lookup"><span data-stu-id="22e41-214">Select the anti-malware policy you want to remove from the list, and then click **Delete** ![Delete icon](../../media/ITPro-EAC-DeleteIcon.png).</span></span>

## <a name="use-exchange-online-powershell-or-standalone-eop-powershell-to-configure-anti-malware-policies"></a><span data-ttu-id="22e41-215">使用 Exchange Online PowerShell 或獨立 EOP PowerShell 設定反惡意程式碼原則</span><span class="sxs-lookup"><span data-stu-id="22e41-215">Use Exchange Online PowerShell or standalone EOP PowerShell to configure anti-malware policies</span></span>

### <a name="use-powershell-to-create-anti-malware-policies"></a><span data-ttu-id="22e41-216">使用 PowerShell 來建立反惡意程式碼原則</span><span class="sxs-lookup"><span data-stu-id="22e41-216">Use PowerShell to create anti-malware policies</span></span>

<span data-ttu-id="22e41-217">若要在 PowerShell 中建立反惡意程式碼原則，需執行兩個步驟：</span><span class="sxs-lookup"><span data-stu-id="22e41-217">Creating an anti-malware policy in PowerShell is a two-step process:</span></span>

1. <span data-ttu-id="22e41-218">建立惡意程式碼篩選原則。</span><span class="sxs-lookup"><span data-stu-id="22e41-218">Create the malware filter policy.</span></span>

2. <span data-ttu-id="22e41-219">建立惡意程式碼篩選規則，此規則會指定要套用規則的惡意程式碼篩選原則。</span><span class="sxs-lookup"><span data-stu-id="22e41-219">Create the malware filter rule that specifies the malware filter policy that the rule applies to.</span></span>

 <span data-ttu-id="22e41-220">**附註**：</span><span class="sxs-lookup"><span data-stu-id="22e41-220">**Notes**:</span></span>

- <span data-ttu-id="22e41-221">您可以建立新的惡意程式碼篩選規則，並對其指派未關聯的現有惡意程式碼篩選原則。</span><span class="sxs-lookup"><span data-stu-id="22e41-221">You can create a new malware filter rule and assign an existing, unassociated malware filter policy to it.</span></span> <span data-ttu-id="22e41-222">惡意程式碼篩選規則無法與多個惡意程式碼篩選原則相關聯。</span><span class="sxs-lookup"><span data-stu-id="22e41-222">A malware filter rule can't be associated with more than one malware filter policy.</span></span>

- <span data-ttu-id="22e41-223">您可以在新的反惡意程式碼原則上，進行下列兩項設定：在您建立原則之前，您無法在 PowerShell 中使用 & 相容性中心的安全性：</span><span class="sxs-lookup"><span data-stu-id="22e41-223">There are two settings that you can configure on new anti-malware policies in PowerShell that aren't available in the Security & Compliance Center until after you create the policy:</span></span>

  - <span data-ttu-id="22e41-224">_在_ `$false` **New-MalwareFilterRule** Cmdlet) 上，建立新原則做為已停用 (。</span><span class="sxs-lookup"><span data-stu-id="22e41-224">Create the new policy as disabled (_Enabled_ `$false` on the **New-MalwareFilterRule** cmdlet).</span></span>

  - <span data-ttu-id="22e41-225">在 _Priority_ _\<Number\>_ **New-MalwareFilterRule** Cmdlet) 上建立 (優先順序) 時，設定原則的優先順序。</span><span class="sxs-lookup"><span data-stu-id="22e41-225">Set the priority of the policy during creation (_Priority_ _\<Number\>_) on the **New-MalwareFilterRule** cmdlet).</span></span>

- <span data-ttu-id="22e41-226">在您將原則指派給惡意軟體篩選規則之前，您在 PowerShell 中建立的新惡意程式碼篩選原則不會出現在安全性 & 規範中心。</span><span class="sxs-lookup"><span data-stu-id="22e41-226">A new malware filter policy that you create in PowerShell isn't visible in the Security & Compliance Center until you assign the policy to a malware filter rule.</span></span>

#### <a name="step-1-use-powershell-to-create-a-malware-filter-policy"></a><span data-ttu-id="22e41-227">步驟 1：使用 PowerShell 建立惡意程式碼篩選原則</span><span class="sxs-lookup"><span data-stu-id="22e41-227">Step 1: Use PowerShell to create a malware filter policy</span></span>

<span data-ttu-id="22e41-228">**附注**：在 EOP 中， _Action_ 參數值 `DeleteMessage` ， `DeleteAttachmentAndUseDefaultAlert` 不會 `DeleteAttachmentAndUseCustomAlert` 刪除郵件。</span><span class="sxs-lookup"><span data-stu-id="22e41-228">**Note**: In EOP, the _Action_ parameter values `DeleteMessage`, `DeleteAttachmentAndUseDefaultAlert`, and `DeleteAttachmentAndUseCustomAlert` don't delete messages.</span></span> <span data-ttu-id="22e41-229">相反地，郵件會被隔離。</span><span class="sxs-lookup"><span data-stu-id="22e41-229">Instead, the messages are quarantined.</span></span> <span data-ttu-id="22e41-230">如需有關檢索隔離郵件的詳細資訊，請參閱 [在 EOP 中以系統管理員身分管理隔離的郵件和](manage-quarantined-messages-and-files.md)檔案。</span><span class="sxs-lookup"><span data-stu-id="22e41-230">For more information about retrieving quarantined messages, see [Manage quarantined messages and files as an admin in EOP](manage-quarantined-messages-and-files.md).</span></span>

<span data-ttu-id="22e41-231">若要建立惡意程式碼篩選原則，請使用下列語法：</span><span class="sxs-lookup"><span data-stu-id="22e41-231">To create a malware filter policy, use this syntax:</span></span>

```PowerShell
New-MalwareFilterPolicy -Name "<PolicyName>" [-Action <DeleteMessage | DeleteAttachmentAndUseDefaultAlert | DeleteAttachmentAndUseCustomAlert>] [-AdminDisplayName "<OptionalComments>"] [-CustomNotifications <$true | $false>] [<Inbound notification options>] [<Outbound notification options>]
```

<span data-ttu-id="22e41-232">本範例搭配下列設定建立命名為 Contoso Malware Filter Policy 的新惡意程式篩選原則：</span><span class="sxs-lookup"><span data-stu-id="22e41-232">This example creates a new malware filter policy named Contoso Malware Filter Policy with these settings:</span></span>

- <span data-ttu-id="22e41-233">隔離包含惡意程式碼的郵件，但未通知收件者 (我們不會使用 _Action_ 參數，而且預設值是 `DeleteMessage`) 。</span><span class="sxs-lookup"><span data-stu-id="22e41-233">Quarantine messages that contain malware without notifying the recipients (we aren't using the _Action_ parameter, and the default value is `DeleteMessage`).</span></span>

- <span data-ttu-id="22e41-234">在郵件中偵測到惡意程式碼時不通知郵件寄件者 (我們不是使用 _EnableExternalSenderNotifications_ 或 _EnableInternalSenderNotifications_ 參數，兩個參數的預設值都是 `$false`)。</span><span class="sxs-lookup"><span data-stu-id="22e41-234">Don't notify the message sender when malware is detected in the message (we aren't using the _EnableExternalSenderNotifications_ or _EnableInternalSenderNotifications_ parameters, and the default value for both is `$false`).</span></span>

- <span data-ttu-id="22e41-235">從內部寄件者的訊息中偵測到惡意程式時，通知管理員 admin@contoso.com。</span><span class="sxs-lookup"><span data-stu-id="22e41-235">Notify the administrator admin@contoso.com when malware is detected in a message from an internal sender.</span></span>

```PowerShell
New-MalwareFilterPolicy -Name "Contoso Malware Filter Policy" -EnableInternalSenderAdminNotifications $true -InternalSenderAdminAddress admin@contoso.com
```

<span data-ttu-id="22e41-236">如需詳細的語法及參數資訊，請參閱 [New-MalwareFilterPolicy](https://docs.microsoft.com/powershell/module/exchange/new-malwarefilterpolicy)。</span><span class="sxs-lookup"><span data-stu-id="22e41-236">For detailed syntax and parameter information, see [New-MalwareFilterPolicy](https://docs.microsoft.com/powershell/module/exchange/new-malwarefilterpolicy).</span></span>

#### <a name="step-2-use-powershell-to-create-a-malware-filter-rule"></a><span data-ttu-id="22e41-237">步驟 2：使用 PowerShell 建立惡意程式碼篩選規則</span><span class="sxs-lookup"><span data-stu-id="22e41-237">Step 2: Use PowerShell to create a malware filter rule</span></span>

<span data-ttu-id="22e41-238">若要建立惡意程式碼篩選規則，請使用下列語法：</span><span class="sxs-lookup"><span data-stu-id="22e41-238">To create a malware filter rule, use this syntax:</span></span>

```PowerShell
New-MalwareFilterRule -Name "<RuleName>" -MalwareFilterPolicy "<PolicyName>" <Recipient filters> [<Recipient filter exceptions>] [-Comments "<OptionalComments>"]
```

<span data-ttu-id="22e41-239">此範例使用下列設定來建立名稱為 Contoso Recipients 的新惡意軟體篩選規則：</span><span class="sxs-lookup"><span data-stu-id="22e41-239">This example creates a new malware filter rule named Contoso Recipients with these settings:</span></span>

- <span data-ttu-id="22e41-240">名為 Contoso Malware Filter Policy 的惡意程式碼篩選原則會與規則產生關聯。</span><span class="sxs-lookup"><span data-stu-id="22e41-240">The malware filter policy named Contoso Malware Filter Policy is associated with the rule.</span></span>

- <span data-ttu-id="22e41-241">規則會套用至 contoso.com 網域中的收件者。</span><span class="sxs-lookup"><span data-stu-id="22e41-241">The rule applies to recipients in the contoso.com domain.</span></span>

```PowerShell
New-MalwareFilterRule -Name "Contoso Recipients" -MalwareFilterPolicy "Contoso Malware Filter Policy" -RecipientDomainIs contoso.com
```

<span data-ttu-id="22e41-242">如需詳細的語法及參數資訊，請參閱 [New-MalwareFilterRule](https://docs.microsoft.com/powershell/module/exchange/new-malwarefilterrule)。</span><span class="sxs-lookup"><span data-stu-id="22e41-242">For detailed syntax and parameter information, see [New-MalwareFilterRule](https://docs.microsoft.com/powershell/module/exchange/new-malwarefilterrule).</span></span>

### <a name="use-powershell-to-view-malware-filter-policies"></a><span data-ttu-id="22e41-243">使用 PowerShell 檢視惡意程式碼篩選原則</span><span class="sxs-lookup"><span data-stu-id="22e41-243">Use PowerShell to view malware filter policies</span></span>

<span data-ttu-id="22e41-244">若要傳回所有惡意程式碼篩選原則的摘要清單，請執行下列命令：</span><span class="sxs-lookup"><span data-stu-id="22e41-244">To return a summary list of all malware filter policies, run this command:</span></span>

```PowerShell
Get-MalwareFilterPolicy
```

<span data-ttu-id="22e41-245">若要傳回特定惡意程式碼篩選原則的詳細資訊，請使用下列語法：</span><span class="sxs-lookup"><span data-stu-id="22e41-245">To return detailed information about a specific malware filter policy, use the this syntax:</span></span>

```PowerShell
Get-MalwareFilterPolicy -Identity "<PolicyName>" | Format-List [<Specific properties to view>]
```

<span data-ttu-id="22e41-246">此範例會傳回惡意程式碼篩選原則 (名稱為 Executives) 的所有屬性值。</span><span class="sxs-lookup"><span data-stu-id="22e41-246">This example returns all the property values for the malware filter policy named Executives.</span></span>

```PowerShell
Get-MalwareFilterPolicy -Identity "Executives" | Format-List
```

<span data-ttu-id="22e41-247">此範例只會傳回相同原則的指定屬性。</span><span class="sxs-lookup"><span data-stu-id="22e41-247">This example returns only the specified properties for the same policy.</span></span>

```PowerShell
Get-MalwareFilterPolicy -Identity "Executives" | Format-List Action,AdminDisplayName,CustomNotifications,Enable*Notifications
```

<span data-ttu-id="22e41-248">如需詳細的語法及參數資訊，請參閱 [Get-MalwareFilterPolicy](https://docs.microsoft.com/powershell/module/exchange/get-malwarefilterpolicy)。</span><span class="sxs-lookup"><span data-stu-id="22e41-248">For detailed syntax and parameter information, see [Get-MalwareFilterPolicy](https://docs.microsoft.com/powershell/module/exchange/get-malwarefilterpolicy).</span></span>

### <a name="use-powershell-to-view-malware-filter-rules"></a><span data-ttu-id="22e41-249">使用 PowerShell 檢視惡意程式碼篩選規則</span><span class="sxs-lookup"><span data-stu-id="22e41-249">Use PowerShell to view malware filter rules</span></span>

<span data-ttu-id="22e41-250">若要傳回所有惡意程式碼篩選規則的摘要清單，請執行下列命令：</span><span class="sxs-lookup"><span data-stu-id="22e41-250">To return a summary list of all malware filter rules, run this command:</span></span>

```PowerShell
Get-MalwareFilterRule
```

<span data-ttu-id="22e41-251">若要依啟用或停用篩選規則的清單，請執行下列命令：</span><span class="sxs-lookup"><span data-stu-id="22e41-251">To filter the list by enabled or disabled rules, run the following commands:</span></span>

```PowerShell
Get-HostedContentFilterRule -State Disabled
```

```PowerShell
Get-HostedContentFilterRule -State Enabled
```

<span data-ttu-id="22e41-252">若要傳回特定惡意程式碼篩選規則的詳細資訊，請使用下列語法：</span><span class="sxs-lookup"><span data-stu-id="22e41-252">To return detailed information about a specific malware filter rule, use this syntax:</span></span>

```PowerShell
Get-MalwareFilterRule -Identity "<RuleName>" | Format-List [<Specific properties to view>]
```

<span data-ttu-id="22e41-253">此範例會傳回惡意程式碼篩選規則 (名稱為 Executives) 的所有屬性值。</span><span class="sxs-lookup"><span data-stu-id="22e41-253">This example returns all the property values for the malware filter rule named Executives.</span></span>

```PowerShell
Get-MalwareFilterRule -Identity "Executives" | Format-List
```

<span data-ttu-id="22e41-254">此範例只會傳回相同規則的指定屬性。</span><span class="sxs-lookup"><span data-stu-id="22e41-254">This example returns only the specified properties for the same rule.</span></span>

```PowerShell
Get-MalwareFilterRule -Identity "Executives" | Format-List Name,Priority,State,MalwareFilterPolicy,*Is,*SentTo,*MemberOf
```

<span data-ttu-id="22e41-255">如需詳細的語法及參數資訊，請參閱 [Get-MalwareFilterRule](https://docs.microsoft.com/powershell/module/exchange/get-malwarefilterrule)。</span><span class="sxs-lookup"><span data-stu-id="22e41-255">For detailed syntax and parameter information, see [Get-MalwareFilterRule](https://docs.microsoft.com/powershell/module/exchange/get-malwarefilterrule).</span></span>

### <a name="use-powershell-to-modify-malware-filter-policies"></a><span data-ttu-id="22e41-256">使用 PowerShell 修改惡意程式碼篩選原則</span><span class="sxs-lookup"><span data-stu-id="22e41-256">Use PowerShell to modify malware filter policies</span></span>

<span data-ttu-id="22e41-257">除了下列專案之外，當您在 PowerShell 中修改惡意程式碼篩選原則時，當您在本主題稍早的 [步驟1：使用 PowerShell 建立惡意程式碼篩選原則](#step-1-use-powershell-to-create-a-malware-filter-policy) 區段中所述時，就可以使用相同的設定。</span><span class="sxs-lookup"><span data-stu-id="22e41-257">Other than the following items, the same settings are available when you modify a malware filter policy in PowerShell as when you create the policy as described in the [Step 1: Use PowerShell to create a malware filter policy](#step-1-use-powershell-to-create-a-malware-filter-policy) section earlier in this topic.</span></span>

- <span data-ttu-id="22e41-258">_MakeDefault_ 參數會將指定的原則轉換成預設原則 (套用至所有人、不可修改的 **最低** 優先順序，而且您無法刪除只有當您在 PowerShell 中修改惡意程式碼篩選原則時，才可使用此參數) 。</span><span class="sxs-lookup"><span data-stu-id="22e41-258">The _MakeDefault_ switch that turns the specified policy into the default policy (applied to everyone, unmodifiable **Lowest** priority, and you can't delete it) is only available when you modify a malware filter policy in PowerShell.</span></span>

- <span data-ttu-id="22e41-259">您無法重新命名惡意程式碼篩選原則 (**Set-MalwareFilterPolicy** Cmdlet 沒有 _Name_ 參數) 。</span><span class="sxs-lookup"><span data-stu-id="22e41-259">You can't rename a malware filter policy (the **Set-MalwareFilterPolicy** cmdlet has no _Name_ parameter).</span></span> <span data-ttu-id="22e41-260">當您在安全性 & 規範中心重新命名反惡意程式碼原則時，您只是重新命名惡意程式碼篩選 _規則_。</span><span class="sxs-lookup"><span data-stu-id="22e41-260">When you rename an anti-malware policy in the Security & Compliance Center, you're only renaming the malware filter _rule_.</span></span>

<span data-ttu-id="22e41-261">若要修改惡意程式碼篩選原則，請使用下列語法：</span><span class="sxs-lookup"><span data-stu-id="22e41-261">To modify a malware filter policy, use this syntax:</span></span>

```PowerShell
Set-MalwareFilterPolicy -Identity "<PolicyName>" <Settings>
```

<span data-ttu-id="22e41-262">如需詳細的語法及參數資訊，請參閱 [Set-MalwareFilterPolicy](https://docs.microsoft.com/powershell/module/exchange/set-malwarefilterpolicy)。</span><span class="sxs-lookup"><span data-stu-id="22e41-262">For detailed syntax and parameter information, see [Set-MalwareFilterPolicy](https://docs.microsoft.com/powershell/module/exchange/set-malwarefilterpolicy).</span></span>

### <a name="use-powershell-to-modify-malware-filter-rules"></a><span data-ttu-id="22e41-263">使用 PowerShell 修改惡意程式碼篩選規則</span><span class="sxs-lookup"><span data-stu-id="22e41-263">Use PowerShell to modify malware filter rules</span></span>

<span data-ttu-id="22e41-264">當您在 PowerShell 中修改惡意程式碼篩選規則時，唯一可用的設定是 _Enabled_ 參數，可讓您建立已停用的規則。</span><span class="sxs-lookup"><span data-stu-id="22e41-264">The only setting that isn't available when you modify a malware filter rule in PowerShell is the _Enabled_ parameter that allows you to create a disabled rule.</span></span> <span data-ttu-id="22e41-265">若要啟用或停用現有的惡意程式碼篩選規則，請參閱下一節。</span><span class="sxs-lookup"><span data-stu-id="22e41-265">To enable or disable existing malware filter rules, see the next section.</span></span>

<span data-ttu-id="22e41-266">否則，當您在 PowerShell 中修改惡意程式碼篩選規則時，不會有其他設定可供使用。</span><span class="sxs-lookup"><span data-stu-id="22e41-266">Otherwise, no additional settings are available when you modify a malware filter rule in PowerShell.</span></span> <span data-ttu-id="22e41-267">如本主題稍早的 [步驟2：使用 PowerShell 來建立惡意軟體篩選規則](#step-2-use-powershell-to-create-a-malware-filter-rule) 一節所述，建立規則時，可以使用相同的設定。</span><span class="sxs-lookup"><span data-stu-id="22e41-267">The same settings are available when you create a rule as described in the [Step 2: Use PowerShell to create a malware filter rule](#step-2-use-powershell-to-create-a-malware-filter-rule) section earlier in this topic.</span></span>

<span data-ttu-id="22e41-268">若要修改惡意程式碼篩選規則，請使用下列語法：</span><span class="sxs-lookup"><span data-stu-id="22e41-268">To modify a malware filter rule, use this syntax:</span></span>

```PowerShell
Set-MalwareFilterRule -Identity "<RuleName>" <Settings>
```

<span data-ttu-id="22e41-269">如需詳細的語法及參數資訊，請參閱 [Set-MalwareFilterRule](https://docs.microsoft.com/powershell/module/exchange/set-malwarefilterrule)。</span><span class="sxs-lookup"><span data-stu-id="22e41-269">For detailed syntax and parameter information, see [Set-MalwareFilterRule](https://docs.microsoft.com/powershell/module/exchange/set-malwarefilterrule).</span></span>

### <a name="use-powershell-to-enable-or-disable-malware-filter-rules"></a><span data-ttu-id="22e41-270">使用 PowerShell 來啟用或停用惡意程式碼篩選規則</span><span class="sxs-lookup"><span data-stu-id="22e41-270">Use PowerShell to enable or disable malware filter rules</span></span>

<span data-ttu-id="22e41-271">在 PowerShell 中啟用或停用惡意程式碼篩選規則，可啟用或停用惡意程式碼篩選規則和指派的惡意程式碼篩選原則)  (的整個反惡意程式碼原則。</span><span class="sxs-lookup"><span data-stu-id="22e41-271">Enabling or disabling a malware filter rule in PowerShell enables or disables the whole anti-malware policy (the malware filter rule and the assigned malware filter policy).</span></span> <span data-ttu-id="22e41-272">您無法啟用或停用預設反惡意程式碼原則 (永遠永遠套用至所有收件者) 。</span><span class="sxs-lookup"><span data-stu-id="22e41-272">You can't enable or disable the default anti-malware policy (it's always always applied to all recipients).</span></span>

<span data-ttu-id="22e41-273">若要在 PowerShell 中啟用或停用惡意程式碼篩選規則，請使用下列語法：</span><span class="sxs-lookup"><span data-stu-id="22e41-273">To enable or disable a malware filter rule in PowerShell, use this syntax:</span></span>

```PowerShell
<Enable-MalwareFilterRule | Disable-MalwareFilterRule> -Identity "<RuleName>"
```

<span data-ttu-id="22e41-274">此範例會停用名稱為 Marketing Department 的惡意程式碼篩選規則。</span><span class="sxs-lookup"><span data-stu-id="22e41-274">This example disables the malware filter rule named Marketing Department.</span></span>

```PowerShell
Disable-MalwareFilterRule -Identity "Marketing Department"
```

<span data-ttu-id="22e41-275">此範例會啟用相同規則。</span><span class="sxs-lookup"><span data-stu-id="22e41-275">This example enables same rule.</span></span>

```PowerShell
Enable-MalwareFilterRule -Identity "Marketing Department"
```

<span data-ttu-id="22e41-276">如需詳細的語法及參數資訊，請參閱 [Enable-MalwareFilterRule](https://docs.microsoft.com/powershell/module/exchange/enable-malwarefilterrule) 和 [Disable-MalwareFilterRule](https://docs.microsoft.com/powershell/module/exchange/disable-malwarefilterrule)。</span><span class="sxs-lookup"><span data-stu-id="22e41-276">For detailed syntax and parameter information, see [Enable-MalwareFilterRule](https://docs.microsoft.com/powershell/module/exchange/enable-malwarefilterrule) and [Disable-MalwareFilterRule](https://docs.microsoft.com/powershell/module/exchange/disable-malwarefilterrule).</span></span>

### <a name="use-powershell-to-set-the-priority-of-malware-filter-rules"></a><span data-ttu-id="22e41-277">使用 PowerShell 設定惡意軟體篩選規則的優先順序</span><span class="sxs-lookup"><span data-stu-id="22e41-277">Use PowerShell to set the priority of malware filter rules</span></span>

<span data-ttu-id="22e41-278">您可以對規則設定的最高優先順序值為 0。</span><span class="sxs-lookup"><span data-stu-id="22e41-278">The highest priority value you can set on a rule is 0.</span></span> <span data-ttu-id="22e41-279">您可以設定的最低值則取決於規則的數目。</span><span class="sxs-lookup"><span data-stu-id="22e41-279">The lowest value you can set depends on the number of rules.</span></span> <span data-ttu-id="22e41-280">例如，如果您有五個規則，則您可以使用 0 到 4 的優先順序值。</span><span class="sxs-lookup"><span data-stu-id="22e41-280">For example, if you have five rules, you can use the priority values 0 through 4.</span></span> <span data-ttu-id="22e41-281">變更現有規則的優先順序會對其他規則造成階層式影響。</span><span class="sxs-lookup"><span data-stu-id="22e41-281">Changing the priority of an existing rule can have a cascading effect on other rules.</span></span> <span data-ttu-id="22e41-282">例如，如果您有五個自訂規則 (優先順序 0 到 4)，而您將規則的優先順序變更為 2，則優先順序為 2 的現有規則會變更為優先順序 3，優先順序 3 的規則會變更為優先順序 4。</span><span class="sxs-lookup"><span data-stu-id="22e41-282">For example, if you have five custom rules (priorities 0 through 4), and you change the priority of a rule to 2, the existing rule with priority 2 is changed to priority 3, and the rule with priority 3 is changed to priority 4.</span></span>

<span data-ttu-id="22e41-283">若要在 PowerShell 中設定惡意軟體篩選規則的優先順序，請使用下列語法：</span><span class="sxs-lookup"><span data-stu-id="22e41-283">To set the priority of a malware filter rule in PowerShell, use the following syntax:</span></span>

```PowerShell
Set-MalwareFilterRule -Identity "<RuleName>" -Priority <Number>
```

<span data-ttu-id="22e41-284">此範例會將規則 (名稱為 Marketing Department) 的優先順序設定為 2。</span><span class="sxs-lookup"><span data-stu-id="22e41-284">This example sets the priority of the rule named Marketing Department to 2.</span></span> <span data-ttu-id="22e41-285">優先順序小於或等於 2 的所有現有規則會減 1 (它們的優先順序數字會加 1)。</span><span class="sxs-lookup"><span data-stu-id="22e41-285">All existing rules that have a priority less than or equal to 2 are decreased by 1 (their priority numbers are increased by 1).</span></span>

```PowerShell
Set-MalwareFilterRule -Identity "Marketing Department" -Priority 2
```

<span data-ttu-id="22e41-286">**附註**：</span><span class="sxs-lookup"><span data-stu-id="22e41-286">**Notes**:</span></span>

- <span data-ttu-id="22e41-287">若要在建立新規則時設定其優先順序，請改用 **New-MalwareFilterRule** Cmdlet 上的 _priority_ 參數。</span><span class="sxs-lookup"><span data-stu-id="22e41-287">To set the priority of a new rule when you create it, use the _Priority_ parameter on the **New-MalwareFilterRule** cmdlet instead.</span></span>

- <span data-ttu-id="22e41-288">預設惡意程式碼篩選原則沒有對應的惡意軟體篩選規則，它永遠具有「未修改的優先順序 **」值。**</span><span class="sxs-lookup"><span data-stu-id="22e41-288">The default malware filter policy doesn't have a corresponding malware filter rule, and it always has the unmodifiable priority value **Lowest**.</span></span>

### <a name="use-powershell-to-remove-malware-filter-policies"></a><span data-ttu-id="22e41-289">使用 PowerShell 移除惡意程式碼篩選原則</span><span class="sxs-lookup"><span data-stu-id="22e41-289">Use PowerShell to remove malware filter policies</span></span>

<span data-ttu-id="22e41-290">當您使用 PowerShell 來移除惡意程式碼篩選原則時，對應的惡意程式碼篩選規則不會遭到移除。</span><span class="sxs-lookup"><span data-stu-id="22e41-290">When you use PowerShell to remove a malware filter policy, the corresponding malware filter rule isn't removed.</span></span>

<span data-ttu-id="22e41-291">若要在 PowerShell 中移除惡意程式碼篩選原則，請使用下列語法：</span><span class="sxs-lookup"><span data-stu-id="22e41-291">To remove a malware filter policy in PowerShell, use this syntax:</span></span>

```PowerShell
Remove-MalwareFilterPolicy -Identity "<PolicyName>"
```

<span data-ttu-id="22e41-292">此範例會移除名稱為 Marketing Department 的惡意程式碼篩選原則。</span><span class="sxs-lookup"><span data-stu-id="22e41-292">This example removes the malware filter policy named Marketing Department.</span></span>

```PowerShell
Remove-MalwareFilterPolicy -Identity "Marketing Department"
```

<span data-ttu-id="22e41-293">如需詳細的語法及參數資訊，請參閱 [Remove-MalwareFilterPolicy](https://docs.microsoft.com/powershell/module/exchange/remove-malwarefilterpolicy)。</span><span class="sxs-lookup"><span data-stu-id="22e41-293">For detailed syntax and parameter information, see [Remove-MalwareFilterPolicy](https://docs.microsoft.com/powershell/module/exchange/remove-malwarefilterpolicy).</span></span>

### <a name="use-powershell-to-remove-malware-filter-rules"></a><span data-ttu-id="22e41-294">使用 PowerShell 移除惡意程式碼篩選規則</span><span class="sxs-lookup"><span data-stu-id="22e41-294">Use PowerShell to remove malware filter rules</span></span>

<span data-ttu-id="22e41-295">當您使用 PowerShell 移除惡意程式碼篩選規則時，並不會移除對應的惡意程式碼篩選原則。</span><span class="sxs-lookup"><span data-stu-id="22e41-295">When you use PowerShell to remove a malware filter rule, the corresponding malware filter policy isn't removed.</span></span>

<span data-ttu-id="22e41-296">若要在 PowerShell 中移除惡意程式碼篩選規則，請使用下列語法：</span><span class="sxs-lookup"><span data-stu-id="22e41-296">To remove a malware filter rule in PowerShell, use this syntax:</span></span>

```PowerShell
Remove-MalwareFilterRule -Identity "<PolicyName>"
```

<span data-ttu-id="22e41-297">此範例會移除名為 Marketing 部門的惡意軟體篩選規則。</span><span class="sxs-lookup"><span data-stu-id="22e41-297">This example removes the malware filter rule named Marketing Department.</span></span>

```PowerShell
Remove-MalwareFilterRule -Identity "Marketing Department"
```

<span data-ttu-id="22e41-298">如需詳細的語法及參數資訊，請參閱 [Remove-MalwareFilterRule](https://docs.microsoft.com/powershell/module/exchange/remove-malwarefilterrule)。</span><span class="sxs-lookup"><span data-stu-id="22e41-298">For detailed syntax and parameter information, see [Remove-MalwareFilterRule](https://docs.microsoft.com/powershell/module/exchange/remove-malwarefilterrule).</span></span>

## <a name="how-do-you-know-these-procedures-worked"></a><span data-ttu-id="22e41-299">如何知道這些程序是否正常運作？</span><span class="sxs-lookup"><span data-stu-id="22e41-299">How do you know these procedures worked?</span></span>

### <a name="use-the-eicartxt-file-to-verify-your-anti-malware-policy-settings"></a><span data-ttu-id="22e41-300">使用 EICAR.TXT 檔案來驗證您的反惡意程式碼原則設定</span><span class="sxs-lookup"><span data-stu-id="22e41-300">Use the EICAR.TXT file to verify your anti-malware policy settings</span></span>

> [!IMPORTANT]
> <span data-ttu-id="22e41-301">EICAR.TXT 檔案不是病毒。</span><span class="sxs-lookup"><span data-stu-id="22e41-301">The EICAR.TXT file is not a virus.</span></span> <span data-ttu-id="22e41-302">《電腦防病毒研究的歐洲研究院 (EICAR.TXT) 開發此檔案，以安全地測試防病毒安裝和設定。</span><span class="sxs-lookup"><span data-stu-id="22e41-302">The European Institute for Computer Antivirus Research (EICAR) developed this file to safely test anti-virus installations and settings.</span></span>

1. <span data-ttu-id="22e41-303">開啟 [記事本]，並將下列文字貼至空白檔案：</span><span class="sxs-lookup"><span data-stu-id="22e41-303">Open Notepad and paste the following text into an empty file:</span></span>

   ```Text
   X5O!P%@AP[4\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*
   ```

   <span data-ttu-id="22e41-304">請確定這些是檔中唯一的文字字元。</span><span class="sxs-lookup"><span data-stu-id="22e41-304">Be sure that these are the only text characters in the file.</span></span> <span data-ttu-id="22e41-305">檔案大小應為68位元組。</span><span class="sxs-lookup"><span data-stu-id="22e41-305">The file size should be 68 bytes.</span></span>

2. <span data-ttu-id="22e41-306">將檔案儲存為 EICAR.TXT</span><span class="sxs-lookup"><span data-stu-id="22e41-306">Save the file as EICAR.TXT</span></span>

   <span data-ttu-id="22e41-307">在您的桌上型電腦防毒程式中，請務必從掃描中排除 EICAR.TXT (否則，將會) 隔離該檔案。</span><span class="sxs-lookup"><span data-stu-id="22e41-307">In your desktop anti-virus program, be sure to exclude the EICAR.TXT from scanning (otherwise, the file will be quarantined).</span></span>

3. <span data-ttu-id="22e41-308">使用不會自動封鎖檔的電子郵件客戶程式，傳送包含 EICAR.TXT 檔案的電子郵件。</span><span class="sxs-lookup"><span data-stu-id="22e41-308">Send an email message that contains the EICAR.TXT file as an attachment, using an email client that won't automatically block the file.</span></span> <span data-ttu-id="22e41-309">使用您的反惡意程式碼原則設定來決定要測試的下列案例：</span><span class="sxs-lookup"><span data-stu-id="22e41-309">Use your anti-malware policy settings to determine the following scenarios to test:</span></span>

   - <span data-ttu-id="22e41-310">從內部信箱到內部收件者的電子郵件。</span><span class="sxs-lookup"><span data-stu-id="22e41-310">Email from an internal mailbox to an internal recipient.</span></span>

   - <span data-ttu-id="22e41-311">從內部信箱到外部收件者的電子郵件。</span><span class="sxs-lookup"><span data-stu-id="22e41-311">Email from an internal mailbox to an external recipient.</span></span>

   - <span data-ttu-id="22e41-312">從外部信箱到內部收件者的電子郵件。</span><span class="sxs-lookup"><span data-stu-id="22e41-312">Email from an external mailbox to an internal recipient.</span></span>

4. <span data-ttu-id="22e41-313">請確認已隔離郵件，並根據您的反惡意程式碼原則設定驗證收件者和寄件者的通知結果。</span><span class="sxs-lookup"><span data-stu-id="22e41-313">Verify that the message was quarantined, and verify the recipient and sender notification results based on your anti-malware policy settings.</span></span> <span data-ttu-id="22e41-314">例如：</span><span class="sxs-lookup"><span data-stu-id="22e41-314">For example:</span></span>

   - <span data-ttu-id="22e41-315">收件者不會收到通知，或收件者會收到包含預設或自訂文字的 EICAR.TXT 附件（由 **惡意程式碼警示 Text.txt** 所取代）。</span><span class="sxs-lookup"><span data-stu-id="22e41-315">Recipients aren't notified, or recipients receive the original message with the EICAR.TXT attachment replaced by **Malware Alert Text.txt** that contains the default or customized text.</span></span>

   - <span data-ttu-id="22e41-316">會以預設或自訂的通知訊息通知內部或外部寄件者。</span><span class="sxs-lookup"><span data-stu-id="22e41-316">Internal or external senders are notified with the default or customized notification messages.</span></span>

   - <span data-ttu-id="22e41-317">您指定的系統管理員電子郵件地址會以預設或自訂的通知訊息通知內部或外部的郵件寄件者。</span><span class="sxs-lookup"><span data-stu-id="22e41-317">The admin email address that you specified is notified for internal or external message senders, with the default or customized notification messages.</span></span>

5. <span data-ttu-id="22e41-318">完成測試之後刪除 EICAR.TXT 檔案 (讓其他使用者不會因) 而不必要地發出警報。</span><span class="sxs-lookup"><span data-stu-id="22e41-318">Delete the EICAR.TXT file after your testing is complete (so other users aren't unnecessarily alarmed by it).</span></span>
