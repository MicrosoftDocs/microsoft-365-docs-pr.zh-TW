---
title: 設定反惡意程式碼原則
ms.author: tracyp
author: MSFTTracyp
manager: dansimp
ms.date: 3/17/2016
audience: ITPro
ms.topic: article
ms.service: O365-seccomp
localization_priority: Normal
search.appverid:
- MET150
ms.assetid: b0cfc21f-e3c6-41b6-8670-feb2b2e252e5
ms.collection:
- M365-security-compliance
description: 惡意程式碼篩選是透過反惡意程式碼原則自動在整個公司內啟用。
ms.openlocfilehash: 52c065136b37a6796fd8fcd5e821e4696b76d5f1
ms.sourcegitcommit: 5710ce729c55d95b8b452d99ffb7ea92b5cb254a
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 12/11/2019
ms.locfileid: "39971851"
---
# <a name="configure-anti-malware-policies"></a><span data-ttu-id="0898a-103">設定反惡意程式碼原則</span><span class="sxs-lookup"><span data-stu-id="0898a-103">Configure anti-malware policies</span></span>

 <span data-ttu-id="0898a-p101">惡意程式碼篩選是透過反惡意程式碼原則自動在整個公司內啟用。身為系統管理員，您可以檢視和編輯預設的反惡意程式碼原則，以便最符合您組織的需求，但是您無法刪除這些原則。若要提高精確性，您也可以建立自訂的惡意程式碼篩選原則，並將其套用至貴組織中的指定使用者、群組或網域。自訂原則一律優先於預設原則，但您可以變更自訂原則的優先順序 (執行順序)。</span><span class="sxs-lookup"><span data-stu-id="0898a-p101">Malware filtering is automatically enabled company-wide via the default anti-malware policy. As an administrator, you can view and edit, but not delete, the default anti-malware policy so that it is tailored to best meet the needs of your organization. For greater granularity, you can also create custom malware filter policies and apply them to specified users, groups, or domains in your organization. Custom policies always take precedence over the default policy, but you can change the priority (running order) of your custom policies.</span></span>

<span data-ttu-id="0898a-108">下列影片顯示本主題中針對反惡意程式碼原則所詳述的一些設定步驟：</span><span class="sxs-lookup"><span data-stu-id="0898a-108">The following video shows some of the configuration steps detailed in this topic for the anti-malware policies:</span></span>

> [!VIDEO https://www.microsoft.com/videoplayer/embed/12517702-ab48-4df8-a7ff-8eb02aa31724?autoplay=false]

<span data-ttu-id="0898a-109">如需有關反惡意程式碼原則的詳細資訊，請參閱[反惡意程式碼保護](anti-malware-protection.md)。</span><span class="sxs-lookup"><span data-stu-id="0898a-109">For more detailed information about malware filtering, see [Anti-malware protection](anti-malware-protection.md).</span></span>

## <a name="what-do-you-need-to-know-before-you-begin"></a><span data-ttu-id="0898a-110">開始之前有哪些須知？</span><span class="sxs-lookup"><span data-stu-id="0898a-110">What do you need to know before you begin?</span></span>

- <span data-ttu-id="0898a-111">若要開啟 Exchange 系統管理中心 (EAC)，請參閱 [Exchange Online 中的 Exchange 系統管理中心](https://docs.microsoft.com/Exchange/exchange-admin-center)或 [Exchange Online Protection 中的 Exchange 系統管理中心](exchange-admin-center-in-exchange-online-protection-eop.md)。</span><span class="sxs-lookup"><span data-stu-id="0898a-111">To open the Exchange admin center (EAC), see [Exchange admin center in Exchange Online](https://docs.microsoft.com/Exchange/exchange-admin-center) or [Exchange admin center in Exchange Online Protection](exchange-admin-center-in-exchange-online-protection-eop.md).</span></span>

- <span data-ttu-id="0898a-112">若要連線至 Exchange Online PowerShell，請參閱[連線至 Exchange Online PowerShell](https://docs.microsoft.com/powershell/exchange/exchange-online/connect-to-exchange-online-powershell/connect-to-exchange-online-powershell)。</span><span class="sxs-lookup"><span data-stu-id="0898a-112">To connect to Exchange Online PowerShell, see [Connect to Exchange Online PowerShell](https://docs.microsoft.com/powershell/exchange/exchange-online/connect-to-exchange-online-powershell/connect-to-exchange-online-powershell).</span></span> <span data-ttu-id="0898a-113">若要連接至 Exchange Online Protection PowerShell，請參閱[連線到 Exchange Online Protection PowerShell](https://docs.microsoft.com/powershell/exchange/exchange-eop/connect-to-exchange-online-protection-powershell)。</span><span class="sxs-lookup"><span data-stu-id="0898a-113">To connect to Exchange Online PowerShell, see [Connect to Exchange Online PowerShell](https://docs.microsoft.com/powershell/exchange/exchange-eop/connect-to-exchange-online-protection-powershell).</span></span>

- <span data-ttu-id="0898a-114">您必須已獲指派權限，才能執行此程序或這些程序。</span><span class="sxs-lookup"><span data-stu-id="0898a-114">You need to be assigned permissions before you can perform this procedure or procedures.</span></span> <span data-ttu-id="0898a-115">若要查看您需要的權限，請參閱 [Exchange Online 中的功能權限](https://docs.microsoft.com/exchange/permissions-exo/feature-permissions) 或 [EOP 中的功能權限](feature-permissions-in-eop.md)主題中的反惡意程式碼項目。</span><span class="sxs-lookup"><span data-stu-id="0898a-115">To see what permissions you need, see the Anti-spam entry in the [Feature Permissions in Exchange Online](https://docs.microsoft.com/exchange/permissions-exo/feature-permissions) topic.</span></span>

- <span data-ttu-id="0898a-116">如需適用於本主題中程序的快速鍵相關資訊，請參閱 [Exchange Online 中 Exchange 系統管理中心的鍵盤快速鍵](https://docs.microsoft.com/Exchange/accessibility/keyboard-shortcuts-in-admin-center)。</span><span class="sxs-lookup"><span data-stu-id="0898a-116">For information about keyboard shortcuts that may apply to the procedures in this topic, see [Keyboard shortcuts for the Exchange admin center](https://docs.microsoft.com/Exchange/accessibility/keyboard-shortcuts-in-admin-center).</span></span>

## <a name="use-the-eac-to-create-anti-malware-policies"></a><span data-ttu-id="0898a-117">使用 EAC 來建立反惡意程式碼原則</span><span class="sxs-lookup"><span data-stu-id="0898a-117">Use the EAC to configure anti-malware policies</span></span>

<span data-ttu-id="0898a-118">在 EAC 中建立自訂反惡意程式碼原則，會同時建立兩個相同名稱的惡意程式碼篩選規則和相關聯的惡意程式碼篩選原則。</span><span class="sxs-lookup"><span data-stu-id="0898a-118">Creating a custom anti-malware policy in the EAC creates the malware filter rule and the associated malware filter policy at the same time using the same name for both.</span></span>

1. <span data-ttu-id="0898a-119">在 EAC 中，移至 [保護]\*\*\*\* \> [惡意程式碼篩選]\*\*\*\*，然後按一下 [新增]\*\*\*\* ![新增圖示](../media/ITPro-EAC-AddIcon.png)。</span><span class="sxs-lookup"><span data-stu-id="0898a-119">In the EAC, go to to **Protection** \> **Malware filter**, and then click **New** ![Add Icon](../media/ITPro-EAC-AddIcon.png).</span></span>

2. <span data-ttu-id="0898a-120">在開啟的 [新增反惡意程式碼原則]\*\*\*\* 頁面中，進行以下設定：</span><span class="sxs-lookup"><span data-stu-id="0898a-120">In the **New anti-malware policy** page that opens, configure these settings:</span></span>

   - <span data-ttu-id="0898a-121">**名稱**：輸入原則的唯一描述性名稱。</span><span class="sxs-lookup"><span data-stu-id="0898a-121">**Name**: Enter a unique, descriptive name for the policy.</span></span>

   - <span data-ttu-id="0898a-122">**說明**：輸入原則的選擇性說明。</span><span class="sxs-lookup"><span data-stu-id="0898a-122">**Description**: Enter an optional description for the policy.</span></span>

   - <span data-ttu-id="0898a-123">**惡意程式碼偵測回應**：針對 [您是否要在收件者的郵件遭到隔離時通知收件者？]\*\*\*\* 設定，選取下列其中一個值：</span><span class="sxs-lookup"><span data-stu-id="0898a-123">**Malware detection response**: Select one of these values for the **Do you want to notify recipients if their messages are quarantined?** setting:</span></span>

     - <span data-ttu-id="0898a-124">**否**：防止整封郵件 (包括附件) 傳遞給預定收件者。</span><span class="sxs-lookup"><span data-stu-id="0898a-124">Delete the entire message Prevents the entire message, including attachments, from being delivered to the intended recipients.</span></span> <span data-ttu-id="0898a-125">這是預設值。</span><span class="sxs-lookup"><span data-stu-id="0898a-125">This is the default value.</span></span>

     - <span data-ttu-id="0898a-126">**是，並且使用預設通知文字**：使用包含以下預設文字的文字檔案，取代所有郵件附件 (不僅是偵測到的附件)：</span><span class="sxs-lookup"><span data-stu-id="0898a-126">**Yes and use the default notification text**: Replaces all message attachments (not just the detected ones) with a text file that contains this default text:</span></span>

       > <span data-ttu-id="0898a-127">此電子郵件內含的一個或多個附件偵測出惡意程式碼。</span><span class="sxs-lookup"><span data-stu-id="0898a-127">Malware was detected in one or more attachments included with this email.</span></span> <span data-ttu-id="0898a-128">已刪除所有的附件。</span><span class="sxs-lookup"><span data-stu-id="0898a-128">All attachments have been deleted."</span></span>

     - <span data-ttu-id="0898a-129">**是，並且使用自訂通知文字**：使用包含在 [自訂警示文字]\*\*\*\* 方塊中指定的自訂文字，取代所有郵件附件 (不僅是偵測到的附件)。</span><span class="sxs-lookup"><span data-stu-id="0898a-129">**Yes and use the custom notification text**: Replaces all message attachments (not just the detected ones) with a text file that contains custom text you specify in the **Custom alert text** box.</span></span>

     > [!NOTE]
     > <span data-ttu-id="0898a-130">如果在內送或外寄郵件的**郵件內文**中偵測到惡意程式碼，則系統會刪除整封郵件，不論您為 [惡意程式碼偵測回應]\*\*\*\* 所做的設定為何。</span><span class="sxs-lookup"><span data-stu-id="0898a-130">If malware is detected in the **message body** of an inbound or outbound message, the entire message is deleted, regardless of the setting you configure for **Malware detection response**.</span></span>
     
   - <span data-ttu-id="0898a-131">**常用附件類型篩選**：針對 [封鎖可能損害您電腦的附件類型]\*\*\*\*，選取下列其中一個值。</span><span class="sxs-lookup"><span data-stu-id="0898a-131">**Common Attachment Types Filter**: Select one of these values for **blocking attachment types that may harm your computer.**</span></span>
   
     - <span data-ttu-id="0898a-132">**關閉**</span><span class="sxs-lookup"><span data-stu-id="0898a-132">**Off**</span></span>
     
     - <span data-ttu-id="0898a-133">**開啟**：若電子郵件的附件屬於已篩選的檔案類型，則會觸發惡意程式碼偵測回應 (建議使用)。</span><span class="sxs-lookup"><span data-stu-id="0898a-133">**On**: Emails with attachments of filtered file types will trigger the Malware Detection Response (recommended).</span></span> <span data-ttu-id="0898a-134">開啟此功能可讓您新增要封鎖的檔案類型。</span><span class="sxs-lookup"><span data-stu-id="0898a-134">Turning this feature on lets you add file types to be blocked.</span></span>
    
    - <span data-ttu-id="0898a-135">**惡意程式碼零小時自動清除**：選取下列其中一個值，決定是否**使用您的原則動作來隔離傳遞之後偵測到惡意程式碼的郵件，以保護您的使用者。**</span><span class="sxs-lookup"><span data-stu-id="0898a-135">**Malware Zero-hour Auto Purge**: Select one of these values to **protect your users by automatically taking your policy's action to quarantine messages with malware detected after delivery.**</span></span>
   
      - <span data-ttu-id="0898a-136">**關閉**</span><span class="sxs-lookup"><span data-stu-id="0898a-136">**Off**</span></span>
     
      - <span data-ttu-id="0898a-137">**開啟 (建議使用)**</span><span class="sxs-lookup"><span data-stu-id="0898a-137">**On (Recommended)**</span></span>

   - <span data-ttu-id="0898a-138">**通知**：此區段中的設定會控制當惡意程式碼篩選刪除郵件時的通知。</span><span class="sxs-lookup"><span data-stu-id="0898a-138">**Notification**: The settings in this section control notifications when malware filtering deletes the message.</span></span> <span data-ttu-id="0898a-139">設定不會套用到其中的所有附件已由預設或自訂警示文字取代的郵件。</span><span class="sxs-lookup"><span data-stu-id="0898a-139">The settings don't apply to messages where all attachments are replaced by the default or custom alert text.</span></span>

     - <span data-ttu-id="0898a-140">**寄件者通知**：選取下列其中一個選項或兩者皆選取：</span><span class="sxs-lookup"><span data-stu-id="0898a-140">**Sender Notifications**: Select one or both of these options:</span></span>

       - <span data-ttu-id="0898a-141">**通知內部寄件者**：內部寄件者是在組織內。</span><span class="sxs-lookup"><span data-stu-id="0898a-141">**Notify internal senders**: An internal sender is inside the organization.</span></span>

       - <span data-ttu-id="0898a-142">**通知外部寄件者**：外部寄件者是在組織外。</span><span class="sxs-lookup"><span data-stu-id="0898a-142">**Notify external senders**: An external sender is outside the organization.</span></span>

     - <span data-ttu-id="0898a-143">**系統管理員通知**：選取下列其中一個選項或兩者皆選取：</span><span class="sxs-lookup"><span data-stu-id="0898a-143">**Administrator Notifications**: Select one or both of these options:</span></span>

       - <span data-ttu-id="0898a-144">**通知系統管理員有來自內部寄件者的郵件未傳遞**：如果您選取此選項，請在 [系統管理員電子郵件地址]\*\*\*\* 欄位中輸入一個通知電子郵件地址。</span><span class="sxs-lookup"><span data-stu-id="0898a-144">**Notify administrator about undelivered messages from internal senders**: If you select this option, enter a notification email address in the **Administrator email address** field.</span></span>

       - <span data-ttu-id="0898a-145">**通知系統管理員有來自外部寄件者的郵件未傳遞**：如果您選取此選項，請在 [系統管理員電子郵件地址]\*\*\*\* 欄位中輸入一個通知電子郵件地址。</span><span class="sxs-lookup"><span data-stu-id="0898a-145">**Notify administrator about undelivered messages from external senders**: If you select this option, enter a notification email address in the **Administrator email address** field.</span></span>

     - <span data-ttu-id="0898a-146">**自訂通知**：這些設定會取代用於寄件者或系統管理員的預設通知文字。</span><span class="sxs-lookup"><span data-stu-id="0898a-146">**Customize Notifications**: These settings replace the default notification text that's used for senders or administrators.</span></span> <span data-ttu-id="0898a-147">如需預設值的詳細資訊，請參閱[反惡意程式碼原則](anti-malware-protection.md#anti-malware-policies)。</span><span class="sxs-lookup"><span data-stu-id="0898a-147">For more information about the default values, see [Anti-malware policies](anti-malware-protection.md#anti-malware-policies).</span></span>

       - <span data-ttu-id="0898a-148">**使用自訂的通知文字**：如果您選取此選項，必須使用 [寄件者名稱]\*\*\*\* 和 [寄件者地址]\*\*\*\* 欄位，以指定在自訂的通知訊息中所使用的寄件者名稱和電子郵件。</span><span class="sxs-lookup"><span data-stu-id="0898a-148">**Use customized notification text**: If you select this option, you need to use the **From name** and **From address** fields to specify the sender's name and email that's used in the customized notification message.</span></span>

       - <span data-ttu-id="0898a-149">**來自內部寄件者的郵件**：如果您選擇通知寄件者或系統管理員有關來自內部寄件者的郵件無法傳遞，必須使用 [主旨]\*\*\*\* 和 [郵件]\*\*\*\* 欄位，以指定自訂通知訊息的主旨和郵件內文。</span><span class="sxs-lookup"><span data-stu-id="0898a-149">**Messages from internal senders**: If you elected to notify senders or administrators about undeliverable messages from internal senders, you need to use the **Subject** and **Message** fields to specify the subject and message body of the custom notification message.</span></span>

       - <span data-ttu-id="0898a-150">**來自外部寄件者的郵件**：如果您選擇通知寄件者或系統管理員有關來自外部寄件者的郵件無法傳遞，必須使用 [主旨]\*\*\*\* 和 [郵件]\*\*\*\* 欄位，以指定自訂通知訊息的主旨和郵件內文。</span><span class="sxs-lookup"><span data-stu-id="0898a-150">**Messages from external senders**: If you elected to notify senders or administrators about undeliverable messages from external senders, you need to use the **Subject** and **Message** fields to specify the subject and message body of the custom notification message.</span></span>

   - <span data-ttu-id="0898a-151">**套用至**：此區段中的設定會識別原則套用目標的內部收件者。</span><span class="sxs-lookup"><span data-stu-id="0898a-151">**Applied to**: The settings in this section identify the internal recipients that the policy applies to.</span></span>

     - <span data-ttu-id="0898a-152">**如果**：按一下 [請選擇一項]\*\*\*\* 下拉式清單，並且選取規則的條件：</span><span class="sxs-lookup"><span data-stu-id="0898a-152">**If**: Click on the **Select one** drop down, and select conditions for the rule:</span></span>

       - <span data-ttu-id="0898a-153">**收件者是**：指定您組織中的一或多個信箱、郵件使用者或郵件連絡人。</span><span class="sxs-lookup"><span data-stu-id="0898a-153">**The recipient is**: Specifies one or more mailboxes, mail users, or mail contacts in your organization.</span></span> <span data-ttu-id="0898a-154">在顯示的 [選取成員]\*\*\*\* 對話方塊中，從清單選取一或多個收件者，然後按一下 [新增 -\>]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="0898a-154">In the **Select members** dialog box that appears, select one or more recipients from the list, and then click **add -\>**.</span></span> <span data-ttu-id="0898a-155">在 [檢查名稱]\*\*\*\* 欄位中，您可以針對多個電子郵件地址使用萬用字元 (例如：\*@fabrikam.com)。</span><span class="sxs-lookup"><span data-stu-id="0898a-155">In the **Check names** field, you can use wildcards for multiple email addresses (for example: \*@fabrikam.com).</span></span> <span data-ttu-id="0898a-156">完成後，按一下 [確定]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="0898a-156">When you're finished, click **Save**.</span></span>

       - <span data-ttu-id="0898a-157">**收件者網域為**：指定 Office 365 中一個或多個接受網域 (已設定) 中的收件者。</span><span class="sxs-lookup"><span data-stu-id="0898a-157">**The recipient domain is**: Specifies recipients in one or more of the configured accepted domains in Office 365.</span></span> <span data-ttu-id="0898a-158">在顯示的對話方塊中，選取一或多個網域，然後按一下 [新增 -\>]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="0898a-158">In the dialog box that appears, select one or more domains, and then click **add -\>**.</span></span> <span data-ttu-id="0898a-159">完成後，按一下 [確定]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="0898a-159">When you're finished, click **Save**.</span></span>

       - <span data-ttu-id="0898a-160">**收件者以成員的身分存在於**：指定您組織中的一或多個群組。</span><span class="sxs-lookup"><span data-stu-id="0898a-160">**The recipient is a member of**: Specifies one or more groups in your organization.</span></span> <span data-ttu-id="0898a-161">在顯示的 [選取成員]\*\*\*\* 對話方塊中，從清單選取一或多個群組，然後按一下 [新增 -\>]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="0898a-161">In the **Select members** dialog box that appears, select one or more groups from the list, and then click **add -\>**.</span></span> <span data-ttu-id="0898a-162">完成後，按一下 [確定]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="0898a-162">When you're finished, click **Save**.</span></span>

     <span data-ttu-id="0898a-163">您一次只能使用一項作為條件，但是您可以針對條件指定多個值。</span><span class="sxs-lookup"><span data-stu-id="0898a-163">You can only use one a condition once, but you can specify multiple values for the condition.</span></span> <span data-ttu-id="0898a-164">若要新增其他條件，請按一下 [新增條件]\*\*\*\*，然後從剩餘選項中進行選取。</span><span class="sxs-lookup"><span data-stu-id="0898a-164">To add more conditions, click **Add condition** and select from the remaining options.</span></span>

     - <span data-ttu-id="0898a-165">**除非**：若要新增規則的例外狀況，按一下 [新增例外狀況]\*\*\*\*，按一下 [請選擇一項]\*\*\*\* 下拉式清單，然後設定規則的例外狀況。</span><span class="sxs-lookup"><span data-stu-id="0898a-165">**Except if**: To add exceptions for the rule, click **Add exception**, click on the **Select one** drop down, and configure an exception for the rule.</span></span> <span data-ttu-id="0898a-166">設定和行為就像是條件。</span><span class="sxs-lookup"><span data-stu-id="0898a-166">The settings and behavior is exactly like the conditions.</span></span>

3. <span data-ttu-id="0898a-167">完成後，請按一下 [儲存]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="0898a-167">When you're finished, click **Save**.</span></span>

## <a name="use-the-eac-to-view-anti-malware-policies"></a><span data-ttu-id="0898a-168">使用 EAC 來檢視反惡意程式碼原則</span><span class="sxs-lookup"><span data-stu-id="0898a-168">Use the EAC to configure anti-malware policies</span></span>

1. <span data-ttu-id="0898a-169">在 EAC 中，移至 [保護]\*\*\*\* \> [惡意程式碼篩選]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="0898a-169">In the EAC, go to **Protection** \> **Malware filter**.</span></span>

2. <span data-ttu-id="0898a-170">當您選取原則時，原則的相關資訊會顯示在詳細資料窗格中。</span><span class="sxs-lookup"><span data-stu-id="0898a-170">When you select a policy, information about the policy is displayed in the details pane.</span></span> <span data-ttu-id="0898a-171">若要查看原則的詳細資訊，請按一下 [編輯]\*\*\*\* ![編輯圖示](../media/ITPro-EAC-EditIcon.png)。</span><span class="sxs-lookup"><span data-stu-id="0898a-171">To see more information about the policy, click **Edit** ![Edit icon](../media/ITPro-EAC-EditIcon.png).</span></span>

   - <span data-ttu-id="0898a-172">**Enabled** 屬性值、**Priority** 屬性值及 [套用至]\*\*\*\* 索引標籤上的設定，是在惡意程式碼篩選規則中。</span><span class="sxs-lookup"><span data-stu-id="0898a-172">The **Enabled** property value, the **Priority** property value, and the settings on the **Applied to** tab are in the malware filter rule.</span></span>

   - <span data-ttu-id="0898a-173">[一般]\*\*\*\* 和 [設定]\*\*\*\* 索引標籤是在惡意程式碼篩選原則中。</span><span class="sxs-lookup"><span data-stu-id="0898a-173">The settings on the **General** and **Settings** tabs are in the malware filter policy.</span></span>

## <a name="use-the-eac-to-modify-an-anti-malware-policy"></a><span data-ttu-id="0898a-174">使用 EAC 來修改反惡意程式碼原則</span><span class="sxs-lookup"><span data-stu-id="0898a-174">Use the EAC to modify an anti-malware policy</span></span>

1. <span data-ttu-id="0898a-175">在 EAC 中，移至 [保護]\*\*\*\* \> [惡意程式碼篩選]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="0898a-175">In the EAC, go to **Protection** \> **Malware filter**.</span></span>

2. <span data-ttu-id="0898a-176">選取原則，然後按一下 [編輯]\*\*\*\* ![編輯圖示](../media/ITPro-EAC-EditIcon.png)。</span><span class="sxs-lookup"><span data-stu-id="0898a-176">Select a virtual directory and then click **Edit** ![Edit icon](../media/ITPro-EAC-EditIcon.png).</span></span> <span data-ttu-id="0898a-177">如需設定的詳細資訊，請參閱本主題中的[使用 EAC 來建立反惡意程式碼原則](#use-the-eac-to-create-anti-malware-policies)一節。</span><span class="sxs-lookup"><span data-stu-id="0898a-177">For more information about the settings in this dialog box, see the procedure [Use the EAC to create a journal rule](#use-the-eac-to-create-anti-malware-policies) earlier in this topic.</span></span>

   <span data-ttu-id="0898a-178">**附註**：</span><span class="sxs-lookup"><span data-stu-id="0898a-178">**Notes**:</span></span>

   - <span data-ttu-id="0898a-179">並非所有項目都在單一頁面上，設定分佈在 [一般]\*\*\*\*、[設定]\*\*\*\* 及 [套用至]\*\*\*\* 索引標籤中。</span><span class="sxs-lookup"><span data-stu-id="0898a-179">Instead of everything on one page, the settings are divided among the **General**, **Settings**, and **Applied to** tabs.</span></span> <span data-ttu-id="0898a-180">名為 Default 的預設原則上沒有 [套用至]\*\*\*\* 索引標籤。</span><span class="sxs-lookup"><span data-stu-id="0898a-180">The **Applied to** tab isn't available on the default policy named Default.</span></span>

   - <span data-ttu-id="0898a-181">您無法重新命名預設原則。</span><span class="sxs-lookup"><span data-stu-id="0898a-181">You cannot rename the default policy.</span></span>

## <a name="use-the-eac-to-enable-or-disable-an-anti-malware-policy"></a><span data-ttu-id="0898a-182">使用 EAC 來啟用或停用反惡意程式碼原則</span><span class="sxs-lookup"><span data-stu-id="0898a-182">Use the EAC to enable or disable an anti-malware policy</span></span>

1. <span data-ttu-id="0898a-183">在 EAC 中，移至 [保護]\*\*\*\* \> [惡意程式碼篩選]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="0898a-183">In the EAC, go to **Protection** \> **Malware filter**.</span></span>

2. <span data-ttu-id="0898a-184">從清單中選取原則，然後設定下列其中一項設定：</span><span class="sxs-lookup"><span data-stu-id="0898a-184">Select the policy from the list, and then configure one of the following settings:</span></span>

   - <span data-ttu-id="0898a-185">**停用原則**：清除 [啟用]\*\*\*\* 資料行中的核取方塊。</span><span class="sxs-lookup"><span data-stu-id="0898a-185">**Disable the policy**: Clear the check box in the **Enabled** column.</span></span> <span data-ttu-id="0898a-186">根據預設，當您在 EAC 中建立反惡意程式碼原則時，會啟用這些原則。</span><span class="sxs-lookup"><span data-stu-id="0898a-186">By default, anti-malware policies are enabled when you create them in the EAC.</span></span>

   - <span data-ttu-id="0898a-187">**啟用原則**：選取 [啟用]\*\*\*\* 資料行中的核取方塊。</span><span class="sxs-lookup"><span data-stu-id="0898a-187">**Enable the policy**: Select the check box in the **Enabled** column.</span></span>

## <a name="use-the-eac-to-set-the-priority-of-custom-anti-malware-policies"></a><span data-ttu-id="0898a-188">使用 EAC 來設定自訂反惡意程式碼原則的優先順序</span><span class="sxs-lookup"><span data-stu-id="0898a-188">Use the EAC to set the priority of a rule</span></span>

<span data-ttu-id="0898a-189">根據預設，系統是根據反惡意程式碼原則的建立順序給予優先順序 (較新原則的優先順序比較舊原則的優先順序低)。</span><span class="sxs-lookup"><span data-stu-id="0898a-189">By default, Client Access Rules are given a priority that's based on the order they were created in (newer rules are lower priority than older rules).</span></span> <span data-ttu-id="0898a-190">較小的優先順序數字表示原則的優先順序較高，原則是依據優先順序進行處理 (較高優先順序的原則會在較低優先順序的原則前面進行處理)。</span><span class="sxs-lookup"><span data-stu-id="0898a-190">A lower priority number indicates a higher priority for the rule, and rules are processed in priority order (higher priority rules are processed before lower priority rules).</span></span> <span data-ttu-id="0898a-191">兩個原則不會有相同的優先順序。</span><span class="sxs-lookup"><span data-stu-id="0898a-191">No two rules can have the same priority.</span></span>

 <span data-ttu-id="0898a-192">**附註**：</span><span class="sxs-lookup"><span data-stu-id="0898a-192">**Notes**:</span></span>

- <span data-ttu-id="0898a-193">在 EAC 中，您只能在建立反惡意程式碼原則之後變更優先順序。</span><span class="sxs-lookup"><span data-stu-id="0898a-193">In the EAC, you can only change the priority of the anti-malware policy after you create it.</span></span> <span data-ttu-id="0898a-194">在 PowerShell 中，您可以在建立惡意程式碼篩選規則時覆寫預設優先順序 (會影響現有規則的優先順序)。</span><span class="sxs-lookup"><span data-stu-id="0898a-194">In PowerShell, you can override the default priority when you create the malware filter rule (which can affect the priority of existing rules).</span></span>

- <span data-ttu-id="0898a-195">在 EAC 中，系統會以反惡意程式碼原則的顯示順序來進行處理 (第一個原則的 [優先順序]\*\*\*\* 值為 0)。</span><span class="sxs-lookup"><span data-stu-id="0898a-195">In the EAC, anti-malware policies are processed in the order that they're displayed (the first policy has the **Priority** value 0).</span></span> <span data-ttu-id="0898a-196">名稱為 Default 的預設反惡意程式碼原則具有 [最低] 的優先順序值，且無法變更。</span><span class="sxs-lookup"><span data-stu-id="0898a-196">The default anti-malware policy named Default has the priority value Lowest, and you can't change it.</span></span>

<span data-ttu-id="0898a-197">若要變更原則的優先順序，請在清單中將原則上移或下移 (您無法在 EAC 中直接修改 [優先順序]\*\*\*\* 數字)。</span><span class="sxs-lookup"><span data-stu-id="0898a-197">To change the priority of a policy, move the policy up or down in the list (you can't directly modify the **Priority** number in the EAC).</span></span>

1. <span data-ttu-id="0898a-198">在 EAC 中，移至 [保護]\*\*\*\* \> [惡意程式碼篩選]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="0898a-198">In the EAC, go to **Protection** \> **Malware filter**.</span></span>

2. <span data-ttu-id="0898a-199">選取原則，然後按一下 [上移]\*\*\*\* (![向上箭頭圖示](../media/ITPro-EAC-UpArrowIcon.png)) 或 [下移]\*\*\*\* (![向下箭頭圖示](../media/ITPro-EAC-DownArrowIcon.png))，在清單中將規則上移或下移。</span><span class="sxs-lookup"><span data-stu-id="0898a-199">Select a policy, and then click **Move up** ![Up Arrow icon](../media/ITPro-EAC-UpArrowIcon.png) or **Move down** ![Down Arrow icon](../media/ITPro-EAC-DownArrowIcon.png) to move the rule up or down in the list.</span></span>

## <a name="use-the-eac-to-remove-anti-malware-policies"></a><span data-ttu-id="0898a-200">使用 EAC 來移除反惡意程式碼原則</span><span class="sxs-lookup"><span data-stu-id="0898a-200">Use the EAC to configure anti-malware policies</span></span>

<span data-ttu-id="0898a-201">當您使用 EAC 來移除反惡意程式碼原則時，系統會將惡意程式碼篩選規則和對應的惡意程式碼篩選原則移除。</span><span class="sxs-lookup"><span data-stu-id="0898a-201">When you use the EAC to remove an anti-malware policy, the malware filter rule and the corresponding malware filter policy are both removed.</span></span>

1. <span data-ttu-id="0898a-202">在 EAC 中，移至 [保護]\*\*\*\* \> [惡意程式碼篩選]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="0898a-202">From the EAC, go to **Protection** \> **Malware filter**.</span></span>

2. <span data-ttu-id="0898a-203">選取您想要從清單中移除的反惡意程式碼原則，然後按一下 [刪除]\*\*\*\* (![刪除圖示](../media/ITPro-EAC-DeleteIcon.png))。</span><span class="sxs-lookup"><span data-stu-id="0898a-203">Select the rule you want to remove and then click **Delete** ![Delete icon](../media/ITPro-EAC-DeleteIcon.png).</span></span>

## <a name="use-exchange-online-powershell-or-exchange-online-protection-powershell-to-configure-anti-malware-policies"></a><span data-ttu-id="0898a-204">使用 Exchange Online PowerShell 或 Exchange Online Protection PowerShell 來設定反惡意程式碼原則</span><span class="sxs-lookup"><span data-stu-id="0898a-204">Use Exchange Online PowerShell or Exchange Online Protection PowerShell to configure anti-malware policies</span></span>

### <a name="use-powershell-to-create-anti-malware-policies"></a><span data-ttu-id="0898a-205">使用 PowerShell 來建立反惡意程式碼原則</span><span class="sxs-lookup"><span data-stu-id="0898a-205">Use remote PowerShell to configure anti-malware policies</span></span>

<span data-ttu-id="0898a-206">若要在 PowerShell 中建立反惡意程式碼原則，需執行兩個步驟：</span><span class="sxs-lookup"><span data-stu-id="0898a-206">Creating an anti-malware policy in PowerShell is a two-step process:</span></span>

1. <span data-ttu-id="0898a-207">建立惡意程式碼篩選原則。</span><span class="sxs-lookup"><span data-stu-id="0898a-207">Describes the malware filter policy settings.</span></span>

2. <span data-ttu-id="0898a-208">建立惡意程式碼篩選規則，此規則會指定要套用規則的惡意程式碼篩選原則。</span><span class="sxs-lookup"><span data-stu-id="0898a-208">Create the malware filter rule that specifies the malware filter policy that the rule applies to.</span></span>

 <span data-ttu-id="0898a-209">**附註**：</span><span class="sxs-lookup"><span data-stu-id="0898a-209">**Notes**:</span></span>

- <span data-ttu-id="0898a-210">您可以建立新的惡意程式碼篩選規則，並對其指派未關聯的現有惡意程式碼篩選原則。</span><span class="sxs-lookup"><span data-stu-id="0898a-210">You can create a new malware filter rule and assign an existing, unassociated malware filter policy to it.</span></span> <span data-ttu-id="0898a-211">惡意程式碼篩選規則無法與多個惡意程式碼篩選原則相關聯。</span><span class="sxs-lookup"><span data-stu-id="0898a-211">A malware filter rule can't be associated with more than one malware filter policy.</span></span>

- <span data-ttu-id="0898a-212">您可以在 PowerShell 中，針對新的反惡意程式碼原則，設定 EAC 中無法使用的兩個設定 (在您建立原則之後)：</span><span class="sxs-lookup"><span data-stu-id="0898a-212">There are two settings that you can configure on new anti-malware policies in PowerShell that aren't available in the EAC until after you create the policy:</span></span>

  - <span data-ttu-id="0898a-213">將新原則建立為停用 (**New-MalwareFilterPolicy** Cmdlet上為 _Enabled_ `$false`)。</span><span class="sxs-lookup"><span data-stu-id="0898a-213">Create the new policy as disabled (_Enabled_ `$false` on the **New-MalwareFilterPolicy** cmdlet).</span></span>

  - <span data-ttu-id="0898a-214">在建立期間設定原則的優先順序 (**New-MalwareFilterRule** Cmdlet 上的 _Priority_ _\<Number\>_)。</span><span class="sxs-lookup"><span data-stu-id="0898a-214">Set the priority of the policy during creation (_Priority_ _\<Number\>_) on the **New-MalwareFilterRule** cmdlet).</span></span>

- <span data-ttu-id="0898a-215">您在 PowerShell 中建立的惡意程式碼篩選原則，在您將惡意程式碼篩選原則指派至惡意程式碼篩選規則之前，都不會顯示在 EAC 中。</span><span class="sxs-lookup"><span data-stu-id="0898a-215">Malware filter policies that you create in PowerShell don't appear in the EAC until you assign the malware filter policy to a malware filter rule.</span></span>

#### <a name="step-1-use-powershell-to-create-a-malware-filter-policy"></a><span data-ttu-id="0898a-216">步驟 1：使用 PowerShell 建立惡意程式碼篩選原則</span><span class="sxs-lookup"><span data-stu-id="0898a-216">Step 1: Use PowerShell to create a malware filter policy</span></span>

<span data-ttu-id="0898a-217">若要建立惡意程式碼篩選原則，請使用下列語法：</span><span class="sxs-lookup"><span data-stu-id="0898a-217">To create a malware filter policy, use this syntax:</span></span>

```PowerShell
New-MalwareFilterPolicy -Name "<PolicyName>" [-Action <DeleteMessage | DeleteAttachmentAndUseDefaultAlert | DeleteAttachmentAndUseCustomAlert>] [-AdminDisplayName "<OptionalComments>"] [-BypassInboundMessages <$true | $false>] [-BypassOutboundMessages <$true | $false>] [-CustomNotifications <$true | $false>] [<Inbound notification options>] [<Outbound notification options>]
```

<span data-ttu-id="0898a-218">本範例搭配下列設定建立命名為 Contoso Malware Filter Policy 的新惡意程式篩選原則：</span><span class="sxs-lookup"><span data-stu-id="0898a-218">This example creates a new malware filter policy named Contoso Malware Filter Policy with the following settings:</span></span>

- <span data-ttu-id="0898a-219">封鎖包含惡意程式碼的郵件 (我們不是使用 _Action_ 參數，預設值是 `DeleteMessage`)。</span><span class="sxs-lookup"><span data-stu-id="0898a-219">Block messages that contain malware (we aren't using the _Action_ parameter, and the default value is `DeleteMessage`).</span></span>

- <span data-ttu-id="0898a-220">在郵件中偵測到惡意程式碼時不通知郵件寄件者 (我們不是使用 _EnableExternalSenderNotifications_ 或 _EnableInternalSenderNotifications_ 參數，兩個參數的預設值都是 `$false`)。</span><span class="sxs-lookup"><span data-stu-id="0898a-220">Don't notify the message sender when malware is detected in the message (we aren't using the _EnableExternalSenderNotifications_ or _EnableInternalSenderNotifications_ parameters, and the default value for both is `$false`).</span></span>

- <span data-ttu-id="0898a-221">從內部寄件者的訊息中偵測到惡意程式時，通知管理員 admin@contoso.com。</span><span class="sxs-lookup"><span data-stu-id="0898a-221">Notify the administrator admin@contoso.com when malware is detected in a message from an internal sender.</span></span>

```PowerShell
New-MalwareFilterPolicy -Name "Contoso Malware Filter Policy" -EnableInternalSenderAdminNotifications $true -InternalSenderAdminAddress admin@contoso.com
```

<span data-ttu-id="0898a-222">如需詳細的語法及參數資訊，請參閱 [New-MalwareFilterPolicy](https://docs.microsoft.com/powershell/module/exchange/antispam-antimalware/new-malwarefilterpolicy)。</span><span class="sxs-lookup"><span data-stu-id="0898a-222">For detailed syntax and parameter information, see [New-RemoteDomain](https://docs.microsoft.com/powershell/module/exchange/antispam-antimalware/new-malwarefilterpolicy).</span></span>

#### <a name="step-2-use-powershell-to-create-a-malware-filter-rule"></a><span data-ttu-id="0898a-223">步驟 2：使用 PowerShell 建立惡意程式碼篩選規則</span><span class="sxs-lookup"><span data-stu-id="0898a-223">Step 2: Use PowerShell to create a malware filter rule</span></span>

<span data-ttu-id="0898a-224">若要建立惡意程式碼篩選規則，請使用下列語法：</span><span class="sxs-lookup"><span data-stu-id="0898a-224">To create a malware filter rule, use this syntax:</span></span>

```PowerShell
New-MalwareFilterRule -Name "<RuleName>" -MalwareFilterPolicy "<PolicyName>" <Recipient filters> [<Recipient filter exceptions>] [-Comments "<OptionalComments>"]
```

<span data-ttu-id="0898a-225">此範例使用下列設定來建立名稱為 Contoso Recipients 的新惡意軟體篩選規則：</span><span class="sxs-lookup"><span data-stu-id="0898a-225">This example creates a new malware filter policy named Contoso Malware Filter Policy with the following settings:</span></span>

- <span data-ttu-id="0898a-226">名為 Contoso Malware Filter Policy 的惡意程式碼篩選原則會與規則產生關聯。</span><span class="sxs-lookup"><span data-stu-id="0898a-226">The malware filter policy named Contoso Malware Filter Policy is associated with the rule.</span></span>

- <span data-ttu-id="0898a-227">規則會套用至 contoso.com 網域中的收件者。</span><span class="sxs-lookup"><span data-stu-id="0898a-227">The rule applies to recipients in the contoso.com domain.</span></span>

```PowerShell
New-MalwareFilterRule -Name "Contoso Recipients" -MalwareFilterPolicy "Contoso Malware Filter Policy" -RecipientDomainIs contoso.com
```

<span data-ttu-id="0898a-228">如需詳細的語法及參數資訊，請參閱 [New-MalwareFilterRule](https://docs.microsoft.com/powershell/module/exchange/antispam-antimalware/new-malwarefilterrule)。</span><span class="sxs-lookup"><span data-stu-id="0898a-228">For detailed syntax and parameter information, see [New-RemoteDomain](https://docs.microsoft.com/powershell/module/exchange/antispam-antimalware/new-malwarefilterrule).</span></span>

### <a name="use-powershell-to-view-malware-filter-policies"></a><span data-ttu-id="0898a-229">使用 PowerShell 檢視惡意程式碼篩選原則</span><span class="sxs-lookup"><span data-stu-id="0898a-229">Use PowerShell to view malware filter policies</span></span>

<span data-ttu-id="0898a-230">若要傳回所有惡意程式碼篩選原則的摘要清單，請執行下列命令：</span><span class="sxs-lookup"><span data-stu-id="0898a-230">To return a summary list of all Client Access Rules, run this command:</span></span>

```PowerShell
Get-MalwareFilterPolicy
```

<span data-ttu-id="0898a-231">若要傳回特定惡意程式碼篩選原則的詳細資訊，請使用下列語法：</span><span class="sxs-lookup"><span data-stu-id="0898a-231">To return detailed information about a specific rule, use this syntax:</span></span>

```PowerShell
Get-MalwareFilterPolicy -Identity "<PolicyName>" | Format-List [<Specific properties to view>]
```

<span data-ttu-id="0898a-232">此範例會傳回惡意程式碼篩選原則 (名稱為 Executives) 的所有屬性值。</span><span class="sxs-lookup"><span data-stu-id="0898a-232">This example returns all the property values for the malware filter policy named Executives.</span></span>

```PowerShell
Get-MalwareFilterPolicy -Identity "Executives" | Format-List
```

<span data-ttu-id="0898a-233">此範例只會傳回相同原則的指定屬性。</span><span class="sxs-lookup"><span data-stu-id="0898a-233">This example returns only the specified properties for the same rule.</span></span>

```PowerShell
Get-MalwareFilterPolicy -Identity "Executives" | Format-List Action,AdminDisplayName,CustomNotifications,Enable*Notifications
```

<span data-ttu-id="0898a-234">如需詳細的語法及參數資訊，請參閱 [Get-MalwareFilterPolicy](https://docs.microsoft.com/powershell/module/exchange/antispam-antimalware/get-malwarefilterpolicy)。</span><span class="sxs-lookup"><span data-stu-id="0898a-234">For detailed syntax and parameter information, see [Get-ManagementRoleAssignment](https://docs.microsoft.com/powershell/module/exchange/antispam-antimalware/get-malwarefilterpolicy).</span></span>

### <a name="use-powershell-to-view-malware-filter-rules"></a><span data-ttu-id="0898a-235">使用 PowerShell 檢視惡意程式碼篩選規則</span><span class="sxs-lookup"><span data-stu-id="0898a-235">Use PowerShell to view malware filter rules</span></span>

<span data-ttu-id="0898a-236">若要傳回所有惡意程式碼篩選規則的摘要清單，請執行下列命令：</span><span class="sxs-lookup"><span data-stu-id="0898a-236">To return a summary list of all Client Access Rules, run this command:</span></span>

```PowerShell
Get-MalwareFilterRule
```

<span data-ttu-id="0898a-237">若要傳回特定惡意程式碼篩選規則的詳細資訊，請使用下列語法：</span><span class="sxs-lookup"><span data-stu-id="0898a-237">To return detailed information about a specific rule, use this syntax:</span></span>

```PowerShell
Get-MalwareFilterRule -Identity "<RuleName>" | Format-List [<Specific properties to view>]
```

<span data-ttu-id="0898a-238">此範例會傳回惡意程式碼篩選規則 (名稱為 Executives) 的所有屬性值。</span><span class="sxs-lookup"><span data-stu-id="0898a-238">This example returns all the property values for the malware filter rule named Executives.</span></span>

```PowerShell
Get-MalwareFilterRule -Identity "Executives" | Format-List
```

<span data-ttu-id="0898a-239">此範例只會傳回相同規則的指定屬性。</span><span class="sxs-lookup"><span data-stu-id="0898a-239">This example returns only the specified properties for the same rule.</span></span>

```PowerShell
Get-MalwareFilterRule -Identity "Executives" | Format-List Name,Priority,State,MalwareFilterPolicy,*Is,*SentTo,*MemberOf
```

<span data-ttu-id="0898a-240">如需詳細的語法及參數資訊，請參閱 [Get-MalwareFilterRule](https://docs.microsoft.com/powershell/module/exchange/antispam-antimalware/get-malwarefilterrule)。</span><span class="sxs-lookup"><span data-stu-id="0898a-240">For detailed syntax and parameter information, see [Get-ManagementRoleAssignment](https://docs.microsoft.com/powershell/module/exchange/antispam-antimalware/get-malwarefilterrule).</span></span>

### <a name="use-powershell-to-modify-a-malware-filter-policy"></a><span data-ttu-id="0898a-241">使用 PowerShell 修改惡意程式碼篩選原則</span><span class="sxs-lookup"><span data-stu-id="0898a-241">Use PowerShell to modify a malware filter policy</span></span>

<span data-ttu-id="0898a-242">當您在 PowerShell 中修改反惡意程式碼原則時，無法使用任何其他設定。</span><span class="sxs-lookup"><span data-stu-id="0898a-242">No additional settings are available when you modify a malware policy in PowerShell.</span></span> <span data-ttu-id="0898a-243">這些設定與您在建立原則時可用的設定相同。</span><span class="sxs-lookup"><span data-stu-id="0898a-243">They're the same settings that were available when you created the rule.</span></span> <span data-ttu-id="0898a-244">請注意，您無法重新命名預設原則。</span><span class="sxs-lookup"><span data-stu-id="0898a-244">Note that you can't rename the default policy.</span></span>

<span data-ttu-id="0898a-245">若要修改惡意程式碼篩選原則，請使用下列語法：</span><span class="sxs-lookup"><span data-stu-id="0898a-245">To modify a malware filter policy, use this syntax:</span></span>

```PowerShell
Set-MalwareFilterPolicy -Identity "<PolicyName>" <Settings>
```

<span data-ttu-id="0898a-246">如需詳細的語法及參數資訊，請參閱 [Set-MalwareFilterPolicy](https://docs.microsoft.com/powershell/module/exchange/antispam-antimalware/set-malwarefilterpolicy)。</span><span class="sxs-lookup"><span data-stu-id="0898a-246">For detailed syntax and parameter information, see [Set-ClientAccessRule](https://docs.microsoft.com/powershell/module/exchange/antispam-antimalware/set-malwarefilterpolicy).</span></span>

### <a name="use-powershell-to-modify-a-malware-filter-rule"></a><span data-ttu-id="0898a-247">使用 PowerShell 修改惡意程式碼篩選規則</span><span class="sxs-lookup"><span data-stu-id="0898a-247">Use PowerShell to modify a malware filter rule</span></span>

<span data-ttu-id="0898a-248">當您在 PowerShell 中修改惡意程式碼篩選規則時，無法停用或啟用規則 (**Set-MalwareFilterRule** Cmdlet 上沒有_Enabled_ 參數)。</span><span class="sxs-lookup"><span data-stu-id="0898a-248">When you modify a malware filter rule in PowerShell, you can't disable or enable the rule (there's no _Enabled_ parameter on the **Set-MalwareFilterRule** cmdlet).</span></span> <span data-ttu-id="0898a-249">請改為使用下一節中的 **Disable-MalwareFilterRule** 和 **Enable-MalwareFilterRule** Cmdlet。</span><span class="sxs-lookup"><span data-stu-id="0898a-249">Instead, you use the **Disable-MalwareFilterRule** and **Enable-MalwareFilterRule** cmdlets as described in the next section.</span></span>

<span data-ttu-id="0898a-250">若要修改惡意程式碼篩選規則，請使用下列語法：</span><span class="sxs-lookup"><span data-stu-id="0898a-250">To modify a malware filter rule, use this syntax:</span></span>

```PowerShell
Set-MalwareFilterRule -Identity "<RuleName>" <Settings>
```

<span data-ttu-id="0898a-251">如需詳細的語法及參數資訊，請參閱 [Set-MalwareFilterRule](https://docs.microsoft.com/powershell/module/exchange/antispam-antimalware/set-malwarefilterrule)。</span><span class="sxs-lookup"><span data-stu-id="0898a-251">For detailed syntax and parameter information, see [Set-ClientAccessRule](https://docs.microsoft.com/powershell/module/exchange/antispam-antimalware/set-malwarefilterrule).</span></span>

### <a name="use-powershell-to-enable-or-disable-malware-filter-rules"></a><span data-ttu-id="0898a-252">使用 PowerShell 來啟用或停用惡意程式碼篩選規則</span><span class="sxs-lookup"><span data-stu-id="0898a-252">Use PowerShell to enable or disable malware filter rules</span></span>

<span data-ttu-id="0898a-253">根據預設，當您在 PowerShell 中建立反惡意程式碼原則時，這些原則是處於啟用狀態，但是您可以使用 PowerShell 來建立停用的惡意程式碼篩選規則 (使用 **New-MalwareFilterRule** Cmdlet 和具有 `$false` 值的 _Enabled_ 參數)。</span><span class="sxs-lookup"><span data-stu-id="0898a-253">By default, anti-malware policies are enabled when you create them in PowerShell, but you can use PowerShell to create a disabled malware filter rule (use the **New-MalwareFilterRule** cmdlet and the _Enabled_ parameter with the value `$false`).</span></span>

<span data-ttu-id="0898a-254">若要在 PowerShell 中啟用或停用惡意程式碼篩選規則，請使用下列語法：</span><span class="sxs-lookup"><span data-stu-id="0898a-254">To enable or disable a malware filter rule in PowerShell, use this syntax:</span></span>

```PowerShell
<Enable-MalwareFilterRule | Disable-MalwareFilterRule> -Identity "<RuleName>"
```

<span data-ttu-id="0898a-255">此範例會停用名稱為 Marketing Department 的惡意程式碼篩選規則。</span><span class="sxs-lookup"><span data-stu-id="0898a-255">This example disables the enabled malware filter rule named Contoso Recipients.</span></span>

```PowerShell
Disable-MalwareFilterRule -Identity "Marketing Department"
```

<span data-ttu-id="0898a-256">此範例會啟用相同規則。</span><span class="sxs-lookup"><span data-stu-id="0898a-256">This example enables the rule Contoso.</span></span>

```PowerShell
Enable-MalwareFilterRule -Identity "Marketing"
```

<span data-ttu-id="0898a-257">如需詳細的語法及參數資訊，請參閱 [Enable-MalwareFilterRule](https://docs.microsoft.com/powershell/module/exchange/antispam-antimalware/enable-malwarefilterrule) 和 [Disable-MalwareFilterRule](https://docs.microsoft.com/powershell/module/exchange/antispam-antimalware/disable-malwarefilterrule)。</span><span class="sxs-lookup"><span data-stu-id="0898a-257">For detailed syntax and parameter information, see [Get-Mailbox](https://docs.microsoft.com/powershell/module/exchange/antispam-antimalware/enable-malwarefilterrule) and [Get-MailboxFolderStatistics](https://docs.microsoft.com/powershell/module/exchange/antispam-antimalware/disable-malwarefilterrule).</span></span>


### <a name="use-powershell-to-set-the-priority-of-custom-malware-filter-rules"></a><span data-ttu-id="0898a-258">使用 PowerShell 設定自訂惡意程式碼篩選規則的優先順序</span><span class="sxs-lookup"><span data-stu-id="0898a-258">Use PowerShell to set the priority of custom malware filter rules</span></span>

<span data-ttu-id="0898a-259">您可以對規則設定的最高優先順序值為 0。</span><span class="sxs-lookup"><span data-stu-id="0898a-259">The highest priority you can set on a rule is 1.</span></span> <span data-ttu-id="0898a-260">您可以設定的最低值則取決於規則的數目。</span><span class="sxs-lookup"><span data-stu-id="0898a-260">The lowest value you can set depends on the number of rules.</span></span> <span data-ttu-id="0898a-261">例如，如果您有五個規則，則您可以使用 0 到 4 的優先順序值。</span><span class="sxs-lookup"><span data-stu-id="0898a-261">For example, if you have five rules, you can use the priority values 1 through 5.</span></span> <span data-ttu-id="0898a-262">變更現有規則的優先順序會對其他規則造成階層式影響。</span><span class="sxs-lookup"><span data-stu-id="0898a-262">Changing the priority of an existing rule can have a cascading effect on other rules.</span></span> <span data-ttu-id="0898a-263">例如，如果您有五個規則 (優先順序 0 到 4)，而您將規則的優先順序變更為 2，則優先順序為 2 的現有規則會變更為優先順序 3，優先順序 3 的規則會變更為優先順序 4。</span><span class="sxs-lookup"><span data-stu-id="0898a-263">For example, if you have five rules (priorities 1 through 5), and you change the priority of a rule from 5 to 2, the existing rule with priority 2 is changed to priority 3, the rule with priority 3 is changed to priority 4, and the rule with priority 4 is changed to priority 5.</span></span>

<span data-ttu-id="0898a-264">若要在 PowerShell 中設定自訂惡意程式碼篩選規則的優先順序，請使用下列語法：</span><span class="sxs-lookup"><span data-stu-id="0898a-264">To set the priority of a custom malware filter rule in PowerShell, use the following syntax:</span></span>

```PowerShell
Set-MalwareFilterRule -Identity "<RuleName>" -Priority <Number>
```

<span data-ttu-id="0898a-265">此範例會將規則 (名稱為 Marketing Department) 的優先順序設定為 2。</span><span class="sxs-lookup"><span data-stu-id="0898a-265">This example sets the priority of the rule named Disable IMAP4 to 2.</span></span> <span data-ttu-id="0898a-266">優先順序小於或等於 2 的所有現有規則會減 1 (它們的優先順序數字會加 1)。</span><span class="sxs-lookup"><span data-stu-id="0898a-266">All existing rules that have a priority less than or equal to 2 are decreased by 1 (their priority numbers are increased by 1).</span></span>

```PowerShell
Set-MalwareFilterRule -Identity "Marketing Department" -Priority 2
```

 <span data-ttu-id="0898a-267">**附註**：若要在建立新規則時設定其優先順序，請使用 **New-MalwareFilterRule** Cmdlet 上的 _Priority_ 參數。</span><span class="sxs-lookup"><span data-stu-id="0898a-267">**Note**: To set the priority of a new rule when you create it, use the _Priority_ parameter on the **New-ClientAccessRule** cmdlet.</span></span>

### <a name="use-powershell-to-remove-malware-filter-policies"></a><span data-ttu-id="0898a-268">使用 PowerShell 移除惡意程式碼篩選原則</span><span class="sxs-lookup"><span data-stu-id="0898a-268">Use PowerShell to remove malware filter policies</span></span>

<span data-ttu-id="0898a-269">當您使用 PowerShell 來移除惡意程式碼篩選原則時，對應的惡意程式碼篩選規則不會遭到移除。</span><span class="sxs-lookup"><span data-stu-id="0898a-269">When you use PowerShell to remove a malware filter policy, the corresponding malware filter rule isn't removed.</span></span>

<span data-ttu-id="0898a-270">若要在 PowerShell 中移除惡意程式碼篩選原則，請使用下列語法：</span><span class="sxs-lookup"><span data-stu-id="0898a-270">To remove a malware filter policy in PowerShell, use this syntax:</span></span>

```PowerShell
Remove-MalwareFilterPolicy -Identity "<PolicyName>"
```

<span data-ttu-id="0898a-271">此範例會移除名稱為 Marketing Department 的惡意程式碼篩選原則。</span><span class="sxs-lookup"><span data-stu-id="0898a-271">This example removes the malware filter policy named Marketing Department.</span></span>

```PowerShell
Remove-MalwareFilterPolicy -Identity "Marketing Department"
```

<span data-ttu-id="0898a-272">如需詳細的語法及參數資訊，請參閱 [Remove-MalwareFilterPolicy](https://docs.microsoft.com/powershell/module/exchange/antispam-antimalware/remove-malwarefilterpolicy)。</span><span class="sxs-lookup"><span data-stu-id="0898a-272">For detailed syntax and parameter information, see [Remove-ClientAccessRule](https://docs.microsoft.com/powershell/module/exchange/antispam-antimalware/remove-malwarefilterpolicy).</span></span>

## <a name="how-do-you-know-these-procedures-worked"></a><span data-ttu-id="0898a-273">如何才能了解這些程序是否正常運作？</span><span class="sxs-lookup"><span data-stu-id="0898a-273">How do you know these steps worked?</span></span>

<span data-ttu-id="0898a-p126">下列程式指示如何使用 EICAR.TXT 防毒測試檔案確認惡意程式碼篩選正常運作。使用不會封鎖檔案的電子郵件用戶端。</span><span class="sxs-lookup"><span data-stu-id="0898a-p126">The following procedure provides instructions for using the EICAR.TXT antivirus test file to verify that malware filtering is working correctly. Use an email client that does not block the file.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="0898a-p127">EICAR.TXT 檔案不是病毒。不過，由於使用者經常需要測試安裝是否正常運作，因此防毒業界透過歐洲電腦防毒研究協會採用 EICAR 標準，以滿足如此的需求。</span><span class="sxs-lookup"><span data-stu-id="0898a-p127">The EICAR.TXT file is not a virus. However, because users often have the need to test that installations function correctly, the antivirus industry, through the European Institute for Computer Antivirus Research, has adopted the EICAR standard in order to meet this need.</span></span>

### <a name="use-the-eicartxt-file-to-verify-malware-filtering-functionality"></a><span data-ttu-id="0898a-278">使用 EICAR.TXT 檔案來確認惡意程式碼篩選功能</span><span class="sxs-lookup"><span data-stu-id="0898a-278">Use the EICAR.TXT file to verify malware filtering functionality</span></span>

1. <span data-ttu-id="0898a-279">建立新的文字檔，然後命名為 EICAR.TXT。</span><span class="sxs-lookup"><span data-stu-id="0898a-279">Create a new text file, and then name the file EICAR.TXT.</span></span>

2. <span data-ttu-id="0898a-280">將下一行複製到文字檔：</span><span class="sxs-lookup"><span data-stu-id="0898a-280">Copy the following line into the text file:</span></span>

   ```PowerShell
   X5O!P%@AP[4\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*
   ```

   <span data-ttu-id="0898a-p128">確定這是檔案中唯一的字串。完成後，您將有 68 個位元組的檔案。</span><span class="sxs-lookup"><span data-stu-id="0898a-p128">Make sure that this is the only string in the file. When done, you will have a 68-byte file.</span></span>

   <span data-ttu-id="0898a-283">如果您使用桌上型電腦的防毒程式，務必確定您儲存檔案的資料夾排除在掃描之外。</span><span class="sxs-lookup"><span data-stu-id="0898a-283">If you are using a desktop antivirus program, make sure that the folder you are saving the file to is excluded from scanning.</span></span>

3. <span data-ttu-id="0898a-284">將這個檔案附加到將由服務過濾的電子郵件。</span><span class="sxs-lookup"><span data-stu-id="0898a-284">Attach this file to an email message that will be filtered by the service.</span></span>

   <span data-ttu-id="0898a-p129">檢查測試郵件的收件者信箱。端視您設定的惡意程式碼偵測回應而定，將刪除整封郵件，或者將刪除附件並以警示文字檔取代。此外，也將發佈任何設定的通知。</span><span class="sxs-lookup"><span data-stu-id="0898a-p129">Check the recipient mailbox of the test message. Depending on the malware detection response you have configured, the entire message will be deleted, or the attachment will be deleted and replaced with the alert text file. Any configured notifications will also be distributed.</span></span>

   <span data-ttu-id="0898a-288">收件者可能會收到類似下列的通知郵件 (若已設定的話)：「此郵件是由郵件傳遞軟體自動建立。</span><span class="sxs-lookup"><span data-stu-id="0898a-288">The recipient may receive a notification message (if configured) that appears similar to the following: "This message was created automatically by mail delivery software.</span></span> <span data-ttu-id="0898a-289">不會將您的電子郵件訊息傳遞給預定的收件者，因為偵測到惡意程式碼」。</span><span class="sxs-lookup"><span data-stu-id="0898a-289">Your email message was not delivered to the intended recipients because malware was detected."</span></span> <span data-ttu-id="0898a-290">其中也會包含下列額外資訊：郵件主旨、郵件寄件者、服務收到郵件的時間、郵件識別碼 (郵件標頭中的網際網路郵件識別碼 (也稱為「用戶端識別碼」)，具有 "Message-ID: Token")，以及發現的偵測 (將是 eicar.txt)。</span><span class="sxs-lookup"><span data-stu-id="0898a-290">The following additional information will also be included: the subject of the message, the sender of the message, the time the message was received by the service, the Message ID (the Internet message ID (also known as the Client ID) found in the header of the message with the "Message-ID:" token), and the detection found (which will be eicar.txt).</span></span>

4. <span data-ttu-id="0898a-291">測試完成後刪除 EICAR.TXT 檔案，以免其他使用者收到不必要的警告。</span><span class="sxs-lookup"><span data-stu-id="0898a-291">Delete the EICAR.TXT file after testing is completed so that other users are not unnecessarily alarmed.</span></span>

## <a name="for-more-information"></a><span data-ttu-id="0898a-292">如需詳細資訊</span><span class="sxs-lookup"><span data-stu-id="0898a-292">For more information</span></span>

[<span data-ttu-id="0898a-293">Anti-malware protection</span><span class="sxs-lookup"><span data-stu-id="0898a-293">Anti-malware protection</span></span>](anti-malware-protection.md)

[<span data-ttu-id="0898a-294">反惡意程式碼保護常見問題集</span><span class="sxs-lookup"><span data-stu-id="0898a-294">Anti-malware protection FAQ</span></span>](anti-malware-protection-faq-eop.md)
