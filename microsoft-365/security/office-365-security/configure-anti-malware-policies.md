---
title: 設定反惡意程式碼原則
f1.keywords:
- NOCSH
ms.author: chrisda
author: chrisda
manager: dansimp
ms.date: ''
audience: ITPro
ms.topic: how-to
ms.service: O365-seccomp
localization_priority: Normal
search.appverid:
- MET150
ms.assetid: b0cfc21f-e3c6-41b6-8670-feb2b2e252e5
ms.collection:
- M365-security-compliance
- m365initiative-defender-office365
description: 系統管理員可以瞭解如何在 Exchange Online Protection (EOP) 中查看、建立、修改和移除反惡意程式碼原則。
ms.custom: seo-marvel-apr2020
ms.openlocfilehash: 1b96b2832af894ee943028fd7460c5eb17e8cc43
ms.sourcegitcommit: d81c7cea85af6ad5fef81d3c930514a51464368c
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 12/04/2020
ms.locfileid: "49572546"
---
# <a name="configure-anti-malware-policies-in-eop"></a>在 EOP 中設定反惡意程式碼原則

[!INCLUDE [Microsoft 365 Defender rebranding](../includes/microsoft-defender-for-office.md)]


在有信箱在 Exchange Online 或獨立 Exchange Online Protection 中的 Microsoft 365 組織中 (EOP) 不含 Exchange Online 信箱的組織，電子郵件會自動受到 EOP 的惡意程式碼保護。 EOP 會使用反惡意程式碼原則進行惡意程式碼保護設定。 如需詳細資訊，請參閱 [反惡意程式碼保護](anti-malware-protection.md)。

系統管理員可以查看、編輯和設定 (，但不會刪除預設反惡意程式碼原則) ，以符合組織的需求。 為了獲得更多細微性，您也可以建立適用于組織中特定使用者、群組或網域的自訂反惡意程式碼原則。 自訂原則一律優先於預設原則，但您可以變更自訂原則的優先順序 (執行順序)。

您可以使用 Exchange Online 中的信箱，在安全性 & 合規性中心或 PowerShell (Exchange Online PowerShell 中設定 Microsoft 365 組織的反惡意程式碼原則;沒有 Exchange Online 信箱) 之組織的獨立 EOP PowerShell。

## <a name="what-do-you-need-to-know-before-you-begin"></a>開始之前有哪些須知？

- 您要在 <https://protection.office.com/> 開啟安全性與合規性中心。 若要直接移至 **反惡意** 字碼頁面，請使用 <https://protection.office.com/antimalware> 。

- 若要連線至 Exchange Online PowerShell，請參閱[連線至 Exchange Online PowerShell](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-powershell)。 若要連接至獨立版 EOP PowerShell，請參閱[連線到 Exchange Online Protection PowerShell](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-protection-powershell)。

- 您必須在安全性 & 合規性中心指派許可權，才能執行本文中的程式：
  - 若要新增、修改和刪除反惡意程式碼原則，您必須是「 **組織管理** 」或「 **安全性管理員** 」角色群組的成員。
  - 若要唯讀的反惡意程式碼原則的存取權，您必須是 **全域讀取器** 或 **安全性讀取器** 角色群組的成員。

  如需詳細資訊，請參閱[安全性與合規性中心中的權限](permissions-in-the-security-and-compliance-center.md)。

  **附註**：

  - 將使用者新增至 Microsoft 365 系統管理中心的對應 Azure Active Directory 角色，可讓使用者具備安全性 & 合規性中心的必要許可權 _，以及_ Microsoft 365 中其他功能的許可權。 如需詳細資訊，請參閱[關於系統管理員角色](https://docs.microsoft.com/microsoft-365/admin/add-users/about-admin-roles)。
  - [Exchange Online](https://docs.microsoft.com/Exchange/permissions-exo/permissions-exo#role-groups)中的「 **View-Only 組織管理**」角色群組也會提供該功能的唯讀存取權。

- 如需有關反惡意程式碼原則的建議設定，請參閱 [EOP 防盜-惡意程式碼原則設定](recommended-settings-for-eop-and-office365-atp.md#eop-anti-malware-policy-settings)。

## <a name="use-the-security--compliance-center-to-create-anti-malware-policies"></a>使用安全性 & 規範中心建立反惡意程式碼原則

在安全性 & 合規性中心建立自訂的反惡意程式碼原則，會同時使用相同的名稱建立惡意軟體篩選規則和相關聯的惡意程式碼篩選原則。

1. 在 [安全性 & 規範中心] 中，移至 [ **威脅管理** \> **原則**] \> **Anti-Malware**，然後按一下 [新增] [ **新增**] ![ 圖示 ](../../media/ITPro-EAC-AddIcon.png) 。

2. 在開啟的 [新增反惡意程式碼原則] 頁面中，進行以下設定：

   - **名稱**：輸入原則的唯一描述性名稱。

   - **說明**：輸入原則的選擇性說明。

   - **惡意程式碼偵測回應**：針對 [您是否要在收件者的郵件遭到隔離時通知收件者？] 設定，選取下列其中一個值：

     - **No**：會隔離郵件，但不會通知預定的收件者。 這是預設值。

     - **是，並使用預設通知文字**：會隔離郵件。 郵件的複本會傳送給收件者，但是 *所有* 附件 (都不只是偵測到的檔案) 會以包含預設文字的單一文字檔（名為 **惡意程式碼警示 Text.txt** ）取代。 針對預設文字，請參閱 [反惡意程式碼原則](anti-malware-protection.md#anti-malware-policies)。

     - **是和使用自訂通知文字**：會隔離郵件。 郵件的複本會傳送給收件者，但 *所有* 附件 (都不只是偵測到的檔案) 會取代為單一文字檔（名為 **惡意程式碼警示** ），Text.txt包含您在 **自訂警示文字方塊** 中指定的自訂文字。

   - **常見附件類型篩選**：請選取下列其中一個值，以 **封鎖可能會損害您電腦的附件類型。**：

     - **關閉**

     - **開啟**：具有指定附件的郵件會被視為惡意程式碼偵測，而且會自動隔離。 您可以修改清單備份按一下 [ **新增**  ] 和 [ **移除** ] 按鈕。

   - **惡意程式碼零小時自動清除**：惡意程式碼 ZAP 會隔離已傳遞的郵件。 如需詳細資訊，請參閱 [0 小時自動清除 (ZAP) 在 Exchange Online 中](zero-hour-auto-purge.md)。 選取下列其中一個值：

     - **關閉**

     - **開啟 (建議使用)**

   - **通知**：此區段中的設定會在郵件中偵測到惡意軟體時，控制寄件者和系統管理員通知。

     - **寄件者通知**：選取下列其中一個選項或兩者皆選取：

       - **通知內部寄件者**：內部寄件者是在組織內。

       - **通知外部寄件者**：外部寄件者是在組織外。

     - **系統管理員通知**：選取下列其中一個選項或兩者皆選取：

       - **通知系統管理員來自內部寄件者的未傳遞郵件**：如果您選取此選項，請在 [ **系統管理員電子郵件地址** ] 方塊中輸入通知電子郵件地址。

       - **通知系統管理員來自外部寄件者的未傳遞郵件**：如果您選取此選項，請在 [ **系統管理員電子郵件地址** ] 方塊中輸入通知電子郵件地址。

     - **自訂通知**：這些設定會取代用於寄件者或系統管理員的預設通知文字。 如需預設值的詳細資訊，請參閱[反惡意程式碼原則](anti-malware-protection.md#anti-malware-policies)。

       - **使用自訂的通知文字**：如果您選取此選項，則必須使用 [寄件者 **名稱** ] 和 [寄件者 **位址** ] 方塊來指定自訂通知訊息中所使用的寄件者名稱和電子郵件地址。

       - **來自內部寄件者的郵件**：如果選擇通知寄件者或系統管理員無法從內部寄件者傳遞郵件，您必須使用主旨及 **消息** 框來指定自訂通知訊息的 **主旨和郵件** 內文。

       - **來自外部寄件者的郵件**：如果選擇通知寄件者或系統管理員無法傳遞來自外部寄件者的郵件，您必須使用主旨及 **消息** 框來指定自訂通知訊息的 **主旨和郵件** 內文。

   - **套用至**：此區段中的設定會識別原則套用目標的內部收件者。

     - **If**：按一下 [ **選取一個** 下拉式清單]，然後選取規則的條件：

       - **收件者是**：指定您組織中的一或多個信箱、郵件使用者或郵件連絡人。 在顯示的 [選取成員] 對話方塊中，從清單選取一或多個收件者，然後按一下 [新增 -\>]。 在 [ **檢查名稱** ] 方塊中，您可以將萬用字元用於多個電子郵件地址 (例如： \* @fabrikam .com) 。 完成後，按一下 [確定]。

       - **收件者網域為**：指定您的組織中一或多個已設定公認的網域中的收件者。 在顯示的對話方塊中，選取一或多個網域，然後按一下 [新增 -\>]。 完成後，按一下 [確定]。

       - **收件者以成員的身分存在於**：指定您組織中的一或多個群組。 在顯示的 [選取成員] 對話方塊中，從清單選取一或多個群組，然後按一下 [新增 -\>]。 完成後，按一下 [確定]。

     您只能使用一次條件，但是您可以指定條件的多個值。 相同條件使用或邏輯 (的多個值，例如 _\<recipient1\>_ 或 _\<recipient2\>_) 。 使用不同的條件和邏輯 (例如， _\<recipient1\>_ 及 _\<member of group 1\>_) 。 若要新增其他條件，請按一下 [新增條件]，然後從剩餘選項中進行選取。

     - **除非**：若要新增規則的例外狀況，請按一下 [ **新增例外** 狀況]，然後按一下 [ **選取一個** 下拉式清單]，然後設定例外狀況。 設定和行為就像是條件。

3. 完成後，按一下 [儲存]。

## <a name="use-the-security--compliance-center-to-view-anti-malware-policies"></a>使用安全性 & 規範中心來查看反惡意程式碼原則

1. 在 [安全性 & 規範中心] 中，移至 [ **威脅管理** \> **原則**] \> **Anti-Malware**。

2. 當您選取原則時，原則的相關資訊會顯示在詳細資料窗格中。 若要查看原則的詳細資訊，請按一下 [編輯] ![編輯圖示](../../media/ITPro-EAC-EditIcon.png)。

   - **Enabled** 屬性值、**Priority** 屬性值及 [套用至] 索引標籤上的設定，是在惡意程式碼篩選規則中。

   - [一般] 和 [設定] 索引標籤是在惡意程式碼篩選原則中。

## <a name="use-the-security--compliance-center-to-modify-anti-malware-policies"></a>使用安全性 & 規範中心來修改反惡意程式碼原則

1. 在 [安全性 & 規範中心] 中，移至 [ **威脅管理** \> **原則**] \> **Anti-Malware**。

2. 選取原則，然後按一下 [編輯] ![編輯圖示](../../media/ITPro-EAC-EditIcon.png)。 如需這些設定的相關資訊，請參閱本主題中的 [使用 Security & 合規性中心建立反惡意程式碼原則](#use-the-security--compliance-center-to-create-anti-malware-policies) 一節。

   **附註**：

   - 並非所有項目都在單一頁面上，設定分佈在 [一般]、[設定] 及 [套用至] 索引標籤中。 [套用 **至** ] 索引標籤無法在預設原則中使用，此預設 (原則會自動套用至) 的所有人。

   - 您無法重新命名預設原則。

## <a name="use-the-security--compliance-center-to-enable-or-disable-anti-malware-policies"></a>使用安全性 & 規範中心來啟用或停用反惡意程式碼原則

1. 在 [安全性 & 規範中心] 中，移至 [ **威脅管理** \> **原則**] \> **Anti-Malware**。

2. 從清單中選取原則，然後設定下列其中一項設定：

   - **停用原則**：清除 [啟用] 資料行中的核取方塊。 根據預設，當您在安全性 & 合規性中心建立反惡意程式碼原則時會啟用這些原則。

   - **啟用原則**：選取 [啟用] 資料行中的核取方塊。

## <a name="use-the-security--compliance-center-to-set-the-priority-of-custom-anti-malware-policies"></a>使用安全性 & 規範中心設定自訂反惡意程式碼原則的優先順序

根據預設，系統是根據反惡意程式碼原則的建立順序給予優先順序 (較新原則的優先順序比較舊原則的優先順序低)。 較小的優先順序數字表示原則的優先順序較高，原則是依據優先順序進行處理 (較高優先順序的原則會在較低優先順序的原則前面進行處理)。 不論有幾個原則，都不會具有相同的優先順序，且在套用第一個原則之後，原則處理就會停止。

 **附註**：

- 在安全性 & 規範中心，您只能在建立反惡意程式碼原則之後變更其優先順序。 在 PowerShell 中，您可以在建立惡意程式碼篩選規則時覆寫預設優先順序 (會影響現有規則的優先順序)。

- 在 [安全性 & 規範中心] 中，反惡意程式碼原則的處理順序是 (第一個原則的 **優先順序** 值為 0) 。 預設的反惡意程式碼原則的優先順序值為 **最低**，您無法變更。

若要變更原則的優先順序，請在清單中將原則上移或下移 (您無法在安全性與合規性中心直接修改 [優先順序] 數字)。

1. 在 [安全性 & 規範中心] 中，移至 [ **威脅管理** \> **原則**] \> **Anti-Malware**。

2. 選取原則，然後按一下 [上移] (![向上箭頭圖示](../../media/ITPro-EAC-UpArrowIcon.png)) 或 [下移] (![向下箭頭圖示](../../media/ITPro-EAC-DownArrowIcon.png))，在清單中將規則上移或下移。

## <a name="use-the-security--compliance-center-to-remove-anti-malware-policies"></a>使用安全性 & 規範中心移除反惡意程式碼原則

當您使用安全性 & 規範中心移除反惡意程式碼原則時，惡意軟體篩選規則和對應的惡意程式碼篩選原則都會同時刪除。

1. 在 [安全性 & 規範中心] 中，移至 [ **威脅管理** \> **原則**] \> **Anti-Malware**。

2. 選取您想要從清單中移除的反惡意程式碼原則，然後按一下 [刪除] (![刪除圖示](../../media/ITPro-EAC-DeleteIcon.png))。

## <a name="use-exchange-online-powershell-or-standalone-eop-powershell-to-configure-anti-malware-policies"></a>使用 Exchange Online PowerShell 或獨立 EOP PowerShell 設定反惡意程式碼原則

### <a name="use-powershell-to-create-anti-malware-policies"></a>使用 PowerShell 來建立反惡意程式碼原則

若要在 PowerShell 中建立反惡意程式碼原則，需執行兩個步驟：

1. 建立惡意程式碼篩選原則。

2. 建立惡意程式碼篩選規則，此規則會指定要套用規則的惡意程式碼篩選原則。

 **附註**：

- 您可以建立新的惡意程式碼篩選規則，並對其指派未關聯的現有惡意程式碼篩選原則。 惡意程式碼篩選規則無法與多個惡意程式碼篩選原則相關聯。

- 您可以在新的反惡意程式碼原則上，進行下列兩項設定：在您建立原則之前，您無法在 PowerShell 中使用 & 相容性中心的安全性：

  - _在_ `$false` **New-MalwareFilterRule** Cmdlet) 上，建立新原則做為已停用 (。

  - 在 _Priority_ _\<Number\>_ **New-MalwareFilterRule** Cmdlet) 上建立 (優先順序) 時，設定原則的優先順序。

- 在您將原則指派給惡意軟體篩選規則之前，您在 PowerShell 中建立的新惡意程式碼篩選原則不會出現在安全性 & 規範中心。

#### <a name="step-1-use-powershell-to-create-a-malware-filter-policy"></a>步驟 1：使用 PowerShell 建立惡意程式碼篩選原則

**附注**：在 EOP 中， _Action_ 參數值 `DeleteMessage` ， `DeleteAttachmentAndUseDefaultAlert` 不會 `DeleteAttachmentAndUseCustomAlert` 刪除郵件。 相反地，郵件會被隔離。 如需有關檢索隔離郵件的詳細資訊，請參閱 [在 EOP 中以系統管理員身分管理隔離的郵件和](manage-quarantined-messages-and-files.md)檔案。

若要建立惡意程式碼篩選原則，請使用下列語法：

```PowerShell
New-MalwareFilterPolicy -Name "<PolicyName>" [-Action <DeleteMessage | DeleteAttachmentAndUseDefaultAlert | DeleteAttachmentAndUseCustomAlert>] [-AdminDisplayName "<OptionalComments>"] [-CustomNotifications <$true | $false>] [<Inbound notification options>] [<Outbound notification options>]
```

本範例搭配下列設定建立命名為 Contoso Malware Filter Policy 的新惡意程式篩選原則：

- 隔離包含惡意程式碼的郵件，但未通知收件者 (我們不會使用 _Action_ 參數，而且預設值是 `DeleteMessage`) 。

- 在郵件中偵測到惡意程式碼時不通知郵件寄件者 (我們不是使用 _EnableExternalSenderNotifications_ 或 _EnableInternalSenderNotifications_ 參數，兩個參數的預設值都是 `$false`)。

- 從內部寄件者的訊息中偵測到惡意程式時，通知管理員 admin@contoso.com。

```PowerShell
New-MalwareFilterPolicy -Name "Contoso Malware Filter Policy" -EnableInternalSenderAdminNotifications $true -InternalSenderAdminAddress admin@contoso.com
```

如需詳細的語法及參數資訊，請參閱 [New-MalwareFilterPolicy](https://docs.microsoft.com/powershell/module/exchange/new-malwarefilterpolicy)。

#### <a name="step-2-use-powershell-to-create-a-malware-filter-rule"></a>步驟 2：使用 PowerShell 建立惡意程式碼篩選規則

若要建立惡意程式碼篩選規則，請使用下列語法：

```PowerShell
New-MalwareFilterRule -Name "<RuleName>" -MalwareFilterPolicy "<PolicyName>" <Recipient filters> [<Recipient filter exceptions>] [-Comments "<OptionalComments>"]
```

此範例使用下列設定來建立名稱為 Contoso Recipients 的新惡意軟體篩選規則：

- 名為 Contoso Malware Filter Policy 的惡意程式碼篩選原則會與規則產生關聯。

- 規則會套用至 contoso.com 網域中的收件者。

```PowerShell
New-MalwareFilterRule -Name "Contoso Recipients" -MalwareFilterPolicy "Contoso Malware Filter Policy" -RecipientDomainIs contoso.com
```

如需詳細的語法及參數資訊，請參閱 [New-MalwareFilterRule](https://docs.microsoft.com/powershell/module/exchange/new-malwarefilterrule)。

### <a name="use-powershell-to-view-malware-filter-policies"></a>使用 PowerShell 檢視惡意程式碼篩選原則

若要傳回所有惡意程式碼篩選原則的摘要清單，請執行下列命令：

```PowerShell
Get-MalwareFilterPolicy
```

若要傳回特定惡意程式碼篩選原則的詳細資訊，請使用下列語法：

```PowerShell
Get-MalwareFilterPolicy -Identity "<PolicyName>" | Format-List [<Specific properties to view>]
```

此範例會傳回惡意程式碼篩選原則 (名稱為 Executives) 的所有屬性值。

```PowerShell
Get-MalwareFilterPolicy -Identity "Executives" | Format-List
```

此範例只會傳回相同原則的指定屬性。

```PowerShell
Get-MalwareFilterPolicy -Identity "Executives" | Format-List Action,AdminDisplayName,CustomNotifications,Enable*Notifications
```

如需詳細的語法及參數資訊，請參閱 [Get-MalwareFilterPolicy](https://docs.microsoft.com/powershell/module/exchange/get-malwarefilterpolicy)。

### <a name="use-powershell-to-view-malware-filter-rules"></a>使用 PowerShell 檢視惡意程式碼篩選規則

若要傳回所有惡意程式碼篩選規則的摘要清單，請執行下列命令：

```PowerShell
Get-MalwareFilterRule
```

若要依啟用或停用篩選規則的清單，請執行下列命令：

```PowerShell
Get-HostedContentFilterRule -State Disabled
```

```PowerShell
Get-HostedContentFilterRule -State Enabled
```

若要傳回特定惡意程式碼篩選規則的詳細資訊，請使用下列語法：

```PowerShell
Get-MalwareFilterRule -Identity "<RuleName>" | Format-List [<Specific properties to view>]
```

此範例會傳回惡意程式碼篩選規則 (名稱為 Executives) 的所有屬性值。

```PowerShell
Get-MalwareFilterRule -Identity "Executives" | Format-List
```

此範例只會傳回相同規則的指定屬性。

```PowerShell
Get-MalwareFilterRule -Identity "Executives" | Format-List Name,Priority,State,MalwareFilterPolicy,*Is,*SentTo,*MemberOf
```

如需詳細的語法及參數資訊，請參閱 [Get-MalwareFilterRule](https://docs.microsoft.com/powershell/module/exchange/get-malwarefilterrule)。

### <a name="use-powershell-to-modify-malware-filter-policies"></a>使用 PowerShell 修改惡意程式碼篩選原則

除了下列專案之外，當您在 PowerShell 中修改惡意程式碼篩選原則時，當您在本主題稍早的 [步驟1：使用 PowerShell 建立惡意程式碼篩選原則](#step-1-use-powershell-to-create-a-malware-filter-policy) 區段中所述時，就可以使用相同的設定。

- _MakeDefault_ 參數會將指定的原則轉換成預設原則 (套用至所有人、不可修改的 **最低** 優先順序，而且您無法刪除只有當您在 PowerShell 中修改惡意程式碼篩選原則時，才可使用此參數) 。

- 您無法重新命名惡意程式碼篩選原則 (**Set-MalwareFilterPolicy** Cmdlet 沒有 _Name_ 參數) 。 當您在安全性 & 規範中心重新命名反惡意程式碼原則時，您只是重新命名惡意程式碼篩選 _規則_。

若要修改惡意程式碼篩選原則，請使用下列語法：

```PowerShell
Set-MalwareFilterPolicy -Identity "<PolicyName>" <Settings>
```

如需詳細的語法及參數資訊，請參閱 [Set-MalwareFilterPolicy](https://docs.microsoft.com/powershell/module/exchange/set-malwarefilterpolicy)。

### <a name="use-powershell-to-modify-malware-filter-rules"></a>使用 PowerShell 修改惡意程式碼篩選規則

當您在 PowerShell 中修改惡意程式碼篩選規則時，唯一可用的設定是 _Enabled_ 參數，可讓您建立已停用的規則。 若要啟用或停用現有的惡意程式碼篩選規則，請參閱下一節。

否則，當您在 PowerShell 中修改惡意程式碼篩選規則時，不會有其他設定可供使用。 如本主題稍早的 [步驟2：使用 PowerShell 來建立惡意軟體篩選規則](#step-2-use-powershell-to-create-a-malware-filter-rule) 一節所述，建立規則時，可以使用相同的設定。

若要修改惡意程式碼篩選規則，請使用下列語法：

```PowerShell
Set-MalwareFilterRule -Identity "<RuleName>" <Settings>
```

如需詳細的語法及參數資訊，請參閱 [Set-MalwareFilterRule](https://docs.microsoft.com/powershell/module/exchange/set-malwarefilterrule)。

### <a name="use-powershell-to-enable-or-disable-malware-filter-rules"></a>使用 PowerShell 來啟用或停用惡意程式碼篩選規則

在 PowerShell 中啟用或停用惡意程式碼篩選規則，可啟用或停用惡意程式碼篩選規則和指派的惡意程式碼篩選原則)  (的整個反惡意程式碼原則。 您無法啟用或停用預設反惡意程式碼原則 (永遠永遠套用至所有收件者) 。

若要在 PowerShell 中啟用或停用惡意程式碼篩選規則，請使用下列語法：

```PowerShell
<Enable-MalwareFilterRule | Disable-MalwareFilterRule> -Identity "<RuleName>"
```

此範例會停用名稱為 Marketing Department 的惡意程式碼篩選規則。

```PowerShell
Disable-MalwareFilterRule -Identity "Marketing Department"
```

此範例會啟用相同規則。

```PowerShell
Enable-MalwareFilterRule -Identity "Marketing Department"
```

如需詳細的語法及參數資訊，請參閱 [Enable-MalwareFilterRule](https://docs.microsoft.com/powershell/module/exchange/enable-malwarefilterrule) 和 [Disable-MalwareFilterRule](https://docs.microsoft.com/powershell/module/exchange/disable-malwarefilterrule)。

### <a name="use-powershell-to-set-the-priority-of-malware-filter-rules"></a>使用 PowerShell 設定惡意軟體篩選規則的優先順序

您可以對規則設定的最高優先順序值為 0。 您可以設定的最低值則取決於規則的數目。 例如，如果您有五個規則，則您可以使用 0 到 4 的優先順序值。 變更現有規則的優先順序會對其他規則造成階層式影響。 例如，如果您有五個自訂規則 (優先順序 0 到 4)，而您將規則的優先順序變更為 2，則優先順序為 2 的現有規則會變更為優先順序 3，優先順序 3 的規則會變更為優先順序 4。

若要在 PowerShell 中設定惡意軟體篩選規則的優先順序，請使用下列語法：

```PowerShell
Set-MalwareFilterRule -Identity "<RuleName>" -Priority <Number>
```

此範例會將規則 (名稱為 Marketing Department) 的優先順序設定為 2。 優先順序小於或等於 2 的所有現有規則會減 1 (它們的優先順序數字會加 1)。

```PowerShell
Set-MalwareFilterRule -Identity "Marketing Department" -Priority 2
```

**附註**：

- 若要在建立新規則時設定其優先順序，請改用 **New-MalwareFilterRule** Cmdlet 上的 _priority_ 參數。

- 預設惡意程式碼篩選原則沒有對應的惡意軟體篩選規則，它永遠具有「未修改的優先順序 **」值。**

### <a name="use-powershell-to-remove-malware-filter-policies"></a>使用 PowerShell 移除惡意程式碼篩選原則

當您使用 PowerShell 來移除惡意程式碼篩選原則時，對應的惡意程式碼篩選規則不會遭到移除。

若要在 PowerShell 中移除惡意程式碼篩選原則，請使用下列語法：

```PowerShell
Remove-MalwareFilterPolicy -Identity "<PolicyName>"
```

此範例會移除名稱為 Marketing Department 的惡意程式碼篩選原則。

```PowerShell
Remove-MalwareFilterPolicy -Identity "Marketing Department"
```

如需詳細的語法及參數資訊，請參閱 [Remove-MalwareFilterPolicy](https://docs.microsoft.com/powershell/module/exchange/remove-malwarefilterpolicy)。

### <a name="use-powershell-to-remove-malware-filter-rules"></a>使用 PowerShell 移除惡意程式碼篩選規則

當您使用 PowerShell 移除惡意程式碼篩選規則時，並不會移除對應的惡意程式碼篩選原則。

若要在 PowerShell 中移除惡意程式碼篩選規則，請使用下列語法：

```PowerShell
Remove-MalwareFilterRule -Identity "<PolicyName>"
```

此範例會移除名為 Marketing 部門的惡意軟體篩選規則。

```PowerShell
Remove-MalwareFilterRule -Identity "Marketing Department"
```

如需詳細的語法及參數資訊，請參閱 [Remove-MalwareFilterRule](https://docs.microsoft.com/powershell/module/exchange/remove-malwarefilterrule)。

## <a name="how-do-you-know-these-procedures-worked"></a>如何知道這些程序是否正常運作？

### <a name="use-the-eicartxt-file-to-verify-your-anti-malware-policy-settings"></a>使用 EICAR.TXT 檔案來驗證您的反惡意程式碼原則設定

> [!IMPORTANT]
> EICAR.TXT 檔案不是病毒。 《電腦防病毒研究的歐洲研究院 (EICAR.TXT) 開發此檔案，以安全地測試防病毒安裝和設定。

1. 開啟 [記事本]，並將下列文字貼至空白檔案：

   ```Text
   X5O!P%@AP[4\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*
   ```

   請確定這些是檔中唯一的文字字元。 檔案大小應為68位元組。

2. 將檔案儲存為 EICAR.TXT

   在您的桌上型電腦防毒程式中，請務必從掃描中排除 EICAR.TXT (否則，將會) 隔離該檔案。

3. 使用不會自動封鎖檔的電子郵件客戶程式，傳送包含 EICAR.TXT 檔案的電子郵件。 使用您的反惡意程式碼原則設定來決定要測試的下列案例：

   - 從內部信箱到內部收件者的電子郵件。

   - 從內部信箱到外部收件者的電子郵件。

   - 從外部信箱到內部收件者的電子郵件。

4. 請確認已隔離郵件，並根據您的反惡意程式碼原則設定驗證收件者和寄件者的通知結果。 例如：

   - 收件者不會收到通知，或收件者會收到包含預設或自訂文字的 EICAR.TXT 附件（由 **惡意程式碼警示 Text.txt** 所取代）。

   - 會以預設或自訂的通知訊息通知內部或外部寄件者。

   - 您指定的系統管理員電子郵件地址會以預設或自訂的通知訊息通知內部或外部的郵件寄件者。

5. 完成測試之後刪除 EICAR.TXT 檔案 (讓其他使用者不會因) 而不必要地發出警報。
