---
title: 使用 PowerShell、WMI 及 MPCmdRun.exe 管理 Microsoft Defender for Endpoint
description: 瞭解如何使用 PowerShell、WMI 及 MPCmdRun.exe 管理 Microsoft Defender for Endpoint
keywords: 遷移後、管理、作業、維護、使用狀況、PowerShell、WMI、MPCmdRun.exe、Microsoft Defender for Endpoint、edr
search.product: eADQiWindows 10XVcnh
search.appverid: met150
ms.prod: m365-security
ms.technology: mde
ms.mktglfcycl: deploy
ms.sitesec: library
ms.pagetype: security
ms.author: deniseb
author: denisebmsft
localization_priority: Normal
manager: dansimp
audience: ITPro
ms.collection:
- M365-security-compliance
- m365solution-scenario
ms.topic: article
ms.date: 09/22/2020
ms.reviewer: chventou
ms.openlocfilehash: 063870c58377d7327f621ec49855b684065f436b
ms.sourcegitcommit: 4886457c0d4248407bddec56425dba50bb60d9c4
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 07/03/2021
ms.locfileid: "53286762"
---
# <a name="manage-microsoft-defender-for-endpoint-with-powershell-wmi-and-mpcmdrunexe"></a><span data-ttu-id="ff547-104">使用 PowerShell、WMI 及 MPCmdRun.exe 管理 Microsoft Defender for Endpoint</span><span class="sxs-lookup"><span data-stu-id="ff547-104">Manage Microsoft Defender for Endpoint with PowerShell, WMI, and MPCmdRun.exe</span></span>

[!INCLUDE [Microsoft 365 Defender rebranding](../../includes/microsoft-defender.md)]

<span data-ttu-id="ff547-105">**適用於：**</span><span class="sxs-lookup"><span data-stu-id="ff547-105">**Applies to:**</span></span>
- [<span data-ttu-id="ff547-106">適用於端點的 Microsoft Defender</span><span class="sxs-lookup"><span data-stu-id="ff547-106">Microsoft Defender for Endpoint</span></span>](https://go.microsoft.com/fwlink/p/?linkid=2154037)
- [<span data-ttu-id="ff547-107">Microsoft 365 Defender</span><span class="sxs-lookup"><span data-stu-id="ff547-107">Microsoft 365 Defender</span></span>](https://go.microsoft.com/fwlink/?linkid=2118804)

> <span data-ttu-id="ff547-108">想要體驗適用於端點的 Microsoft Defender 嗎？</span><span class="sxs-lookup"><span data-stu-id="ff547-108">Want to experience Microsoft Defender for Endpoint?</span></span> [<span data-ttu-id="ff547-109">注册免費試用版。</span><span class="sxs-lookup"><span data-stu-id="ff547-109">Sign up for a free trial.</span></span>](https://www.microsoft.com/microsoft-365/windows/microsoft-defender-atp?ocid=docs-wdatp-exposedapis-abovefoldlink)

> [!NOTE]
> <span data-ttu-id="ff547-110">建議使用[Microsoft 端點管理員](/mem)來管理組織的威脅防護功能，以供裝置 (也稱為端點) 。</span><span class="sxs-lookup"><span data-stu-id="ff547-110">We recommend using [Microsoft Endpoint Manager](/mem) to manage your organization's threat protection features for devices (also referred to as endpoints).</span></span> <span data-ttu-id="ff547-111">端點管理員包括[Microsoft Intune](/mem/intune/fundamentals/what-is-intune)和[Microsoft Endpoint Configuration Manager](/mem/configmgr/core/understand/introduction)。</span><span class="sxs-lookup"><span data-stu-id="ff547-111">Endpoint Manager includes [Microsoft Intune](/mem/intune/fundamentals/what-is-intune) and [Microsoft Endpoint Configuration Manager](/mem/configmgr/core/understand/introduction).</span></span>
>
> - [<span data-ttu-id="ff547-112">深入瞭解端點管理員</span><span class="sxs-lookup"><span data-stu-id="ff547-112">Learn more about Endpoint Manager</span></span>](/mem/endpoint-manager-overview)
> - [<span data-ttu-id="ff547-113">使用 Configuration Manager 和 Intune 在 Windows 10 裝置上共同管理 Microsoft Defender for Endpoint</span><span class="sxs-lookup"><span data-stu-id="ff547-113">Co-manage Microsoft Defender for Endpoint on Windows 10 devices with Configuration Manager and Intune</span></span>](manage-atp-post-migration-intune.md)
> - [<span data-ttu-id="ff547-114">使用 Intune 管理 Microsoft Defender for Endpoint</span><span class="sxs-lookup"><span data-stu-id="ff547-114">Manage Microsoft Defender for Endpoint with Intune</span></span>](manage-atp-post-migration-intune.md)

<span data-ttu-id="ff547-115">您可以使用[PowerShell](#configure-microsoft-defender-for-endpoint-with-powershell)管理裝置上的某些 Microsoft Defender 防毒軟體設定， [Windows 管理工具](#configure-microsoft-defender-for-endpoint-with-windows-management-instrumentation-wmi) (WMI) ，以及[Microsoft 惡意程式碼防護命令列公用程式](#configure-microsoft-defender-for-endpoint-with-microsoft-malware-protection-command-line-utility-mpcmdrunexe) (MPCmdRun.exe) 。</span><span class="sxs-lookup"><span data-stu-id="ff547-115">You can manage some Microsoft Defender Antivirus settings on devices with [PowerShell](#configure-microsoft-defender-for-endpoint-with-powershell),  [Windows Management Instrumentation](#configure-microsoft-defender-for-endpoint-with-windows-management-instrumentation-wmi) (WMI), and the [Microsoft Malware Protection Command Line Utility](#configure-microsoft-defender-for-endpoint-with-microsoft-malware-protection-command-line-utility-mpcmdrunexe) (MPCmdRun.exe).</span></span> <span data-ttu-id="ff547-116">例如，您可以管理一些 Microsoft Defender 防毒軟體設定。</span><span class="sxs-lookup"><span data-stu-id="ff547-116">For example, you can manage some Microsoft Defender Antivirus settings.</span></span> <span data-ttu-id="ff547-117">此外，在某些情況下，您可以自訂攻擊面減少規則和 exploit protection 設定。</span><span class="sxs-lookup"><span data-stu-id="ff547-117">And, in some cases, you can customize your attack surface reduction rules and exploit protection settings.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="ff547-118">您使用 PowerShell、WMI 或 MCPmdRun.exe 所設定的威脅防護功能，可透過使用 Intune 或 Configuration Manager 部署的設定設定覆寫。</span><span class="sxs-lookup"><span data-stu-id="ff547-118">Threat protection features that you configure by using PowerShell, WMI, or MCPmdRun.exe can be overwritten by configuration settings that are deployed with Intune or Configuration Manager.</span></span>

## <a name="configure-microsoft-defender-for-endpoint-with-powershell"></a><span data-ttu-id="ff547-119">設定 Microsoft Defender for Endpoint with PowerShell</span><span class="sxs-lookup"><span data-stu-id="ff547-119">Configure Microsoft Defender for Endpoint with PowerShell</span></span>

<span data-ttu-id="ff547-120">您可以使用 PowerShell 來管理 Microsoft Defender 防毒軟體、exploit protection 和攻擊面降低規則。</span><span class="sxs-lookup"><span data-stu-id="ff547-120">You can use PowerShell to manage Microsoft Defender Antivirus, exploit protection, and your attack surface reduction rules.</span></span>

|<span data-ttu-id="ff547-121">工作</span><span class="sxs-lookup"><span data-stu-id="ff547-121">Task</span></span>|<span data-ttu-id="ff547-122">可深入了解的資源</span><span class="sxs-lookup"><span data-stu-id="ff547-122">Resources to learn more</span></span>|
|---|---|
|<span data-ttu-id="ff547-123">**管理 Microsoft Defender 防毒軟體**</span><span class="sxs-lookup"><span data-stu-id="ff547-123">**Manage Microsoft Defender Antivirus**</span></span> <p> <span data-ttu-id="ff547-124">查看反惡意程式碼保護的狀態、設定防病毒掃描的喜好設定 & 更新，以及對您的防防毒保護進行其他變更。</span><span class="sxs-lookup"><span data-stu-id="ff547-124">View status of antimalware protection, configure preferences for antivirus scans & updates, and make other changes to your antivirus protection.\*</span></span>|[<span data-ttu-id="ff547-125">使用 PowerShell Cmdlet 來設定及管理 Microsoft Defender 防毒軟體</span><span class="sxs-lookup"><span data-stu-id="ff547-125">Use PowerShell cmdlets to configure and manage Microsoft Defender Antivirus</span></span>](/windows/security/threat-protection/microsoft-defender-antivirus/use-powershell-cmdlets-microsoft-defender-antivirus) <p> [<span data-ttu-id="ff547-126">使用 PowerShell Cmdlet 以啟用雲端提供的保護</span><span class="sxs-lookup"><span data-stu-id="ff547-126">Use PowerShell cmdlets to enable cloud-delivered protection</span></span>](/windows/security/threat-protection/microsoft-defender-antivirus/enable-cloud-protection-microsoft-defender-antivirus#use-powershell-cmdlets-to-enable-cloud-delivered-protection)|
|<span data-ttu-id="ff547-127">**設定 exploit protection** ，以減輕組織裝置的威脅</span><span class="sxs-lookup"><span data-stu-id="ff547-127">**Configure exploit protection** to mitigate threats on your organization's devices</span></span> <p> <span data-ttu-id="ff547-128">*我們建議您先在 [稽核模式](/microsoft-365/security/defender-endpoint/evaluate-exploit-protection#powershell) 中使用 exploit protection。如此一來，您就可以看到使用方式保護會如何影響組織所使用的應用程式。*</span><span class="sxs-lookup"><span data-stu-id="ff547-128">*We recommend using exploit protection in [audit mode](/microsoft-365/security/defender-endpoint/evaluate-exploit-protection#powershell) at first. That way, you can see how exploit protection affects apps your organization is using.*</span></span>|[<span data-ttu-id="ff547-129">自訂利用保護</span><span class="sxs-lookup"><span data-stu-id="ff547-129">Customize exploit protection</span></span>](/microsoft-365/security/defender-endpoint/customize-exploit-protection) <p> [<span data-ttu-id="ff547-130">PowerShell 用於 exploit protection 的 Cmdlet</span><span class="sxs-lookup"><span data-stu-id="ff547-130">PowerShell cmdlets for exploit protection</span></span>](/microsoft-365/security/defender-endpoint/customize-exploit-protection#powershell-reference)|
|<span data-ttu-id="ff547-131">使用 PowerShell **設定攻擊面降低規則**</span><span class="sxs-lookup"><span data-stu-id="ff547-131">**Configure attack surface reduction rules** with PowerShell</span></span> <p> <span data-ttu-id="ff547-132">*您可以使用 PowerShell，從攻擊面減少規則中排除檔案和資料夾。*</span><span class="sxs-lookup"><span data-stu-id="ff547-132">*You can use PowerShell to exclude files and folders from attack surface reduction rules.*</span></span>|[<span data-ttu-id="ff547-133">自訂攻擊面降減規則：使用 PowerShell 排除檔案 & 資料夾</span><span class="sxs-lookup"><span data-stu-id="ff547-133">Customize attack surface reduction rules: Use PowerShell to exclude files & folders</span></span>](/microsoft-365/security/defender-endpoint/customize-attack-surface-reduction#use-powershell-to-exclude-files-and-folders) <p> <span data-ttu-id="ff547-134">此外，請參閱 [António Vasconcelo 的圖形使用者介面工具，以使用 PowerShell 來設定攻擊面降減規則](https://github.com/anvascon/MDATP_PoSh_Scripts/tree/master/ASR%20GUI)。</span><span class="sxs-lookup"><span data-stu-id="ff547-134">Also, see [António Vasconcelo's graphical user interface tool for setting attack surface reduction rules with PowerShell](https://github.com/anvascon/MDATP_PoSh_Scripts/tree/master/ASR%20GUI).</span></span>|
|<span data-ttu-id="ff547-135">使用 PowerShell **啟用網路保護**</span><span class="sxs-lookup"><span data-stu-id="ff547-135">**Enable Network Protection** with PowerShell</span></span> <p> <span data-ttu-id="ff547-136">*您可以使用 PowerShell 來啟用網路保護。*</span><span class="sxs-lookup"><span data-stu-id="ff547-136">*You can use PowerShell to enable Network Protection.*</span></span>|[<span data-ttu-id="ff547-137">使用 PowerShell 開啟網路保護</span><span class="sxs-lookup"><span data-stu-id="ff547-137">Turn on Network Protection with PowerShell</span></span>](/microsoft-365/security/defender-endpoint/enable-network-protection#powershell)|
|<span data-ttu-id="ff547-138">**設定受管理的資料夾存取** 權以防護勒索軟體</span><span class="sxs-lookup"><span data-stu-id="ff547-138">**Configure controlled folder access** to protect against ransomware</span></span> <p> <span data-ttu-id="ff547-139">*「[受管理的資料夾存取](/microsoft-365/security/defender-endpoint/controlled-folders)」也稱為 antiransomware protection。*</span><span class="sxs-lookup"><span data-stu-id="ff547-139">*[Controlled folder access](/microsoft-365/security/defender-endpoint/controlled-folders) is also referred to as antiransomware protection.*</span></span>|[<span data-ttu-id="ff547-140">啟用 PowerShell 的可控資料夾存取</span><span class="sxs-lookup"><span data-stu-id="ff547-140">Enable controlled folder access with PowerShell</span></span>](/microsoft-365/security/defender-endpoint/enable-controlled-folders#powershell)|
|<span data-ttu-id="ff547-141">**設定 Microsoft Defender 防火牆** ，以封鎖進出組織裝置的未授權網路流量</span><span class="sxs-lookup"><span data-stu-id="ff547-141">**Configure Microsoft Defender Firewall** to block unauthorized network traffic flowing into or out of your organization's devices</span></span>|[<span data-ttu-id="ff547-142">使用 Windows PowerShell 進行高級安全性管理的 Microsoft Defender 防火牆</span><span class="sxs-lookup"><span data-stu-id="ff547-142">Microsoft Defender Firewall with Advanced Security Administration using Windows PowerShell</span></span>](/windows/security/threat-protection/windows-firewall/windows-firewall-with-advanced-security-administration-with-windows-powershell)|
|<span data-ttu-id="ff547-143">**設定加密和 BitLocker** ，以保護組織執行 Windows 的裝置資訊</span><span class="sxs-lookup"><span data-stu-id="ff547-143">**Configure encryption and BitLocker** to protect information on your organization's devices running Windows</span></span>|[<span data-ttu-id="ff547-144">BitLocker PowerShell 參考手冊</span><span class="sxs-lookup"><span data-stu-id="ff547-144">BitLocker PowerShell reference guide</span></span>](/powershell/module/bitlocker/)|

## <a name="configure-microsoft-defender-for-endpoint-with-windows-management-instrumentation-wmi"></a><span data-ttu-id="ff547-145">設定 Microsoft Defender for Endpoint with Windows Management Instrumentation (WMI) </span><span class="sxs-lookup"><span data-stu-id="ff547-145">Configure Microsoft Defender for Endpoint with Windows Management Instrumentation (WMI)</span></span>

<span data-ttu-id="ff547-146">WMI 是一個指令碼介面，可讓您檢索、修改和更新設定。</span><span class="sxs-lookup"><span data-stu-id="ff547-146">WMI is a scripting interface that allows you to retrieve, modify, and update settings.</span></span> <span data-ttu-id="ff547-147">若要深入瞭解，請參閱 [使用 WMI](/windows/win32/wmisdk/using-wmi)。</span><span class="sxs-lookup"><span data-stu-id="ff547-147">To learn more, see [Using WMI](/windows/win32/wmisdk/using-wmi).</span></span>

|<span data-ttu-id="ff547-148">工作</span><span class="sxs-lookup"><span data-stu-id="ff547-148">Task</span></span>|<span data-ttu-id="ff547-149">可深入了解的資源</span><span class="sxs-lookup"><span data-stu-id="ff547-149">Resources to learn more</span></span>|
|---|---|
|<span data-ttu-id="ff547-150">在裝置上 **啟用雲端提供保護**</span><span class="sxs-lookup"><span data-stu-id="ff547-150">**Enable cloud-delivered protection** on a device</span></span>|[<span data-ttu-id="ff547-151">使用 Windows 管理指令 (WMI) 以啟用雲端提供的保護</span><span class="sxs-lookup"><span data-stu-id="ff547-151">Use Windows Management Instruction (WMI) to enable cloud-delivered protection</span></span>](/windows/security/threat-protection/microsoft-defender-antivirus/enable-cloud-protection-microsoft-defender-antivirus#use-windows-management-instruction-wmi-to-enable-cloud-delivered-protection)|
|<span data-ttu-id="ff547-152">**檢索、修改和更新** Microsoft Defender 防毒軟體的設定</span><span class="sxs-lookup"><span data-stu-id="ff547-152">**Retrieve, modify, and update settings** for Microsoft Defender Antivirus</span></span>|<span data-ttu-id="ff547-153">[使用 WMI 設定及管理 Microsoft Defender 防毒軟體] (/windows/security/threat-protection/microsoft-defender-antivirus/use-wmi-microsoft-defender-antivirus</span><span class="sxs-lookup"><span data-stu-id="ff547-153">[Use WMI to configure and manage Microsoft Defender Antivirus](/windows/security/threat-protection/microsoft-defender-antivirus/use-wmi-microsoft-defender-antivirus</span></span> <p> [<span data-ttu-id="ff547-154">檢查可用 WMI 類別和範例腳本的清單</span><span class="sxs-lookup"><span data-stu-id="ff547-154">Review the list of available WMI classes and example scripts</span></span>](/previous-versions/windows/desktop/defender/windows-defender-wmiv2-apis-portal) <p> <span data-ttu-id="ff547-155">另請參閱封存的[Windows Defender WMIv2 提供者參考資訊](/previous-versions/windows/desktop/defender/windows-defender-wmiv2-apis-portal?redirectedfrom=MSDN)</span><span class="sxs-lookup"><span data-stu-id="ff547-155">Also see the archived [Windows Defender WMIv2 Provider reference information](/previous-versions/windows/desktop/defender/windows-defender-wmiv2-apis-portal?redirectedfrom=MSDN)</span></span>|

## <a name="configure-microsoft-defender-for-endpoint-with-microsoft-malware-protection-command-line-utility-mpcmdrunexe"></a><span data-ttu-id="ff547-156">使用 Microsoft 惡意程式碼防護 Command-Line 公用程式 (MPCmdRun.exe 設定 Microsoft Defender for Endpoint) </span><span class="sxs-lookup"><span data-stu-id="ff547-156">Configure Microsoft Defender for Endpoint with Microsoft Malware Protection Command-Line Utility (MPCmdRun.exe)</span></span>

<span data-ttu-id="ff547-157">在個別裝置上，您可以執行掃描、啟動診斷追蹤、檢查安全性智慧更新，以及使用 mpcmdrun.exe 命令列工具進行更多工作。</span><span class="sxs-lookup"><span data-stu-id="ff547-157">On an individual device, you can run a scan, start diagnostic tracing, check for security intelligence updates, and more using the mpcmdrun.exe command-line tool.</span></span> <span data-ttu-id="ff547-158">您可以在中找到該公用程式 `%ProgramFiles%\Windows Defender\MpCmdRun.exe` 。</span><span class="sxs-lookup"><span data-stu-id="ff547-158">You can find the utility in `%ProgramFiles%\Windows Defender\MpCmdRun.exe`.</span></span> <span data-ttu-id="ff547-159">從命令提示字元執行。</span><span class="sxs-lookup"><span data-stu-id="ff547-159">Run it from a command prompt.</span></span>

|<span data-ttu-id="ff547-160">工作</span><span class="sxs-lookup"><span data-stu-id="ff547-160">Task</span></span>|<span data-ttu-id="ff547-161">可深入了解的資源</span><span class="sxs-lookup"><span data-stu-id="ff547-161">Resources to learn more</span></span>|
|---|---|
|<span data-ttu-id="ff547-162">**管理 Microsoft Defender 防毒軟體**</span><span class="sxs-lookup"><span data-stu-id="ff547-162">**Manage Microsoft Defender Antivirus**</span></span>|[<span data-ttu-id="ff547-163">使用 mpcmdrun.exe設定及管理 Microsoft Defender 防毒軟體</span><span class="sxs-lookup"><span data-stu-id="ff547-163">Configure and manage Microsoft Defender Antivirus with mpcmdrun.exe</span></span>](/windows/security/threat-protection/microsoft-defender-antivirus/command-line-arguments-microsoft-defender-antivirus)|

## <a name="configure-your-microsoft-defender-security-center"></a><span data-ttu-id="ff547-164">設定 Microsoft Defender 資訊安全中心</span><span class="sxs-lookup"><span data-stu-id="ff547-164">Configure your Microsoft Defender Security Center</span></span>

<span data-ttu-id="ff547-165">若尚未這麼做，請 **設定 Microsoft Defender 資訊安全中心** ([https://securitycenter.windows.com](https://securitycenter.windows.com)) 以查看提醒、設定威脅防護功能，以及查看組織整體安全性狀況的詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="ff547-165">If you haven't already done so, **configure your Microsoft Defender Security Center** ([https://securitycenter.windows.com](https://securitycenter.windows.com)) to view alerts, configure threat protection features, and view detailed information about your organization's overall security posture.</span></span>

<span data-ttu-id="ff547-166">您也可以設定使用者是否可以在 Microsoft Defender 資訊安全中心中看到使用者的功能。</span><span class="sxs-lookup"><span data-stu-id="ff547-166">You can also configure whether and what features end users can see in the Microsoft Defender Security Center.</span></span>

- [<span data-ttu-id="ff547-167">Microsoft Defender 資訊安全中心綜述</span><span class="sxs-lookup"><span data-stu-id="ff547-167">Overview of the Microsoft Defender Security Center</span></span>](/microsoft-365/security/defender-endpoint/use)

- [<span data-ttu-id="ff547-168">Endpoint protection： Microsoft Defender 資訊安全中心</span><span class="sxs-lookup"><span data-stu-id="ff547-168">Endpoint protection: Microsoft Defender Security Center</span></span>](/mem/intune/protect/endpoint-protection-windows-10#microsoft-defender-security-center)

## <a name="next-steps"></a><span data-ttu-id="ff547-169">後續步驟</span><span class="sxs-lookup"><span data-stu-id="ff547-169">Next steps</span></span>

- [<span data-ttu-id="ff547-170">取得威脅與弱點管理的概觀</span><span class="sxs-lookup"><span data-stu-id="ff547-170">Get an overview of threat and vulnerability management</span></span>](/microsoft-365/security/defender-endpoint/next-gen-threat-and-vuln-mgt)

- [<span data-ttu-id="ff547-171">流覽 Microsoft Defender 資訊安全中心的安全性運作儀表板</span><span class="sxs-lookup"><span data-stu-id="ff547-171">Visit the Microsoft Defender Security Center security operations dashboard</span></span>](/microsoft-365/security/defender-endpoint/security-operations-dashboard)

- [<span data-ttu-id="ff547-172">使用 Intune 管理 Microsoft Defender for Endpoint</span><span class="sxs-lookup"><span data-stu-id="ff547-172">Manage Microsoft Defender for Endpoint with Intune</span></span>](manage-atp-post-migration-intune.md)
