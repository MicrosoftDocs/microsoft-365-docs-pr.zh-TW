---
title: 開啟 exploit protection 以協助緩解攻擊
keywords: exploit、緩解、攻擊、弱點
description: 瞭解如何在 Windows 10 中啟用 exploit protection。 Exploit protection 可協助保護您的裝置抵禦惡意程式碼。
search.product: eADQiWindows 10XVcnh
ms.prod: m365-security
ms.mktglfcycl: manage
ms.sitesec: library
localization_priority: Normal
audience: ITPro
author: denisebmsft
ms.author: deniseb
ms.reviewer: ksarens
manager: dansimp
ms.technology: mde
ms.topic: how-to
ms.date: 05/11/2021
ms.openlocfilehash: 62ae62cc1041e4de9c31e99cb90bed5b1a7312ad
ms.sourcegitcommit: 967f64dfa1a05f31179c8316b96bfb7758a5d990
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 05/12/2021
ms.locfileid: "52333725"
---
# <a name="enable-exploit-protection"></a>啟用入侵防護

**適用於：**
- [適用於端點的 Microsoft Defender](https://go.microsoft.com/fwlink/p/?linkid=2154037)
- [Microsoft 365 Defender](https://go.microsoft.com/fwlink/?linkid=2118804)

> [!TIP]
> 想要體驗 Defender for Endpoint？ [注册免費試用版。](https://www.microsoft.com/microsoft-365/windows/microsoft-defender-atp?ocid=docs-wdatp-assignaccess-abovefoldlink)

[Exploit protection](exploit-protection.md) 可協助防範惡意程式碼，以利用利用方式感染裝置和傳播。 Exploit protection 包含許多可用於作業系統或個別應用程式的緩解措施。

> [!IMPORTANT]
> .NET 2.0 與某些 exploit protection 功能不相容，特別是匯出位址篩選 (EAF) 和匯入位址篩選 (IAF) 。 如果您已啟用 .NET 2.0，EAF 和 IAF 的使用不受支援。

「增強型緩解經驗」工具組 (EMET) 中的許多功能都包含在 exploit protection 中。

您可以使用下列任何一種方法，分別啟用每個緩解：   
- [Windows 安全性應用程式](#windows-security-app)
- [Microsoft Intune](#intune)
- [移動裝置管理 (MDM) ](#mdm)
- [Microsoft Endpoint Configuration Manager](#microsoft-endpoint-configuration-manager)
- [群組原則](#group-policy)
- [PowerShell](#powershell)

Windows 10 中預設會設定 Exploit protection。 您可以將每個緩解措施設定為 [開啟]、[關閉] 或 [其預設值]。 有些遷移具有更多選項。 您可以將 [這些設定匯出為 XML](import-export-exploit-protection-emet-xml.md) 檔案，然後將其部署至其他裝置。

您也可以將 [緩解] 設定為 [ [稽核模式]](evaluate-exploit-protection.md)。 稽核模式可讓您測試緩解的運作方式 (和審查事件) 不會影響裝置的正常使用。

## <a name="windows-security-app"></a>Windows 安全性應用程式

1. 在您的工作列上選取盾牌圖示，或搜尋 [ **安全性**] 的 [開始] 功能表，以開啟 [Windows 安全性] 應用程式。

2. 在左功能表列上，選取 [ **應用程式] & 瀏覽器控制項** 磚 (或 app 圖示) 然後選取 [ **Exploit protection 設定**]。

3. 移至 [ **程式設定** ]，然後選擇您要套用緩解的應用程式。 <br/>
    - 如果您想要設定的應用程式已經列出，請選取它，然後選取 [ **編輯**]。
    - 若未列出該應用程式，請在清單頂端選取 [ **新增程式] 以自訂** ，然後選擇您想要新增應用程式的方式。 <br/>
    - 使用 [ **依程式名稱新增** ]，可對任何執行的程式套用具有該名稱的緩解。 指定副檔名為的檔案。 您可以輸入完整的路徑，以限制僅限此位置的應用程式的緩解。
    - 使用 **[選擇確切** 的檔案路徑]，使用標準 Windows Explorer 檔案選擇器視窗來尋找並選取您想要的檔。

4. 選取應用程式之後，您會看到可套用的所有緩解措施清單。 選擇 [ **審計** ] 只會在審計模式中套用緩解。 如果您需要重新開機此程式或應用程式，或需要重新開機 Windows，您會收到通知。

5. 針對您要設定的所有應用程式和緩解措施，重複步驟3-4。

6. 在 [ **系統設定** ] 區段下，找出您要設定的緩解措施，然後指定下列其中一項設定。 未在 [ **程式設定** ] 區段中個別設定的應用程式會使用這裡設定的設定。<br/>
    - **根據預設，在**[應用程式專用 **程式設定**] 區段中，針對未採用此緩解設定的應用程式 *啟用* 緩解功能。
    - **依預設關閉**：在應用程式特定的 **程式設定** 區段中，對於未具有此緩解設定的應用程式 *停用* 此緩解功能
    - **使用預設值**：根據 Windows 10 安裝所設定的預設設定，緩解可以啟用或停用;預設值 (開啟或 **關閉**) 會永遠 **在** 每個緩解的 **使用預設** 標籤旁指定

7. 針對您要設定的所有系統層級緩解重複步驟6。 當您設定好 **設定後，** 請選取 [套用]。

如果您將應用程式新增至 [ **程式設定** ] 區段中，並在其中設定個別的緩解設定，則會在 [ **系統設定** ] 區段中所指定的相同緩解措施的設定之上進行設定。 下列矩陣和範例可協助說明預設值的運作方式：

|啟用于 **程式設定** | 在 [**系統設定**] 中啟用 | 行為 |
|:---|:---|:---|
|是 | 否 | 如 **程式設定** 中所定義 |
|是 | 是 | 如 **程式設定** 中所定義 |
|否 | 是 | 如 **系統設定** 中所定義 |
|否 | 是 | **使用預設** 選項中定義的預設值 |

### <a name="example-1-mikael-configures-data-execution-prevention-in-system-settings-section-to-be-off-by-default"></a>範例1： Mikael 設定系統設定區段中的資料執行防護預設為關閉

Mikael 會將應用程式 *test.exe* 新增至 [ **程式設定** ] 區段。 在該應用程式的選項中，在 [ **資料執行防護 (DEP)**] 底下，Mikael 啟用 [覆 **寫系統設定** ] 選項，並將開關設定為 [ **開啟**]。 [ **程式設定** ] 區段中沒有列出任何其他應用程式。

結果是只會為 *test.exe* 啟用 DEP。 所有其他應用程式都不會套用 DEP。

### <a name="example-2-josie-configures-data-execution-prevention-in-system-settings-to-be-off-by-default"></a>範例2： Josie 將系統設定中的資料執行防護設定為預設關閉

Josie 會將應用程式 *test.exe* 新增至 [ **程式設定** ] 區段。 在該應用程式的選項中，在 [ **資料執行防護 (DEP)**] 底下，Josie 啟用 [覆 **寫系統設定** ] 選項，並將開關設定為 [ **開啟**]。

Josie 也會將應用程式 *miles.exe* 新增至 [ **程式設定** ] 區段，並將 **控制流程防護 (CFG)** 設定為 [ **開啟**]。 Josie 不會為此應用程式啟用 DEP 或任何其他緩解的覆 **寫系統設定** 選項。

結果是已為 *test.exe* 啟用 DEP。 任何其他應用程式（包括 *miles.exe*）都不會啟用 DEP。 將為 *miles.exe* 啟用 CFG。

1. 選取工作列中的盾牌圖示，或搜尋 **Defender** 的 [開始] 功能表，以開啟 [Windows 安全性] 應用程式。

2. 在左功能表列上選取 [ **app & browser control** (或 app 圖示) 然後選取 [利用方式 **保護**]。

3. 移至 [ **程式設定** ]，然後選擇您要套用緩解的應用程式。<br/>
    - 如果您想要設定的應用程式已經列出，請選取它，然後選取 [ **編輯**]。
    - 若未列出該應用程式，請在清單頂端選取 [ **新增程式] 以自訂** ，然後選擇您想要新增應用程式的方式。<br/>
     - 使用 [ **依程式名稱新增** ]，可對任何執行的程式套用具有該名稱的緩解。 指定副檔名為的檔案。 您可以輸入完整的路徑，以限制僅限此位置的應用程式的緩解。
     - 使用 **[選擇確切** 的檔案路徑]，使用標準 Windows Explorer 檔案選擇器視窗來尋找並選取您想要的檔。

4. 選取應用程式之後，您會看到可套用的所有緩解措施清單。 選擇 [ **審計** ] 只會在審計模式中套用緩解。 如果您需要重新開機此程式或應用程式，或需要重新開機 Windows，您將會收到通知。

5. 針對您要設定的所有應用程式和緩解措施，重複步驟3-4。 當您設定好 **設定後，** 請選取 [套用]。

## <a name="intune"></a>Intune

1. 登入 [Azure 入口網站](https://portal.azure.com) 並開啟 Intune。

2. 移至 **裝置配置**  >  **檔**  >  **建立設定檔**。

3. 命名設定檔，請選擇 [ **Windows 10 和更新版本** ] 和 [ **Endpoint protection**]。

   :::image type="content" source="images/create-endpoint-protection-profile.png" alt-text="建立 endpoint protection 設定檔":::

4. 選取 [**設定**  >  **Windows Defender 利用防護**  >  **exploit protection**]。

5. 上傳具有 exploit protection 設定的 [XML](/windows/client-management/mdm/policy-csp-exploitguard) 檔案：

   :::image type="content" source="images/enable-ep-intune.png" alt-text="在 Intune 中啟用網路保護":::

6. 選取 **[確定]** 以儲存每個開啟的刀片式伺服器，然後選擇 [ **建立**]。

7. 選取 [設定檔 **指派** ] 索引標籤，將原則指派給 **所有使用者 & 所有裝置**，然後選取 [ **儲存**]。

## <a name="mdm"></a>Mdm

使用 [/Vendor/MSFT/Policy/Config/ExploitGuard/ExploitProtectionSettings](/windows/client-management/mdm/policy-csp-exploitguard) configuration service PROVIDER (CSP) 來啟用或停用 exploit protection 緩解或使用稽核模式。

## <a name="microsoft-endpoint-manager"></a>Microsoft 端點管理員

1. 在 Microsoft 端點管理員中，請移至 **端點的安全性**  >  **攻擊面降減**。 

2. 選取 [**建立原則**  >  **平臺**]，並針對 [**設定檔**] 選擇 [**利用保護**]。 然後選取 [ **建立**]。

3. 指定名稱和描述，然後選擇 **[下一步]**。

4. 選擇 [ **選取 XML 檔** ]，然後流覽至 EXPLOIT protection XML 檔案的位置。 選取檔，然後選擇 **[下一步]**。

5. 必要時設定 **範圍標記** 和 **工作分派** 。 

6. 在 [ **複查 + 建立**] 下，複查您的設定，然後選擇 [ **建立**]。


## <a name="microsoft-endpoint-configuration-manager"></a>Microsoft Endpoint Configuration Manager

1. 在 Microsoft 端點 Configuration Manager 中，移至 [**資產和合規性**  >  **端點防護**] 「  >  **Windows Defender 利用防護**」。

2. 選取 [**首頁**  >  **建立 Exploit Guard 原則**]。

3. 指定名稱和描述，選取 [ **利用防護**]，然後選擇 **[下一步]**。

4. 流覽至 exploit protection XML 檔案的位置，然後選取 **[下一步**]。

5. 請複查設定，然後選擇 **[下一步]** 建立原則。

6. 建立原則之後，請選取 [ **關閉**]。

## <a name="group-policy"></a>群組原則

1. 在您的群組原則管理裝置上，開啟 [ [群組原則管理主控台](/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc731212(v=ws.11))]，以滑鼠右鍵按一下您要設定的群組原則物件，然後按一下 [ **編輯**]。

2. 在 [ **群組原則管理編輯器** ] 中，移至 [ **電腦** 設定]，然後選取 [ **管理範本**]。

3. 將樹狀目錄展開為 **windows 元件**  >  **windows Defender 利用防護**  >  **exploit protection**  >  **使用一組共同的 Exploit protection 設定**。

4. 選取 [ **啟用** ]，然後輸入 [XML](/windows/client-management/mdm/policy-csp-exploitguard)檔案的位置，然後選擇 **[確定]**。

## <a name="powershell"></a>PowerShell

您可以使用 PowerShell 動詞 `Get` 或 `Set` Cmdlet `ProcessMitigation` 。 使用 `Get` 會列出已在裝置上啟用之任何緩解作業的目前設定狀態-新增 `-Name` Cmdlet 和應用程式 exe，以查看僅適用于該應用程式的緩解：

```PowerShell
Get-ProcessMitigation -Name processName.exe
```

> [!IMPORTANT]
> 尚未設定的系統層級緩解措施會顯示狀態 `NOTSET` 。
> - 針對系統層級設定，表示已套用此 `NOTSET` 緩解的預設設定。
> - 針對應用層級設定， `NOTSET` 表示將會套用緩解的系統層級設定。
> Windows 安全性會顯示每個系統層級緩解的預設設定。

使用 `Set` 以下列格式設定每項緩解措施：

```PowerShell
Set-ProcessMitigation -<scope> <app executable> -<action> <mitigation or options>,<mitigation or options>,<mitigation or options>
```

其中：

* \<Scope>:
  * `-Name` 表示應將緩解措施套用至特定的應用程式。 指定此旗標之後的應用程式可執行檔。
    * `-System` 若要指出應該在系統層級套用緩解
* \<Action>:
  * `-Enable` 啟用緩解
  * `-Disable` 停用緩解
* \<Mitigation>:
  * 緩解的指令程式，以及任何 suboptions (以空格括住) 。 每個緩解都是以逗號分隔。

例如，若要啟用資料執行防護 (DEP) 以 ATL Thunk 模擬進行緩解，並針對資料夾 *C:\Apps\LOB\tests* 中稱為 *testing.exe* 的可執行檔加以緩解，並防止該可執行檔建立子進程，您可以使用下列命令：

```PowerShell
Set-ProcessMitigation -Name c:\apps\lob\tests\testing.exe -Enable DEP, EmulateAtlThunks, DisallowChildProcessCreation
```

> [!IMPORTANT]
> 以逗號分隔每個緩解選項。

如果您想要在系統層級應用 DEP，請使用下列命令：

```PowerShell
Set-Processmitigation -System -Enable DEP
```

若要停用緩解，您可以取代 `-Enable` `-Disable` 。 不過，針對應用層級的緩解，此動作只會強制停用該應用程式的緩解。

如果您需要將緩解措施還原回系統預設值，您也需要加入 `-Remove` Cmdlet，如下列範例所示：

```PowerShell
Set-Processmitigation -Name test.exe -Remove -Disable DEP
```

下表列出可搭配或 Cmdlet 參數使用) 時 (和 **審核** 的個別項緩解 `-Enable` `-Disable` 。

| 緩解類型 | 適用於 | 緩解 Cmdlet 參數關鍵字 | 稽核模式 Cmdlet 參數 |
| :-------------- | :--------- | :---------------------------------- | :-------------------------- |
| 控制流量防護 (CFG)  | 系統和應用層級 |   `CFG`,   `StrictCFG`,   `SuppressExports`  | 無法使用審計 |
| 資料執行防護 (DEP)  | 系統和應用層級 |   `DEP`,   `EmulateAtlThunks`  | 無法使用審計 |
|  (強制的 ASLR 中強制執行影像的隨機化)  | 系統和應用層級 |   `ForceRelocateImages`  | 無法使用審計 |
| 在 (自下而上的 ASLR) 隨機化記憶體分配 | 系統和應用層級 |   `BottomUp`,   `HighEntropy`  | 無法使用審計
| 驗證例外鏈 (SEHOP)  | 系統和應用層級 |   `SEHOP`,   `SEHOPTelemetry`  | 無法使用審計 |
| 驗證堆完整性 | 系統和應用層級 |   `TerminateOnError`  | 無法使用審計 |
| 任意代碼防護 (ACG)  | 僅限應用層級 |   `DynamicCode`  |   `AuditDynamicCode` |
| 封鎖低誠信影像 | 僅限應用層級 |   `BlockLowLabel`  |   `AuditImageLoad` |
| 封鎖遠端映射 | 僅限應用層級 |   `BlockRemoteImages`  | 無法使用審計 |
| 封鎖不受信任的字體 | 僅限應用層級 |   `DisableNonSystemFonts`  |   `AuditFont`,   `FontAuditOnly` |
| 程式碼整體性防護 | 僅限應用層級 |   `BlockNonMicrosoftSigned`,   `AllowStoreSigned`  |   AuditMicrosoftSigned, AuditStoreSigned |
| 停用分機點 | 僅限應用層級 |   `ExtensionPoint`  | 無法使用審計 |
| 停用 Win32k 系統通話 | 僅限應用層級 |   `DisableWin32kSystemCalls`  |   `AuditSystemCall` |
| 不允許子流程 | 僅限應用層級 |   `DisallowChildProcessCreation`  |   `AuditChildProcess` |
| 匯出位址篩選 (EAF)  | 僅限應用層級 |   `EnableExportAddressFilterPlus`、 `EnableExportAddressFilter` <a href="#r1" id="t1"> \[ 1 \] </a>   | 無法使用審核<a href="#r2" id="t2"> \[ 2 \] </a> |
| 匯入位址篩選 (IAF)  | 僅限應用層級 |   `EnableImportAddressFilter`  | 無法使用審核<a href="#r2" id="t2"> \[ 2 \] </a> |
| 模擬執行 (SimExec)  | 僅限應用層級 |   `EnableRopSimExec`  | 無法使用審核<a href="#r2" id="t2"> \[ 2 \] </a> |
| 驗證 API 呼叫 (CallerCheck)  | 僅限應用層級 |   `EnableRopCallerCheck`  | 無法使用審核<a href="#r2" id="t2"> \[ 2 \] </a> |
| 驗證控制碼使用狀況 | 僅限應用層級 |   `StrictHandle`  | 無法使用審計 |
| 驗證映射相依性完整性 | 僅限應用層級 |   `EnforceModuleDepencySigning`  | 無法使用審計 |
| 驗證堆疊整體性 (StackPivot)  | 僅限應用層級 |   `EnableRopStackPivot`  | 無法使用審核<a href="#r2" id="t2"> \[ 2 \] </a> |

<a href="#t1" id="r1"> \[ 1 \] </a>：使用下列格式為處理常式啟用 dll 的 EAF 模組：

```PowerShell
Set-ProcessMitigation -Name processName.exe -Enable EnableExportAddressFilterPlus -EAFModules dllName1.dll,dllName2.dll
```
<a href="#t2" id="r2"> \[ 2 \] </a>：無法透過 PowerShell Cmdlet 取得此緩解措施的審計。

## <a name="customize-the-notification"></a>自訂通知

如需在觸發規則和應用程式或檔案遭到封鎖時自訂通知的相關資訊，請參閱 [Windows Security](/windows/security/threat-protection/windows-defender-security-center/windows-defender-security-center)。

## <a name="see-also"></a>請參閱

- [評估 exploit protection](evaluate-exploit-protection.md)
- [設定及審核 exploit protection 緩解](customize-exploit-protection.md)
- [匯入、匯出及部署利用保護群組原則](import-export-exploit-protection-emet-xml.md)
