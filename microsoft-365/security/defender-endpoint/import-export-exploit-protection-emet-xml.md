---
title: 匯入、匯出及部署 exploit protection 設定
description: 使用群組原則來部署緩解設定。
keywords: Exploit protection，緩解，匯入，匯出，設定，轉換，轉換，部署，安裝
search.product: eADQiWindows 10XVcnh
ms.pagetype: security
ms.prod: m365-security
ms.mktglfcycl: manage
ms.sitesec: library
localization_priority: Normal
audience: ITPro
author: levinec
ms.author: ellevin
ms.reviewer: ''
manager: dansimp
ms.technology: mde
ms.openlocfilehash: ea7e894fa83ee8cadc67ebcde8ba9ff678c79832
ms.sourcegitcommit: 2a708650b7e30a53d10a2fe3164c6ed5ea37d868
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/24/2021
ms.locfileid: "51165054"
---
# <a name="import-export-and-deploy-exploit-protection-configurations"></a><span data-ttu-id="bc5ad-104">匯入、匯出及部署 exploit protection 設定</span><span class="sxs-lookup"><span data-stu-id="bc5ad-104">Import, export, and deploy exploit protection configurations</span></span>

[!INCLUDE [Microsoft 365 Defender rebranding](../../includes/microsoft-defender.md)]


<span data-ttu-id="bc5ad-105">**適用於：**</span><span class="sxs-lookup"><span data-stu-id="bc5ad-105">**Applies to:**</span></span>
- [<span data-ttu-id="bc5ad-106">適用於端點的 Microsoft Defender</span><span class="sxs-lookup"><span data-stu-id="bc5ad-106">Microsoft Defender for Endpoint</span></span>](https://go.microsoft.com/fwlink/p/?linkid=2154037)
- [<span data-ttu-id="bc5ad-107">Microsoft 365 Defender</span><span class="sxs-lookup"><span data-stu-id="bc5ad-107">Microsoft 365 Defender</span></span>](https://go.microsoft.com/fwlink/?linkid=2118804)

> <span data-ttu-id="bc5ad-108">想要體驗 Defender for Endpoint？</span><span class="sxs-lookup"><span data-stu-id="bc5ad-108">Want to experience Defender for Endpoint?</span></span> [<span data-ttu-id="bc5ad-109">註冊免費試用版。</span><span class="sxs-lookup"><span data-stu-id="bc5ad-109">Sign up for a free trial.</span></span>](https://www.microsoft.com/microsoft-365/windows/microsoft-defender-atp?ocid=docs-wdatp-exposedapis-abovefoldlink) 


<span data-ttu-id="bc5ad-110">Exploit protection 可協助保護裝置免受惡意程式碼的攻擊，利用漏洞傳播及感染。</span><span class="sxs-lookup"><span data-stu-id="bc5ad-110">Exploit protection helps protect devices from malware that use exploits to spread and infect.</span></span> <span data-ttu-id="bc5ad-111">它包含許多可在作業系統層級或個別應用層級套用的緩解。</span><span class="sxs-lookup"><span data-stu-id="bc5ad-111">It consists of a number of mitigations that can be applied at either the operating system level, or at the individual app level.</span></span>

<span data-ttu-id="bc5ad-112">您可以使用 [Windows 安全性] 應用程式或 PowerShell，建立一組稱為設定) 的緩解 (。</span><span class="sxs-lookup"><span data-stu-id="bc5ad-112">You use the Windows Security app or PowerShell to create a set of mitigations (known as a configuration).</span></span> <span data-ttu-id="bc5ad-113">然後，您可以將此設定匯出為 XML 檔案，並與網路上的多個裝置共用。</span><span class="sxs-lookup"><span data-stu-id="bc5ad-113">You can then export this configuration as an XML file and share it with multiple devices on your network.</span></span> <span data-ttu-id="bc5ad-114">然後，它們都具有相同的緩解設定集合。</span><span class="sxs-lookup"><span data-stu-id="bc5ad-114">Then, they all have the same set of mitigation settings.</span></span>

<span data-ttu-id="bc5ad-115">[評估套件](https://demo.wd.microsoft.com/Page/EP)包含範例設定檔 (名稱 *ProcessMitigation.xml* (Selfhost v4) 您可以用來查看 XML 結構的外觀。</span><span class="sxs-lookup"><span data-stu-id="bc5ad-115">The [Evaluation Package](https://demo.wd.microsoft.com/Page/EP) contains a sample configuration file (name *ProcessMitigation.xml* (Selfhost v4) you can use to see how the XML structure looks.</span></span> <span data-ttu-id="bc5ad-116">範例檔案也包含已從 [增強型緩解體驗工具 ](https://support.microsoft.com/en-us/help/2458544/the-enhanced-mitigation-experience-toolkit) 組中轉換的設定， (不再支援) 設定。</span><span class="sxs-lookup"><span data-stu-id="bc5ad-116">The sample file also contains settings that have been converted from an [Enhanced Mitigation Experience Toolkit (no longer supported)](https://support.microsoft.com/en-us/help/2458544/the-enhanced-mitigation-experience-toolkit) configuration.</span></span> <span data-ttu-id="bc5ad-117">您可以在文字編輯器中開啟檔案 (例如 [記事本]) 或直接將它匯入至 exploit protection，並複查 Windows 安全性應用程式中的設定。</span><span class="sxs-lookup"><span data-stu-id="bc5ad-117">You can open the file in a text editor (such as Notepad) or import it directly into exploit protection and review the settings in the Windows Security app.</span></span>

## <a name="create-and-export-a-configuration-file"></a><span data-ttu-id="bc5ad-118">建立及匯出設定檔</span><span class="sxs-lookup"><span data-stu-id="bc5ad-118">Create and export a configuration file</span></span>

<span data-ttu-id="bc5ad-119">匯出設定檔之前，您必須確定您有正確的設定。</span><span class="sxs-lookup"><span data-stu-id="bc5ad-119">Before you export a configuration file, you need to ensure you have the correct settings.</span></span> <span data-ttu-id="bc5ad-120">首先，在單一專用裝置上設定 exploit protection。</span><span class="sxs-lookup"><span data-stu-id="bc5ad-120">First, configure exploit protection on a single, dedicated device.</span></span> <span data-ttu-id="bc5ad-121">如需設定緩解的詳細資訊，請參閱 [自訂 exploit protection](customize-exploit-protection.md) 。</span><span class="sxs-lookup"><span data-stu-id="bc5ad-121">See [Customize exploit protection](customize-exploit-protection.md) for more information about configuring mitigations.</span></span>

<span data-ttu-id="bc5ad-122">當您已將 exploit protection 設定為您想要的狀態 (包括系統層級和應用層級緩解) 時，您可以使用 Windows 安全性應用程式或 PowerShell 匯出檔案。</span><span class="sxs-lookup"><span data-stu-id="bc5ad-122">When you've configured exploit protection to your desired state (including both system-level and app-level mitigations), you can export the file using either the Windows Security app or PowerShell.</span></span>

### <a name="use-the-windows-security-app-to-export-a-configuration-file"></a><span data-ttu-id="bc5ad-123">使用 Windows 安全性應用程式匯出設定檔</span><span class="sxs-lookup"><span data-stu-id="bc5ad-123">Use the Windows Security app to export a configuration file</span></span>

1. <span data-ttu-id="bc5ad-124">選取工作列中的盾牌圖示，以開啟 [Windows 安全性] 應用程式。</span><span class="sxs-lookup"><span data-stu-id="bc5ad-124">Open the Windows Security app by selecting the shield icon in the task bar.</span></span> <span data-ttu-id="bc5ad-125">或者，搜尋 **Defender** 的 [開始] 功能表。</span><span class="sxs-lookup"><span data-stu-id="bc5ad-125">Or, search the start menu for **Defender**.</span></span>

2. <span data-ttu-id="bc5ad-126">在左功能表列上，選取 [ **應用程式] & 瀏覽器控制項** 磚 (或 app 圖示) 然後選取 [ **Exploit protection 設定**]：</span><span class="sxs-lookup"><span data-stu-id="bc5ad-126">Select the **App & browser control** tile (or the app icon on the left menu bar) and then select **Exploit protection settings**:</span></span>

    ![醒目提示 Windows 安全性應用程式中的 Exploit protection 設定選項](/microsoft-365/security/defender-endpoint/images/wdsc-exp-prot)

3. <span data-ttu-id="bc5ad-128">在 [ **Exploit protection** ] 區段底部，選取 [ **匯出設定**]。</span><span class="sxs-lookup"><span data-stu-id="bc5ad-128">At the bottom of the **Exploit protection** section, select **Export settings**.</span></span> <span data-ttu-id="bc5ad-129">選擇您要儲存設定之 XML 檔案的位置與名稱。</span><span class="sxs-lookup"><span data-stu-id="bc5ad-129">Choose the location and name of the XML file where you want the configuration to be saved.</span></span>

    > [!IMPORTANT]
    > <span data-ttu-id="bc5ad-130">如果您想要使用預設設定，請使用設定「預設為 On」，而不要使用「) 上的預設 (」，以取得正確匯出 XML 檔案的設定。</span><span class="sxs-lookup"><span data-stu-id="bc5ad-130">If you want to use Default configuration, use the settings "On by default" instead of "Use Default (On)" to get the settings exported correctly on the XML file.</span></span>

    ![[匯出設定] 選項的醒目提示](/microsoft-365/security/defender-endpoint/images/wdsc-exp-prot-export)

    > [!NOTE]
    > <span data-ttu-id="bc5ad-132">當您匯出設定時，會儲存應用層級和系統層級緩解的所有設定。</span><span class="sxs-lookup"><span data-stu-id="bc5ad-132">When you export the settings, all settings for both app-level and system-level mitigations are saved.</span></span> <span data-ttu-id="bc5ad-133">這表示您不需要從 [ **系統設定** ] 和 [ **程式設定** ] 區段中匯出檔案，這兩種區段都會匯出所有設定。</span><span class="sxs-lookup"><span data-stu-id="bc5ad-133">This means you don't need to export a file from both the **System settings** and **Program settings** sections—either section will export all settings.</span></span>

### <a name="use-powershell-to-export-a-configuration-file"></a><span data-ttu-id="bc5ad-134">使用 PowerShell 匯出設定檔</span><span class="sxs-lookup"><span data-stu-id="bc5ad-134">Use PowerShell to export a configuration file</span></span>

1. <span data-ttu-id="bc5ad-135">在 [開始] 功能表中 **，以滑鼠** 按右鍵 [ **Windows PowerShell** ]，然後選取 [ **以系統管理員身分執行**]。</span><span class="sxs-lookup"><span data-stu-id="bc5ad-135">Type **powershell** in the Start menu, right-click **Windows PowerShell** and select **Run as administrator**.</span></span>
2. <span data-ttu-id="bc5ad-136">輸入下列 Cmdlet：</span><span class="sxs-lookup"><span data-stu-id="bc5ad-136">Enter the following cmdlet:</span></span>

    ```PowerShell
    Get-ProcessMitigation -RegistryConfigFilePath filename.xml
    ```

    <span data-ttu-id="bc5ad-137">變更 `filename` 為您所選擇的任何名稱或位置。</span><span class="sxs-lookup"><span data-stu-id="bc5ad-137">Change `filename` to any name or location of your choosing.</span></span>

    <span data-ttu-id="bc5ad-138">範例命令：</span><span class="sxs-lookup"><span data-stu-id="bc5ad-138">Example command:</span></span>

    `Get-ProcessMitigation -RegistryConfigFilePath C:\ExploitConfigfile.xml`

> [!IMPORTANT]
> <span data-ttu-id="bc5ad-139">當您使用群組原則部署設定時，所有要使用設定的裝置都必須能夠存取設定檔。</span><span class="sxs-lookup"><span data-stu-id="bc5ad-139">When you deploy the configuration using Group Policy, all devices that will use the configuration must be able to access the configuration file.</span></span> <span data-ttu-id="bc5ad-140">確定您將檔案放在共用位置。</span><span class="sxs-lookup"><span data-stu-id="bc5ad-140">Ensure you place the file in a shared location.</span></span>

## <a name="import-a-configuration-file"></a><span data-ttu-id="bc5ad-141">匯入設定檔</span><span class="sxs-lookup"><span data-stu-id="bc5ad-141">Import a configuration file</span></span>

<span data-ttu-id="bc5ad-142">您可以匯入先前建立的 exploit protection 設定檔。</span><span class="sxs-lookup"><span data-stu-id="bc5ad-142">You can import an exploit protection configuration file that you've previously created.</span></span> <span data-ttu-id="bc5ad-143">您只能使用 PowerShell 來匯入設定檔。</span><span class="sxs-lookup"><span data-stu-id="bc5ad-143">You can only use PowerShell to import the configuration file.</span></span>

<span data-ttu-id="bc5ad-144">在匯入之後，將會立即套用設定，而且可以在 Windows 安全性應用程式中加以複查。</span><span class="sxs-lookup"><span data-stu-id="bc5ad-144">After importing, the settings will be instantly applied and can be reviewed in the Windows Security app.</span></span>

### <a name="use-powershell-to-import-a-configuration-file"></a><span data-ttu-id="bc5ad-145">使用 PowerShell 匯入設定檔</span><span class="sxs-lookup"><span data-stu-id="bc5ad-145">Use PowerShell to import a configuration file</span></span>

1. <span data-ttu-id="bc5ad-146">在 [開始] 功能表中 **，以滑鼠** 按右鍵 [ **Windows PowerShell** ]，然後選取 [ **以系統管理員身分執行**]。</span><span class="sxs-lookup"><span data-stu-id="bc5ad-146">Type **powershell** in the Start menu, right-click **Windows PowerShell** and select **Run as administrator**.</span></span>
2. <span data-ttu-id="bc5ad-147">輸入下列 Cmdlet：</span><span class="sxs-lookup"><span data-stu-id="bc5ad-147">Enter the following cmdlet:</span></span>

    ```PowerShell
    Set-ProcessMitigation -PolicyFilePath filename.xml
    ```

    <span data-ttu-id="bc5ad-148">變更 `filename` 為 exploit PROTECTION XML 檔案的位置與名稱。</span><span class="sxs-lookup"><span data-stu-id="bc5ad-148">Change `filename` to the location and name of the exploit protection XML file.</span></span>

    <span data-ttu-id="bc5ad-149">範例命令：</span><span class="sxs-lookup"><span data-stu-id="bc5ad-149">Example command:</span></span>

    `Set-ProcessMitigation -PolicyFilePath C:\ExploitConfigfile.xml`

> [!IMPORTANT]
>
> <span data-ttu-id="bc5ad-150">確定您要匯入專為 exploit protection 建立的設定檔。</span><span class="sxs-lookup"><span data-stu-id="bc5ad-150">Ensure you import a configuration file that is created specifically for exploit protection.</span></span>

## <a name="manage-or-deploy-a-configuration"></a><span data-ttu-id="bc5ad-151">管理或部署設定</span><span class="sxs-lookup"><span data-stu-id="bc5ad-151">Manage or deploy a configuration</span></span>

<span data-ttu-id="bc5ad-152">您可以使用群組原則，將您建立的設定部署至網路中的多個裝置。</span><span class="sxs-lookup"><span data-stu-id="bc5ad-152">You can use Group Policy to deploy the configuration you've created to multiple devices in your network.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="bc5ad-153">當您使用群組原則部署設定時，所有要使用設定的裝置都必須能夠存取設定 XML 檔案。</span><span class="sxs-lookup"><span data-stu-id="bc5ad-153">When you deploy the configuration using Group Policy, all devices that will use the configuration must be able to access the configuration XML file.</span></span> <span data-ttu-id="bc5ad-154">確定您將檔案放在共用位置。</span><span class="sxs-lookup"><span data-stu-id="bc5ad-154">Ensure you place the file in a shared location.</span></span>

### <a name="use-group-policy-to-distribute-the-configuration"></a><span data-ttu-id="bc5ad-155">使用群組原則來散佈設定</span><span class="sxs-lookup"><span data-stu-id="bc5ad-155">Use Group Policy to distribute the configuration</span></span>

1. <span data-ttu-id="bc5ad-156">在您的群組原則管理裝置上，開啟 [群組原則管理主控台](https://docs.microsoft.com/previous-versions/windows/desktop/gpmc/group-policy-management-console-portal)，以滑鼠右鍵按一下您要設定及 **編輯** 的群組原則物件。</span><span class="sxs-lookup"><span data-stu-id="bc5ad-156">On your Group Policy management device, open the [Group Policy Management Console](https://docs.microsoft.com/previous-versions/windows/desktop/gpmc/group-policy-management-console-portal), right-click the Group Policy Object you want to configure and **Edit**.</span></span>

2. <span data-ttu-id="bc5ad-157">在 [**群組原則管理編輯器**] 中，移至 [電腦設定]，然後選取 [**系統\*\*\*\*管理範本**]。</span><span class="sxs-lookup"><span data-stu-id="bc5ad-157">In the **Group Policy Management Editor**, go to **Computer configuration** and select **Administrative templates**.</span></span>

3. <span data-ttu-id="bc5ad-158">展開樹狀目錄， 以 windows  >  **Defender 利用防護**  >  **exploit protection** 的 windows 元件。</span><span class="sxs-lookup"><span data-stu-id="bc5ad-158">Expand the tree to **Windows components** > **Windows Defender Exploit Guard** > **Exploit protection**.</span></span>

    ![Exploit protection 的群組原則設定的螢幕擷取畫面](/microsoft-365/security/defender-endpoint/images/exp-prot-gp)

4. <span data-ttu-id="bc5ad-160">按兩下 [ **使用一組通用的 Exploit protection** 設定]，並將選項設定為 [ **啟用**]。</span><span class="sxs-lookup"><span data-stu-id="bc5ad-160">Double-click **Use a common set of Exploit protection settings** and set the option to **Enabled**.</span></span>

5. <span data-ttu-id="bc5ad-161">在 [ **選項：** ] 區段中，輸入您要使用之 Exploit protection 設定檔的位置和檔案名，例如下列範例所示：</span><span class="sxs-lookup"><span data-stu-id="bc5ad-161">In the **Options:** section, enter the location and file name of the Exploit protection configuration file that you want to use, such as in the following examples:</span></span>

    * `C:\MitigationSettings\Config.XML`
    * `\\Server\Share\Config.xml`
    * `https://localhost:8080/Config.xml`
    * `C:\ExploitConfigfile.xml`

6. <span data-ttu-id="bc5ad-162">請選取 **[確定]** ，並照常 [部署更新的 GPO](https://docs.microsoft.com/windows/win32/srvnodes/group-policy)。</span><span class="sxs-lookup"><span data-stu-id="bc5ad-162">Select **OK** and [Deploy the updated GPO as you normally do](https://docs.microsoft.com/windows/win32/srvnodes/group-policy).</span></span>

## <a name="see-also"></a><span data-ttu-id="bc5ad-163">另請參閱</span><span class="sxs-lookup"><span data-stu-id="bc5ad-163">See also</span></span>

- [<span data-ttu-id="bc5ad-164">保護裝置免受攻擊</span><span class="sxs-lookup"><span data-stu-id="bc5ad-164">Protect devices from exploits</span></span>](exploit-protection.md)
- [<span data-ttu-id="bc5ad-165">評估 exploit protection</span><span class="sxs-lookup"><span data-stu-id="bc5ad-165">Evaluate exploit protection</span></span>](evaluate-exploit-protection.md)
- [<span data-ttu-id="bc5ad-166">啟用 exploit protection</span><span class="sxs-lookup"><span data-stu-id="bc5ad-166">Enable exploit protection</span></span>](enable-exploit-protection.md)
- [<span data-ttu-id="bc5ad-167">設定及審核 exploit protection 緩解</span><span class="sxs-lookup"><span data-stu-id="bc5ad-167">Configure and audit exploit protection mitigations</span></span>](customize-exploit-protection.md)
