---
title: 瞭解 Office 365 客戶機碼的可用性金鑰
ms.author: krowley
author: kccross
manager: laurawi
ms.date: 02/05/2020
audience: ITPro
ms.topic: article
ms.service: O365-seccomp
localization_priority: Normal
search.appverid:
- MET150
description: 瞭解用於復原遺失的 Office 365 客戶機碼的可用性金鑰。
ms.openlocfilehash: cb5284f46245db1d00506ab0e178244aac53a21f
ms.sourcegitcommit: 21338a9287017a66298e0ff557e80051946ebf13
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/11/2020
ms.locfileid: "42604170"
---
# <a name="learn-about-the-availability-key-for-office-365-customer-key"></a><span data-ttu-id="e3a18-103">瞭解 Office 365 客戶機碼的可用性金鑰</span><span class="sxs-lookup"><span data-stu-id="e3a18-103">Learn about the availability key for Office 365 Customer Key</span></span>

<span data-ttu-id="e3a18-104">可用性機碼是當您建立資料加密原則時，會自動產生及布建的根機碼。</span><span class="sxs-lookup"><span data-stu-id="e3a18-104">The availability key is a root key automatically generated and provisioned when you create a data encryption policy.</span></span> <span data-ttu-id="e3a18-105">Office 365 儲存及保護可用性金鑰。</span><span class="sxs-lookup"><span data-stu-id="e3a18-105">Office 365 stores and protects the availability key.</span></span> <span data-ttu-id="e3a18-106">可用性機碼的功能類似于您用來提供服務加密的兩個根機碼與客戶金鑰。</span><span class="sxs-lookup"><span data-stu-id="e3a18-106">The availability key is functionally like the two root keys that you supply for service encryption with Customer Key.</span></span> <span data-ttu-id="e3a18-107">可用性金鑰會將金鑰階層中的機碼一個層級向下回繞。</span><span class="sxs-lookup"><span data-stu-id="e3a18-107">The availability key wraps the keys one tier lower in the key hierarchy.</span></span> <span data-ttu-id="e3a18-108">不同于您在 Azure Key Vault 中提供和管理的金鑰，您無法直接存取可用性金鑰。</span><span class="sxs-lookup"><span data-stu-id="e3a18-108">Unlike the keys that you provide and manage in Azure Key Vault, you can't directly access the availability key.</span></span> <span data-ttu-id="e3a18-109">Office 365 自動化服務會以程式設計方式管理可用性金鑰。</span><span class="sxs-lookup"><span data-stu-id="e3a18-109">Office 365 automated services manage the availability key programatically.</span></span> <span data-ttu-id="e3a18-110">這些服務會啟動永不包括直接存取可用性機碼的自動作業。</span><span class="sxs-lookup"><span data-stu-id="e3a18-110">These services initiate automated operations that never involve direct access to the availability key.</span></span>

<span data-ttu-id="e3a18-111">可用性機碼的主要用途是從所管理的根機碼的未預期遺失中提供復原功能。</span><span class="sxs-lookup"><span data-stu-id="e3a18-111">The primary purpose of the availability key is to provide recovery capability from the unanticipated loss of root keys that you manage.</span></span> <span data-ttu-id="e3a18-112">遺失可能是 mismanagement 或惡意動作的結果。</span><span class="sxs-lookup"><span data-stu-id="e3a18-112">Loss could be a result of mismanagement or malicious action.</span></span> <span data-ttu-id="e3a18-113">如果您喪失根機碼的控制權，請聯繫 Microsoft 支援人員和 Microsoft，以協助您使用可用性金鑰進行復原。</span><span class="sxs-lookup"><span data-stu-id="e3a18-113">If you lose control of your root keys, contact Microsoft Support and Microsoft will assist you through the process of recovery using the availability key.</span></span> <span data-ttu-id="e3a18-114">您將使用可用性金鑰，透過您布建的新根機碼遷移至新的資料加密原則。</span><span class="sxs-lookup"><span data-stu-id="e3a18-114">You'll use the availability key to migrate to a new Data Encryption Policy with new root keys you provision.</span></span>

<span data-ttu-id="e3a18-115">可用性機碼的儲存和控制會因下列三個原因而特意不同于 Azure 金鑰保存庫機碼：</span><span class="sxs-lookup"><span data-stu-id="e3a18-115">Storage and control of the availability key are deliberately different from Azure Key Vault keys for three reasons:</span></span>

- <span data-ttu-id="e3a18-116">如果同時控制所有 Azure 金鑰保存庫機碼，可用性金鑰會提供復原「中斷玻璃」功能。</span><span class="sxs-lookup"><span data-stu-id="e3a18-116">The availability key provides a recovery, "break-glass" capability if control over both Azure Key Vault keys is lost.</span></span>
- <span data-ttu-id="e3a18-117">邏輯控制項與安全儲存位置的分離，可提供深入防護，並防止所有金鑰和您的資料遺失，也就是從單一攻擊或失敗點。</span><span class="sxs-lookup"><span data-stu-id="e3a18-117">The separation of logical controls and secure storage locations provides defense-in-depth and protects against the loss of all keys, and your data, from a single attack or point of failure.</span></span>
- <span data-ttu-id="e3a18-118">如果 Office 365 服務因暫時性錯誤而無法到達 Azure Key Vault 中主控的金鑰，可用性金鑰會提供高可用性的功能。</span><span class="sxs-lookup"><span data-stu-id="e3a18-118">The availability key provides a high-availability capability if Office 365 services are unable to reach keys hosted in Azure Key Vault due to transient errors.</span></span> <span data-ttu-id="e3a18-119">此規則只適用于 Exchange Online 和商務用 Skype 服務加密。</span><span class="sxs-lookup"><span data-stu-id="e3a18-119">This rule only applies to Exchange Online and Skype for Business service encryption.</span></span> <span data-ttu-id="e3a18-120">SharePoint Online、商務 OneDrive，以及小組檔案永遠不會使用可用性金鑰，除非您明確指示 Microsoft 啟動復原程式。</span><span class="sxs-lookup"><span data-stu-id="e3a18-120">SharePoint Online, OneDrive for Business, and Teams files never use the availability key unless you explicitly instruct Microsoft to initiate the recovery process.</span></span>

<span data-ttu-id="e3a18-121">共用責任若要保護您的資料，使用各種金鑰管理的保護和程式，最終會降低所有按鍵（因而您的資料）永久遺失或損毀的風險。</span><span class="sxs-lookup"><span data-stu-id="e3a18-121">Sharing the responsibility to protect your data, using a variety of protections and processes for key management, ultimately reduces the risk that all keys (and therefore your data) will be permanently lost or destroyed.</span></span> <span data-ttu-id="e3a18-122">當您離開服務時，Microsoft 會為您提供停用或銷毀可用性機碼的唯一授權。</span><span class="sxs-lookup"><span data-stu-id="e3a18-122">Microsoft provides you with sole authority over the disablement or destruction of the availability key when you leave the service.</span></span> <span data-ttu-id="e3a18-123">根據設計，Microsoft 沒有任何人能夠存取可用性金鑰：只有 Office 365 服務程式代碼可以存取它。</span><span class="sxs-lookup"><span data-stu-id="e3a18-123">By design, no one at Microsoft has access to the availability key: it is only accessible by Office 365 service code.</span></span>

<span data-ttu-id="e3a18-124">如需如何保護金鑰的詳細資訊，請參閱[Microsoft 信任中心](https://www.microsoft.com/trustcenter/Privacy/govt-requests-for-data)。</span><span class="sxs-lookup"><span data-stu-id="e3a18-124">See the [Microsoft Trust Center](https://www.microsoft.com/trustcenter/Privacy/govt-requests-for-data) for more information about how we secure keys.</span></span>
  
## <a name="availability-key-uses"></a><span data-ttu-id="e3a18-125">可用性金鑰使用</span><span class="sxs-lookup"><span data-stu-id="e3a18-125">Availability key uses</span></span>

<span data-ttu-id="e3a18-126">可用性機碼針對主要 vault 的外部 malefactor 或惡意擁有人員竊取控制權，或當不慎 mismanagement 導致根機碼遺失時，提供復原功能。</span><span class="sxs-lookup"><span data-stu-id="e3a18-126">The availability key provides recovery capability for scenarios in which an external malefactor or malicious insider steals control of your key vault, or when inadvertent mismanagement results in loss of root keys.</span></span> <span data-ttu-id="e3a18-127">這項修復功能適用于所有與客戶金鑰相容的 Office 365 服務。</span><span class="sxs-lookup"><span data-stu-id="e3a18-127">This recovery capability applies to all Office 365 services compatible with Customer Key.</span></span> <span data-ttu-id="e3a18-128">個別服務使用可用性金鑰的方式不同。</span><span class="sxs-lookup"><span data-stu-id="e3a18-128">Individual services use the availability key differently.</span></span> <span data-ttu-id="e3a18-129">Office 365 只會以下文所述的方式使用可用性金鑰。</span><span class="sxs-lookup"><span data-stu-id="e3a18-129">Office 365 only uses the availability key in the ways described below.</span></span>

### <a name="exchange-online-and-skype-for-business-uses"></a><span data-ttu-id="e3a18-130">Exchange Online 和商務用 Skype 使用</span><span class="sxs-lookup"><span data-stu-id="e3a18-130">Exchange Online and Skype for Business uses</span></span>

<span data-ttu-id="e3a18-131">除了復原能力之外，Exchange Online 和商務用 Skype 也會使用可用性金鑰，以確保暫時性或間歇運作問題（與存取根機碼的服務相關）中的資料可用性。</span><span class="sxs-lookup"><span data-stu-id="e3a18-131">In addition to the recovery capability, Exchange Online and Skype for Business use the availability key to ensure data availability during transient, or intermittent operational issues, related to the service accessing root keys.</span></span> <span data-ttu-id="e3a18-132">當服務因暫時性錯誤而無法到達 Azure Key Vault 中的任何客戶金鑰時，服務會自動使用可用性金鑰。</span><span class="sxs-lookup"><span data-stu-id="e3a18-132">When the service cannot reach either of your Customer Keys in Azure Key Vault due to transient errors, the service automatically uses the availability key.</span></span> <span data-ttu-id="e3a18-133">服務永不直接直接移到可用性金鑰。</span><span class="sxs-lookup"><span data-stu-id="e3a18-133">The service NEVER goes directly to the availability key.</span></span>

<span data-ttu-id="e3a18-134">Exchange Online 中的自動系統和商務用 Skype 可在暫時性錯誤期間使用可用性金鑰，以支援自動化的後端服務，例如防病毒、電子探索、資料遺失防護、信箱移動和資料索引。</span><span class="sxs-lookup"><span data-stu-id="e3a18-134">Automated systems in Exchange Online and Skype for Business may use the availability key during transient errors to support automated back-end services such as anti-virus, e-discovery, data loss prevention, mailbox moves, and data indexing.</span></span>

### <a name="sharepointonlineonedriveforbusinessandteamsfiles-uses"></a><span data-ttu-id="e3a18-135">SharePoint 線上、商務 OneDrive 及小組檔案使用</span><span class="sxs-lookup"><span data-stu-id="e3a18-135">SharePoint Online, OneDrive for Business, and Teams files uses</span></span>

<span data-ttu-id="e3a18-136">針對 SharePoint 線上 OneDrive、商務及小組檔案，可用性機碼永遠不會在復原能力之外使用，而且客戶必須明確指示 Microsoft 在復原案例中開始使用可用性金鑰。</span><span class="sxs-lookup"><span data-stu-id="e3a18-136">For SharePoint Online, OneDrive for Business, and Teams files, the availability key is NEVER used outside of the recovery capability and customers must explicitly instruct Microsoft to initiate use of the availability key during a recovery scenario.</span></span> <span data-ttu-id="e3a18-137">自動化服務作業完全依賴您在 Azure Key vault 中的客戶金鑰。</span><span class="sxs-lookup"><span data-stu-id="e3a18-137">Automated service operations solely rely on your Customer Keys in Azure Key vault.</span></span> <span data-ttu-id="e3a18-138">如需有關這些服務之重要階層如何運作的深入資訊，請參閱[SharePoint 線上、商務 OneDrive 和團隊檔案如何使用可用性金鑰](#how-sharepoint-online-onedrive-for-business-and-teams-files-use-the-availability-key)。</span><span class="sxs-lookup"><span data-stu-id="e3a18-138">For in-depth information about how the key hierarchy works for these services, see [How SharePoint Online, OneDrive for Business, and Teams files use the availability key](#how-sharepoint-online-onedrive-for-business-and-teams-files-use-the-availability-key).</span></span>

## <a name="availability-key-security"></a><span data-ttu-id="e3a18-139">可用性金鑰安全性</span><span class="sxs-lookup"><span data-stu-id="e3a18-139">Availability key security</span></span>

<span data-ttu-id="e3a18-140">Microsoft 會以您的方式具現化可用性金鑰並採取大量措施加以保護，分享資料保護的責任。</span><span class="sxs-lookup"><span data-stu-id="e3a18-140">Microsoft shares the responsibility of data protection with you by instantiating the availability key and taking extensive measures to protect it.</span></span> <span data-ttu-id="e3a18-141">Microsoft 不會公開對客戶可用性機碼的直接控制權。</span><span class="sxs-lookup"><span data-stu-id="e3a18-141">Microsoft does not expose direct control of the availability key to customers.</span></span> <span data-ttu-id="e3a18-142">例如，您可以在 Azure Key Vault 中只擲出（旋轉）您擁有的金鑰。</span><span class="sxs-lookup"><span data-stu-id="e3a18-142">For example, you can only roll (rotate) the keys that you own in Azure Key Vault.</span></span> <span data-ttu-id="e3a18-143">如需詳細資訊，請參閱[滾或輪替客戶金鑰或可用性金鑰](customer-key-availability-key-roll.md)。</span><span class="sxs-lookup"><span data-stu-id="e3a18-143">For more information, see [Roll or rotate a customer key or an availability key](customer-key-availability-key-roll.md).</span></span>

### <a name="availability-key-secret-stores"></a><span data-ttu-id="e3a18-144">可用性金鑰密碼存放區</span><span class="sxs-lookup"><span data-stu-id="e3a18-144">Availability key secret stores</span></span>

<span data-ttu-id="e3a18-145">Microsoft 會在存取控制的內部機密存放區中，像客戶對向的 Azure 重要存放庫，保護可用性金鑰。</span><span class="sxs-lookup"><span data-stu-id="e3a18-145">Microsoft protects availability keys in access-controlled, internal secret stores like the customer-facing Azure Key Vault.</span></span> <span data-ttu-id="e3a18-146">我們會執行存取控制，以防止 Microsoft 系統管理員直接存取中所含的機密。</span><span class="sxs-lookup"><span data-stu-id="e3a18-146">We implement access controls to prevent Microsoft administrators from directly accessing the secrets contained within.</span></span> <span data-ttu-id="e3a18-147">機密儲存區作業（包括金鑰輪替和刪除）會透過自動化命令進行，而這些命令永遠不會包含對可用性金鑰的直接存取權。</span><span class="sxs-lookup"><span data-stu-id="e3a18-147">Secret Store operations, including key rotation and deletion, occur through automated commands that never involve direct access to the availability key.</span></span> <span data-ttu-id="e3a18-148">機密存放區管理作業會限制在特定的工程師，並且需要透過內部工具（密碼箱）進行許可權提升。</span><span class="sxs-lookup"><span data-stu-id="e3a18-148">Secret store management operations are limited to specific engineers and require privilege escalation through an internal tool, Lockbox.</span></span> <span data-ttu-id="e3a18-149">許可權提升需要管理員核准和理由才能授與。</span><span class="sxs-lookup"><span data-stu-id="e3a18-149">Privilege escalation requires manager approval and justification prior to being granted.</span></span> <span data-ttu-id="e3a18-150">密碼箱可確保在時間到期或工程師登出時，存取受限於自動存取撤銷。</span><span class="sxs-lookup"><span data-stu-id="e3a18-150">Lockbox ensures access is time bound with automatic access revocation upon time expiration or engineer log out.</span></span>

<span data-ttu-id="e3a18-151">**Exchange online 和商務用 Skype**可用性金鑰儲存在 Exchange Online Active Directory 機密存放區中。</span><span class="sxs-lookup"><span data-stu-id="e3a18-151">**Exchange Online and Skype for Business** availability keys are stored in an Exchange Online Active Directory secret store.</span></span> <span data-ttu-id="e3a18-152">可用性機碼會安全地儲存在 Active Directory 網域控制站內租使用者特定容器內。</span><span class="sxs-lookup"><span data-stu-id="e3a18-152">Availability keys are securely stored inside tenant specific containers within the Active Directory Domain Controller.</span></span> <span data-ttu-id="e3a18-153">這種安全的儲存位置與「SharePoint 線上」、「商務 OneDrive」和「小組檔案機密」存放區分開和隔離。</span><span class="sxs-lookup"><span data-stu-id="e3a18-153">This secure storage location is separate and isolated from the SharePoint Online, OneDrive for Business, and Teams files secret store.</span></span>

<span data-ttu-id="e3a18-154">**SharePoint 線上、商務 OneDrive 及小組**檔案可用性機碼會儲存在由服務小組所管理的內部機密存放區中。</span><span class="sxs-lookup"><span data-stu-id="e3a18-154">**SharePoint Online, OneDrive for Business, and Teams files** availability keys are stored in an internal secret store managed by the service team.</span></span> <span data-ttu-id="e3a18-155">這種安全的機密儲存體服務具有前端伺服器的應用程式端點和 SQL 資料庫作為後端伺服器。</span><span class="sxs-lookup"><span data-stu-id="e3a18-155">This secured, secrets storage service has front-end servers with application endpoints and a SQL Database as the back end.</span></span> <span data-ttu-id="e3a18-156">可用性機碼是儲存在 SQL 資料庫中，而且會以機密存放區加密金鑰進行包裝（加密），以使用 AES-256 和 HMAC 的組合來加密靜態的可用性金鑰。</span><span class="sxs-lookup"><span data-stu-id="e3a18-156">Availability keys are stored in the SQL Database and are wrapped (encrypted) by secret store encryption keys that use a combination of AES-256 and HMAC to encrypt the availability key at rest.</span></span> <span data-ttu-id="e3a18-157">機密儲存區加密機碼會儲存在相同 SQL 資料庫的邏輯隔離元件中，而且會以 Microsoft 憑證授權單位單位（CA）所管理之憑證中包含的 RSA-2048 機碼進一步加密。</span><span class="sxs-lookup"><span data-stu-id="e3a18-157">The secret store encryption keys are stored in a logically isolated component of the same SQL Database and are further encrypted with RSA-2048 keys contained in certificates managed by the Microsoft certificate authority (CA).</span></span> <span data-ttu-id="e3a18-158">這些憑證會儲存在針對資料庫執行作業的機密存放區前端伺服器中。</span><span class="sxs-lookup"><span data-stu-id="e3a18-158">These certificates are stored in the secret store front-end servers that perform operations against the database.</span></span>

### <a name="defense-in-depth"></a><span data-ttu-id="e3a18-159">深入防護</span><span class="sxs-lookup"><span data-stu-id="e3a18-159">Defense-in-depth</span></span>

<span data-ttu-id="e3a18-160">Microsoft 採用縱深防禦策略，防止惡意參與者影響儲存在 Microsoft 雲端中的客戶資料的機密性、完整性或可用性。</span><span class="sxs-lookup"><span data-stu-id="e3a18-160">Microsoft employs a defense-in-depth strategy to prevent malicious actors from impacting the confidentiality, integrity, or availability of customer data stored in the Microsoft Cloud.</span></span> <span data-ttu-id="e3a18-161">實施特定的預防和偵探控制措施，以保護機密存放區和可用性機碼，作為總體安全性策略的一部分。</span><span class="sxs-lookup"><span data-stu-id="e3a18-161">Specific preventive and detective controls are implemented to protect the secret store and the availability key as part of the overarching security strategy.</span></span>

<span data-ttu-id="e3a18-162">Office 365 的建立是為了避免濫用可用性金鑰。</span><span class="sxs-lookup"><span data-stu-id="e3a18-162">Office 365 is built to prevent misuse of the availability key.</span></span> <span data-ttu-id="e3a18-163">應用層是唯一一種方法，可讓您用來加密及解密資料的索引鍵（包括可用性金鑰）。</span><span class="sxs-lookup"><span data-stu-id="e3a18-163">The application layer is the only method through which keys, including the availability key, can be used to encrypt and decrypt data.</span></span> <span data-ttu-id="e3a18-164">只有 Office 365 服務程式代碼能夠轉譯及遍歷金鑰階層，以進行加密和解密活動。</span><span class="sxs-lookup"><span data-stu-id="e3a18-164">Only Office 365 service code has the ability to interpret and traverse the key hierarchy for encryption and decryption activities.</span></span> <span data-ttu-id="e3a18-165">客戶金鑰、可用性機碼、其他階層機碼和客戶資料的儲存位置之間存在邏輯隔離。</span><span class="sxs-lookup"><span data-stu-id="e3a18-165">Logical isolation exists between the storage locations of Customer Keys, availability keys, other hierarchical keys, and customer data.</span></span> <span data-ttu-id="e3a18-166">這項隔離可降低事件中的一個或多個位置遭到破壞時，資料洩密的風險。</span><span class="sxs-lookup"><span data-stu-id="e3a18-166">This isolation mitigates the risk of data exposure in the event one or more locations are compromised.</span></span> <span data-ttu-id="e3a18-167">階層中的每一層都有內建的「全天候入侵偵測」功能，以保護儲存的資料和機密。</span><span class="sxs-lookup"><span data-stu-id="e3a18-167">Each layer in the hierarchy has built in 24x7 intrusion detection capabilities to protect data and secrets stored.</span></span>

<span data-ttu-id="e3a18-168">會執行存取控制，以防止對內部系統進行未經授權的存取，包括可用性金鑰機密存放區。</span><span class="sxs-lookup"><span data-stu-id="e3a18-168">Access controls are implemented to prevent unauthorized access to internal systems, including availability key secret stores.</span></span> <span data-ttu-id="e3a18-169">Microsoft 工程師無法直接存取可用性金鑰機密存放區。</span><span class="sxs-lookup"><span data-stu-id="e3a18-169">Microsoft engineers don't have direct access to the availability key secret stores.</span></span> <span data-ttu-id="e3a18-170">如需存取控制的其他詳細資訊，請參閱[Office 365 中的系統管理存取控制](https://docs.microsoft.com/Office365/securitycompliance/office-365-administrative-access-controls-overview)。</span><span class="sxs-lookup"><span data-stu-id="e3a18-170">For additional detail on access controls, review [Administrative Access Controls in Office 365](https://docs.microsoft.com/Office365/securitycompliance/office-365-administrative-access-controls-overview).</span></span>

<span data-ttu-id="e3a18-171">技術控制措施可防止 Microsoft 人員登入高許可權的服務帳戶，而攻擊者可能會使用這些帳戶來模擬 Office 365 服務。</span><span class="sxs-lookup"><span data-stu-id="e3a18-171">Technical controls prevent Microsoft personnel from logging into highly-privileged service accounts, which might otherwise be used by attackers to impersonate Office 365 services.</span></span> <span data-ttu-id="e3a18-172">例如，這些控制措施會防止互動式登入。</span><span class="sxs-lookup"><span data-stu-id="e3a18-172">For example, these controls prevent interactive logon.</span></span>

<span data-ttu-id="e3a18-173">安全性記錄和監視控制項是另一個防禦防護的防禦措施，可降低 Microsoft 服務和資料的風險。</span><span class="sxs-lookup"><span data-stu-id="e3a18-173">Security logging and monitoring controls are another defense-in-depth safeguard implemented that mitigate risk to Microsoft services and your data.</span></span> <span data-ttu-id="e3a18-174">Microsoft 服務小組已部署使用中監控解決方案，以產生警示和審核記錄。</span><span class="sxs-lookup"><span data-stu-id="e3a18-174">Microsoft service teams have deployed active monitoring solutions that generate alerts and audit logs.</span></span> <span data-ttu-id="e3a18-175">所有服務小組都會將其記錄上傳至中央存放庫，其中記錄會進行匯總和處理。</span><span class="sxs-lookup"><span data-stu-id="e3a18-175">All service teams upload their logs to a central repository where the logs are aggregated and processed.</span></span> <span data-ttu-id="e3a18-176">內部工具會自動檢查記錄，以確認服務是否以最佳、具彈性且安全的狀態運作。</span><span class="sxs-lookup"><span data-stu-id="e3a18-176">Internal tools automatically examine records to confirm that services are functioning in an optimal, resilient, and secure state.</span></span> <span data-ttu-id="e3a18-177">已標記不尋常的活動以進一步複查。</span><span class="sxs-lookup"><span data-stu-id="e3a18-177">Unusual activity is flagged for further review.</span></span>

<span data-ttu-id="e3a18-178">任何指出可能違反 Microsoft 安全原則的記錄事件，都會立即進入 Microsoft 安全小組的注意力。</span><span class="sxs-lookup"><span data-stu-id="e3a18-178">Any log event that indicates a potential violation of the Microsoft Security Policy is immediately brought to the attention of Microsoft security teams.</span></span> <span data-ttu-id="e3a18-179">Office 365 安全性已設定警示，以偵測嘗試存取可用性金鑰機密存放區。</span><span class="sxs-lookup"><span data-stu-id="e3a18-179">Office 365 security has configured alerts to detect attempted access to availability key secret stores.</span></span> <span data-ttu-id="e3a18-180">如果 Microsoft 人員嘗試以互動式方式登入服務帳戶，而這是由存取控制所禁止和保護的，也會產生警示。</span><span class="sxs-lookup"><span data-stu-id="e3a18-180">Alerts are also generated if Microsoft personnel attempt interactive logon to service accounts, which is prohibited and protected by access controls.</span></span> <span data-ttu-id="e3a18-181">Office 365 的安全性也會在 Office 365 服務偏離一般基準作業時，偵測和警示。</span><span class="sxs-lookup"><span data-stu-id="e3a18-181">Office 365 security also detects and alerts upon deviations of the Office 365 service from normal baseline operations.</span></span> <span data-ttu-id="e3a18-182">Malefactors 嘗試濫用 Office 365 服務會觸發警示，導致罪犯從 Microsoft cloud 環境逐出。</span><span class="sxs-lookup"><span data-stu-id="e3a18-182">Malefactors attempting to misuse Office 365 services would trigger alerts resulting in the offender's eviction from the Microsoft cloud environment.</span></span>

## <a name="use-the-availability-key-to-recover-from-key-loss"></a><span data-ttu-id="e3a18-183">使用可用性金鑰從金鑰遺失中復原</span><span class="sxs-lookup"><span data-stu-id="e3a18-183">Use the availability key to recover from key loss</span></span>

<span data-ttu-id="e3a18-184">如果您喪失客戶機碼的控制權，可用性金鑰可讓您復原和重新加密您的資料。</span><span class="sxs-lookup"><span data-stu-id="e3a18-184">If you lose control of your Customer Keys, the availability key provides you the ability to recover and re-encrypt your data.</span></span>

### <a name="recovery-procedure-for-exchange-online-and-skype-for-business"></a><span data-ttu-id="e3a18-185">Exchange Online 和商務用 Skype 的復原程式</span><span class="sxs-lookup"><span data-stu-id="e3a18-185">Recovery procedure for Exchange Online and Skype for Business</span></span>

<span data-ttu-id="e3a18-186">如果您喪失客戶機碼的控制權，可用性金鑰可讓您復原資料，並將受影響的 Office 365 資源傳回線上。</span><span class="sxs-lookup"><span data-stu-id="e3a18-186">If you lose control of your Customer Keys, the availability key gives you the capability to recover your data and bring your impacted Office 365 resources back online.</span></span> <span data-ttu-id="e3a18-187">當您復原時，可用性機碼會繼續保護您的資料。在高層次上，若要完全從金鑰遺失中復原，您必須建立新的 DEP，並將受影響的資源移至新的原則。</span><span class="sxs-lookup"><span data-stu-id="e3a18-187">The availability key continues to protect your data while you recover.At a high level, to fully recover from key loss, you'll need to create a new DEP and move impacted resources to the new policy.</span></span>

<span data-ttu-id="e3a18-188">若要使用新的客戶金鑰來加密您的資料，請在 Azure Key Vault 中建立新的金鑰，使用新的客戶機碼建立新的 DEP，然後將新的 DEP 指派給目前使用舊 DEP （金鑰已遺失或損毀）加密的信箱。</span><span class="sxs-lookup"><span data-stu-id="e3a18-188">To encrypt your data with new Customer Keys, create new keys in Azure Key Vault, create a new DEP using the new Customer Keys, then assign the new DEP to the mailboxes currently encrypted with the previous DEP for which the keys were lost or compromised.</span></span>

<span data-ttu-id="e3a18-189">這種重新加密處理常式可能需要長達72小時。</span><span class="sxs-lookup"><span data-stu-id="e3a18-189">This re-encryption process can take up to 72 hours.</span></span> <span data-ttu-id="e3a18-190">當您變更 DEP 時，這是標準持續時間。</span><span class="sxs-lookup"><span data-stu-id="e3a18-190">This is the standard duration when you change a DEP.</span></span>
  
### <a name="recovery-procedure-for-sharepointonlineonedriveforbusinessandteamsfiles"></a><span data-ttu-id="e3a18-191">SharePoint 線上、商務 OneDrive 及小組檔案的復原程式</span><span class="sxs-lookup"><span data-stu-id="e3a18-191">Recovery procedure for SharePoint Online, OneDrive for Business, and Teams files</span></span>

<span data-ttu-id="e3a18-192">針對 SharePoint 線上、商務用 OneDrive 與小組檔案，可用性機碼永遠不會在復原能力以外使用。</span><span class="sxs-lookup"><span data-stu-id="e3a18-192">For SharePoint Online, OneDrive for Business, and Teams files, the availability key is NEVER used outside of the recovery capability.</span></span> <span data-ttu-id="e3a18-193">您必須明確指示 Microsoft 在復原案例中開始使用可用性金鑰。</span><span class="sxs-lookup"><span data-stu-id="e3a18-193">You must explicitly instruct Microsoft to initiate use of the availability key during a recovery scenario.</span></span> <span data-ttu-id="e3a18-194">若要啟動修復程式，請與 Microsoft 聯繫以啟用可用性金鑰。</span><span class="sxs-lookup"><span data-stu-id="e3a18-194">To initiate the recovery process, contact Microsoft to activate the availability key.</span></span> <span data-ttu-id="e3a18-195">一旦啟用，可用性金鑰即會自動用於解密您的資料，讓您可以使用新建立的 DEP （與新的客戶機碼相關聯）來加密資料。</span><span class="sxs-lookup"><span data-stu-id="e3a18-195">Once activated, the availability key is automatically used to decrypt your data allowing you to encrypt the data with a newly-created DEP associated to new Customer Keys.</span></span>  

<span data-ttu-id="e3a18-196">此作業與您組織中的網站數目成正比。</span><span class="sxs-lookup"><span data-stu-id="e3a18-196">This operation is proportional to the number of sites in your organization.</span></span> <span data-ttu-id="e3a18-197">一旦您呼叫 Microsoft 使用可用性金鑰，您應該在大約四小時內完全線上。</span><span class="sxs-lookup"><span data-stu-id="e3a18-197">Once you call Microsoft to use the availability key, you should be fully online within about four hours.</span></span>

## <a name="how-exchange-online-and-skype-for-business-use-the-availability-key"></a><span data-ttu-id="e3a18-198">Exchange Online 和商務用 Skype 如何使用可用性金鑰</span><span class="sxs-lookup"><span data-stu-id="e3a18-198">How Exchange Online and Skype for Business use the availability key</span></span>

<span data-ttu-id="e3a18-199">當您使用客戶金鑰建立 DEP 時，Office 365 會產生與該 DEP 相關聯的資料加密原則機碼（DEP 金鑰）。</span><span class="sxs-lookup"><span data-stu-id="e3a18-199">When you create a DEP with Customer Key, Office 365 generates a Data Encryption Policy Key (DEP Key) associated with that DEP.</span></span> <span data-ttu-id="e3a18-200">服務會將 DEP 機碼加密三次：一次使用每個客戶機碼，然後使用可用性金鑰。</span><span class="sxs-lookup"><span data-stu-id="e3a18-200">The service encrypts the DEP Key three times: once with each of the customer keys and once with the availability key.</span></span> <span data-ttu-id="e3a18-201">只會儲存加密版本的 DEP 機碼，而且 DEP 機碼只能使用客戶機碼或可用性金鑰解密。</span><span class="sxs-lookup"><span data-stu-id="e3a18-201">Only the encrypted versions of the DEP Key are stored, and a DEP Key can only be decrypted with the customer keys or the availability key.</span></span> <span data-ttu-id="e3a18-202">然後，使用 DEP 機碼加密個別信箱的信箱金鑰。</span><span class="sxs-lookup"><span data-stu-id="e3a18-202">The DEP Key is then used to encrypt Mailbox Keys, which encrypt individual mailboxes.</span></span>
  
<span data-ttu-id="e3a18-203">當客戶使用此服務時，Office 365 會遵循此程式來解密及提供資料：</span><span class="sxs-lookup"><span data-stu-id="e3a18-203">Office 365 follows this process to decrypt and provide data when customers are using the service:</span></span>
  
1. <span data-ttu-id="e3a18-204">使用客戶金鑰解密 DEP 金鑰。</span><span class="sxs-lookup"><span data-stu-id="e3a18-204">Decrypt the DEP Key using the Customer Key.</span></span>

2. <span data-ttu-id="e3a18-205">使用解密的 DEP 金鑰來解密信箱金鑰。</span><span class="sxs-lookup"><span data-stu-id="e3a18-205">Use the decrypted DEP Key to decrypt a Mailbox Key.</span></span>

3. <span data-ttu-id="e3a18-206">使用解密的信箱金鑰來解密信箱本身，讓您可以存取信箱內的資料。</span><span class="sxs-lookup"><span data-stu-id="e3a18-206">Use the decrypted Mailbox Key to decrypt the mailbox itself, allowing you to access the data within the mailbox.</span></span>

## <a name="how-sharepoint-online-onedrive-for-business-and-teams-files-use-the-availability-key"></a><span data-ttu-id="e3a18-207">SharePoint 線上、商務 OneDrive 及小組檔如何使用可用性金鑰</span><span class="sxs-lookup"><span data-stu-id="e3a18-207">How SharePoint Online, OneDrive for Business, and Teams files use the availability key</span></span>

<span data-ttu-id="e3a18-208">SharePoint 線上和商務 OneDrive 客戶金鑰和可用性金鑰的實施，與 Exchange Online 和商務用 Skype 不同。</span><span class="sxs-lookup"><span data-stu-id="e3a18-208">The SharePoint Online and OneDrive for Business architecture and implementation for Customer Key and availability key are different from Exchange Online and Skype for Business.</span></span>
  
<span data-ttu-id="e3a18-209">當組織移至客戶管理的金鑰時，Office 365 會建立租使用者特定的中間機碼（TIK）。</span><span class="sxs-lookup"><span data-stu-id="e3a18-209">When an organization moves to customer-managed keys, Office 365 creates a tenant-specific intermediate key (TIK).</span></span> <span data-ttu-id="e3a18-210">Office 365 會將 TIK 加密兩次（使用每個客戶機碼一次），然後儲存 TIK 的兩個加密版本。</span><span class="sxs-lookup"><span data-stu-id="e3a18-210">Office 365 encrypts the TIK twice, once with each of the customer keys, and stores the two encrypted versions of the TIK.</span></span> <span data-ttu-id="e3a18-211">只會儲存 TIK 的加密版本，且只能使用客戶機碼解密 TIK。</span><span class="sxs-lookup"><span data-stu-id="e3a18-211">Only the encrypted versions of the TIK are stored, and a TIK can only be decrypted with the customer keys.</span></span> <span data-ttu-id="e3a18-212">然後，TIK 用來加密網站機碼，然後用來加密 blob 金鑰（也稱為「檔案區塊金鑰」）。</span><span class="sxs-lookup"><span data-stu-id="e3a18-212">The TIK is then used to encrypt site keys, which are then used to encrypt blob keys (also called file chunk keys).</span></span> <span data-ttu-id="e3a18-213">根據檔案大小，服務可以使用唯一金鑰將檔案分割成多個檔區塊。</span><span class="sxs-lookup"><span data-stu-id="e3a18-213">Depending on file size, the service may split a file into multiple file chunks each with a unique key.</span></span> <span data-ttu-id="e3a18-214">Blob （檔區塊）本身會以 blob 金鑰加密，並儲存在 Microsoft Azure Blob 儲存服務中。</span><span class="sxs-lookup"><span data-stu-id="e3a18-214">The blobs (file chunks) themselves are encrypted with the blob keys and stored in the Microsoft Azure Blob storage service.</span></span>
  
<span data-ttu-id="e3a18-215">當客戶使用此服務時，Office 365 會遵循此程式來解密及提供客戶檔案：</span><span class="sxs-lookup"><span data-stu-id="e3a18-215">Office 365 follows this process to decrypt and provide customer files when customers are using the service:</span></span>

1. <span data-ttu-id="e3a18-216">使用客戶金鑰組 TIK 進行解密。</span><span class="sxs-lookup"><span data-stu-id="e3a18-216">Decrypt the TIK using the Customer Key.</span></span>

2. <span data-ttu-id="e3a18-217">使用解密的 TIK 來解密網站金鑰。</span><span class="sxs-lookup"><span data-stu-id="e3a18-217">Use the decrypted TIK to decrypt a site key.</span></span>

3. <span data-ttu-id="e3a18-218">使用解密的網站金鑰來解密 blob 金鑰。</span><span class="sxs-lookup"><span data-stu-id="e3a18-218">Use the decrypted site key to decrypt a blob key.</span></span>

4. <span data-ttu-id="e3a18-219">使用解密的 blob 金鑰來解密 blob。</span><span class="sxs-lookup"><span data-stu-id="e3a18-219">Use the decrypted blob key to decrypt the blob.</span></span>

<span data-ttu-id="e3a18-220">Office 365 會以輕微位移的方式發出兩個解密要求到 Azure Key Vault，解密 TIK。</span><span class="sxs-lookup"><span data-stu-id="e3a18-220">Office 365 decrypts a TIK by issuing two decryption requests to Azure Key Vault with a slight offset.</span></span> <span data-ttu-id="e3a18-221">Furnishes 結果的第一個，請取消其他要求。</span><span class="sxs-lookup"><span data-stu-id="e3a18-221">The first one to finish furnishes the result, canceling the other request.</span></span>
  
<span data-ttu-id="e3a18-222">當您喪失客戶金鑰的存取權時，Office 365 也會使用可用性金鑰來加密 TIK，並將其與使用每個客戶金鑰加密的 TIKs 一起儲存。</span><span class="sxs-lookup"><span data-stu-id="e3a18-222">In case you lose access to your customer keys, Office 365 also encrypts the TIK with an availability key and stores this along with the TIKs encrypted with each customer key.</span></span> <span data-ttu-id="e3a18-223">只有當客戶呼叫 Microsoft 以在存取其機碼失敗時（惡意或無意）存取其金鑰時，才會使用以可用性金鑰加密的 TIK。</span><span class="sxs-lookup"><span data-stu-id="e3a18-223">The TIK encrypted with the availability key is used only when the customer calls Microsoft to enlist the recovery path when they have lost access to their keys, maliciously or accidentally.</span></span>
  
<span data-ttu-id="e3a18-224">出於可用性與縮放原因，已解密的 TIKs 會在一個時段有限的記憶體快取中快取。</span><span class="sxs-lookup"><span data-stu-id="e3a18-224">For availability and scale reasons, decrypted TIKs are cached in a time-limited memory cache.</span></span> <span data-ttu-id="e3a18-225">在 TIK 快取設定為過期前的兩個小時，Office 365 會嘗試解密每個 TIK。</span><span class="sxs-lookup"><span data-stu-id="e3a18-225">Two hours before a TIK cache is set to expire, Office 365 attempts to decrypt each TIK.</span></span> <span data-ttu-id="e3a18-226">解密 TIKs 會延伸快取的存留期。</span><span class="sxs-lookup"><span data-stu-id="e3a18-226">Decrypting the TIKs extends the lifetime of the cache.</span></span> <span data-ttu-id="e3a18-227">如果 TIK 解密失敗很長一段時間，Office 365 會產生警示，以在快取到期之前通知工程。</span><span class="sxs-lookup"><span data-stu-id="e3a18-227">If TIK decryption fails for a significant amount of time, Office 365 generates an alert to notify engineering prior to the cache expiration.</span></span> <span data-ttu-id="e3a18-228">只有在客戶撥打 Microsoft 時，Office 365 才會啟動復原作業，此作業需要使用儲存在 Microsoft 機密存放區中的可用性金鑰來解密 TIK，然後再使用解密的 TIK 及一組新的客戶提供的 Azure 金鑰保存庫金鑰。</span><span class="sxs-lookup"><span data-stu-id="e3a18-228">Only if the customer calls Microsoft will Office 365 initiate the recovery operation, which involves decrypting the TIK with the availability key stored in Microsoft's secret store and onboarding the tenant again using the decrypted TIK and a new set of customer-supplied Azure Key Vault keys.</span></span>
  
<span data-ttu-id="e3a18-229">到目前為止，客戶金鑰會包含在 Azure blob 儲存區中儲存的 SharePoint 線上檔案資料的加密和解密鏈，但不會 SharePoint 線上清單專案或儲存在 SQL 資料庫中的中繼資料。</span><span class="sxs-lookup"><span data-stu-id="e3a18-229">As of today, Customer Key is involved in the encryption and decryption chain of SharePoint Online file data stored in the Azure blob store, but not SharePoint Online list items or metadata stored in the SQL Database.</span></span> <span data-ttu-id="e3a18-230">Office 365 不會將可用性金鑰用於 Exchange Online、商務用 Skype、SharePoint Online、商務用 OneDrive，而不是上述案例所述（由客戶發起）。</span><span class="sxs-lookup"><span data-stu-id="e3a18-230">Office 365 does not use the availability key for Exchange Online, Skype for Business, SharePoint Online, OneDrive for Business, and Teams files other than the case described above, which is customer-initiated.</span></span> <span data-ttu-id="e3a18-231">客戶資料的人員存取受到客戶資料箱的保護。</span><span class="sxs-lookup"><span data-stu-id="e3a18-231">Human access to customer data is protected by Customer Lockbox.</span></span>

## <a name="availability-key-triggers"></a><span data-ttu-id="e3a18-232">可用性機碼觸發器</span><span class="sxs-lookup"><span data-stu-id="e3a18-232">Availability key triggers</span></span>

<span data-ttu-id="e3a18-233">Office 365 只會在特定情況下觸發可用性金鑰。</span><span class="sxs-lookup"><span data-stu-id="e3a18-233">Office 365 triggers the availability key only in specific circumstances.</span></span> <span data-ttu-id="e3a18-234">這些情況會因服務而有所不同。</span><span class="sxs-lookup"><span data-stu-id="e3a18-234">These circumstances differ by service.</span></span>

### <a name="triggers-for-exchange-online-and-skype-for-business"></a><span data-ttu-id="e3a18-235">Exchange Online 和商務用 Skype 的觸發器</span><span class="sxs-lookup"><span data-stu-id="e3a18-235">Triggers for Exchange Online and Skype for Business</span></span>
  
1. <span data-ttu-id="e3a18-236">Office 365 會讀取信箱所指派的 DEP，以便決定 Azure Key Vault 中的兩個客戶機碼的位置。</span><span class="sxs-lookup"><span data-stu-id="e3a18-236">Office 365 reads the DEP to which the mailbox is assigned in order to determine the location of the two Customer Keys in Azure Key Vault.</span></span>

2. <span data-ttu-id="e3a18-237">Office 365 會隨機從 DEP 選擇兩個客戶機碼的其中一個，並將要求傳送至 Azure 金鑰 Vault，以使用客戶金鑰解對 DEP 金鑰。</span><span class="sxs-lookup"><span data-stu-id="e3a18-237">Office 365 randomly chooses one of the two Customer Keys from the DEP and sends a request to Azure Key Vault to unwrap the DEP key using the Customer Key.</span></span>

3. <span data-ttu-id="e3a18-238">如果使用客戶金鑰解包 DEP 金鑰的要求失敗，Office 365 會傳送第二個要求到 Azure Key Vault，這次是用來指示其使用備用（第二）客戶金鑰。</span><span class="sxs-lookup"><span data-stu-id="e3a18-238">If the request to unwrap the DEP key using the Customer Key fails, Office 365 sends a second request to Azure Key Vault, this time instructing it to use the alternate (second) Customer Key.</span></span>

4. <span data-ttu-id="e3a18-239">如果第二個要求使用客戶機碼解對 DEP 機碼的要求失敗，Office 365 會檢查這兩個要求的結果。</span><span class="sxs-lookup"><span data-stu-id="e3a18-239">If the second request to unwrap the DEP key using the Customer Key fails, Office 365 examines the results of both requests.</span></span>

    - <span data-ttu-id="e3a18-240">如果檢查會判斷傳回系統錯誤失敗的要求：</span><span class="sxs-lookup"><span data-stu-id="e3a18-240">If the examination determines that the requests failed returning a system ERROR:</span></span>

       - <span data-ttu-id="e3a18-241">Office 365 會觸發可用性金鑰來解密 DEP 機碼。</span><span class="sxs-lookup"><span data-stu-id="e3a18-241">Office 365 triggers the availability key to decrypt the DEP key.</span></span>

       - <span data-ttu-id="e3a18-242">然後，Office 365 會使用 DEP 金鑰來解密信箱機碼，並完成使用者要求。</span><span class="sxs-lookup"><span data-stu-id="e3a18-242">Office 365 then uses the DEP key to decrypt the mailbox key and complete the user request.</span></span> 

       - <span data-ttu-id="e3a18-243">在此情況下，Azure Key Vault 可能由於暫時性錯誤而無法回應或無法存取。</span><span class="sxs-lookup"><span data-stu-id="e3a18-243">In this case, Azure Key Vault is either unable to respond or unreachable due to a transient ERROR.</span></span>

    - <span data-ttu-id="e3a18-244">如果考試判斷傳回拒絕存取失敗的要求：</span><span class="sxs-lookup"><span data-stu-id="e3a18-244">If the examination determines that the requests failed returning ACCESS DENIED:</span></span>

       - <span data-ttu-id="e3a18-245">這表示故意、無意或惡意的動作可將客戶機碼轉譯成不可用（例如，在離開服務的情況下，在資料清除程式期間）。</span><span class="sxs-lookup"><span data-stu-id="e3a18-245">This means deliberate, inadvertent, or malicious action has been taken to render the customer keys unavailable (for example, during the data purge process as part of leaving the service).</span></span>

       - <span data-ttu-id="e3a18-246">在此情況下，可用性金鑰只會用於系統動作，而不適用於使用者動作，使用者要求會失敗，且使用者會收到錯誤訊息。</span><span class="sxs-lookup"><span data-stu-id="e3a18-246">In this case, the availability key will be used only for system actions and not for user actions, the user request fails, and the user receives an error message.</span></span>

>[!IMPORTANT]
><span data-ttu-id="e3a18-247">Office 365 服務程式代碼永遠都具有有效的登入權杖，以用於透過客戶資料提供增值雲端服務。</span><span class="sxs-lookup"><span data-stu-id="e3a18-247">Office 365 service code always has a valid login token for reasoning over customer data to provide value-adding cloud services.</span></span> <span data-ttu-id="e3a18-248">因此，在刪除可用性機碼之前，可將其當作 Exchange Online 及內部的 Exchange Online 和商務用 Skype （如搜尋索引建立或移動信箱）所啟動的動作，用作 fallback。</span><span class="sxs-lookup"><span data-stu-id="e3a18-248">Therefore, until the availability key has been deleted, it can be used as a fallback for actions initiated by, or internal to, Exchange Online and Skype for Business such as search index creation or moving mailboxes.</span></span> <span data-ttu-id="e3a18-249">這同時適用于暫時性錯誤和存取 Azure Key Vault 的拒絕要求。</span><span class="sxs-lookup"><span data-stu-id="e3a18-249">This applies to both transient ERRORS and ACCESS DENIED requests to Azure Key Vault.</span></span>

### <a name="triggers-for-sharepoint-online-onedrive-for-business-and-teams-files"></a><span data-ttu-id="e3a18-250">SharePoint 線上、商務 OneDrive 及小組檔案的觸發器</span><span class="sxs-lookup"><span data-stu-id="e3a18-250">Triggers for SharePoint Online, OneDrive for Business, and Teams files</span></span>

<span data-ttu-id="e3a18-251">針對 SharePoint 線上 OneDrive、商務及小組檔案，可用性機碼永遠不會在復原能力之外使用，而且客戶必須明確指示 Microsoft 在復原案例中開始使用可用性金鑰。</span><span class="sxs-lookup"><span data-stu-id="e3a18-251">For SharePoint Online, OneDrive for Business, and Teams files, the availability key is NEVER used outside of the recovery capability and customers must explicitly instruct Microsoft to initiate use of the availability key during a recovery scenario.</span></span>

## <a name="audit-logs-and-the-availability-key"></a><span data-ttu-id="e3a18-252">審核記錄和可用性金鑰</span><span class="sxs-lookup"><span data-stu-id="e3a18-252">Audit logs and the availability key</span></span>

<span data-ttu-id="e3a18-253">Office 365 中的自動化系統處理所有的資料，以提供雲端服務（例如，反病毒、電子探索、資料遺失防護和資料索引）。</span><span class="sxs-lookup"><span data-stu-id="e3a18-253">Automated systems in Office 365 process all data as it flows through the system to provide cloud services, for example, anti-virus, e-discovery, data loss prevention, and data indexing.</span></span> <span data-ttu-id="e3a18-254">Office 365 不會產生此活動的客戶可見記錄檔。</span><span class="sxs-lookup"><span data-stu-id="e3a18-254">Office 365 does not generate customer-visible logs for this activity.</span></span> <span data-ttu-id="e3a18-255">此外，Microsoft 人員不會在這些一般系統作業中存取您的資料。</span><span class="sxs-lookup"><span data-stu-id="e3a18-255">In addition, Microsoft personnel do not access your data as part of these normal system operations.</span></span>

### <a name="exchange-online-and-skype-for-business-availability-key-logging"></a><span data-ttu-id="e3a18-256">Exchange Online 和商務用 Skype 可用性機碼記錄</span><span class="sxs-lookup"><span data-stu-id="e3a18-256">Exchange Online and Skype for Business availability key logging</span></span>

<span data-ttu-id="e3a18-257">當 Exchange Online 和商務用 Skype 存取可用性機碼以提供服務時，office 365 會發佈可從安全與合規性中心存取之用戶端可見記錄。</span><span class="sxs-lookup"><span data-stu-id="e3a18-257">When Exchange Online and Skype for Business accesses availability key to provide service, office 365 publishes customer-visible logs accessible from the Security and Compliance Center.</span></span> <span data-ttu-id="e3a18-258">每當服務使用可用性金鑰時，就會產生可用性機碼作業的審計記錄記錄。</span><span class="sxs-lookup"><span data-stu-id="e3a18-258">An audit log record for the availability key operation is generated each time the service uses the availability key.</span></span> <span data-ttu-id="e3a18-259">名為 "Customer Key Service Encryption" 的新記錄類型，其 activity type "Fallback to Availability Key" 可讓系統管理員篩選[整合的審計記錄](https://docs.microsoft.com/microsoft-365/compliance/search-the-audit-log-in-security-and-compliance)搜尋結果，以查看可用性機碼記錄。</span><span class="sxs-lookup"><span data-stu-id="e3a18-259">A new record type called “Customer Key Service Encryption” with activity type "Fallback to Availability Key" allows admins to filter [Unified Audit Log](https://docs.microsoft.com/microsoft-365/compliance/search-the-audit-log-in-security-and-compliance) search results to view availability key records.</span></span>

<span data-ttu-id="e3a18-260">記錄檔包含諸如日期、時間、活動、組織識別碼及資料加密原則識別碼等屬性。</span><span class="sxs-lookup"><span data-stu-id="e3a18-260">Log records include attributes such as date, time, activity, organization ID, and data encryption policy ID.</span></span> <span data-ttu-id="e3a18-261">該記錄可作為 Office 365 整合的審計記錄檔的一部分，且可從 Office 365 安全性與合規性中心的 [審核記錄檔搜尋] 索引標籤進行存取。</span><span class="sxs-lookup"><span data-stu-id="e3a18-261">The record is available as part of Office 365 Unified Audit Logs and is accessible from the Office 365 Security and Compliance Center Audit Log Search tab.</span></span>

![可用性機碼事件的審計記錄搜尋](../media/customerkeyauditlogsearchavailabilitykeyloggingimage.png)

<span data-ttu-id="e3a18-263">Exchange Online 和商務用 Skype 可用性機碼記錄使用具有新增自訂參數的 Office 365 管理活動[通用架構](https://docs.microsoft.com/office/office-365-management-api/office-365-management-activity-api-schema#common-schema)： Policy Id、範圍鍵版本識別碼和要求識別碼。</span><span class="sxs-lookup"><span data-stu-id="e3a18-263">Exchange Online and Skype for Business availability key records use the Office 365 Management Activity [common schema](https://docs.microsoft.com/office/office-365-management-api/office-365-management-activity-api-schema#common-schema) with added custom parameters: Policy Id, Scope Key Version Id, and Request Id.</span></span>

![可用性機碼自訂參數](../media/customerkeyauditlogsearchavailabilitykeyloggingcustomparam.png)

### <a name="sharepoint-online-onedrive-for-business-and-teams-files-availability-key-logging"></a><span data-ttu-id="e3a18-265">SharePoint 線上、商務 OneDrive 和團隊檔案可用性機碼記錄</span><span class="sxs-lookup"><span data-stu-id="e3a18-265">SharePoint Online, OneDrive for Business, and Teams files availability key logging</span></span>

<span data-ttu-id="e3a18-266">可用性機碼記錄尚未提供這些服務。</span><span class="sxs-lookup"><span data-stu-id="e3a18-266">Availability key logging isn't available yet for these services.</span></span> <span data-ttu-id="e3a18-267">針對 SharePoint 線上、商務及小組檔案的 OneDrive，可用性機碼只會在由您指示時由 Microsoft 啟動，以供復原之用。</span><span class="sxs-lookup"><span data-stu-id="e3a18-267">For SharePoint Online, OneDrive for Business, and Teams files, the availability key is only activated by Microsoft, when instructed by you, for recovery purposes.</span></span> <span data-ttu-id="e3a18-268">因此，您已知道每個可用於這些服務之可用性金鑰的事件。</span><span class="sxs-lookup"><span data-stu-id="e3a18-268">As a result, you already know every event in which the availability key is used for these services.</span></span>

## <a name="availability-key-in-the-customer-key-hierarchy"></a><span data-ttu-id="e3a18-269">客戶金鑰階層中的可用性金鑰</span><span class="sxs-lookup"><span data-stu-id="e3a18-269">Availability key in the Customer Key hierarchy</span></span>
  
<span data-ttu-id="e3a18-270">Office 365 會使用可用性金鑰來包裝為客戶金鑰服務加密所建立之金鑰階層中的小按鍵層級。</span><span class="sxs-lookup"><span data-stu-id="e3a18-270">Office 365 uses the availability key to wrap the tier of keys lower in the key hierarchy established for Customer Key service encryption.</span></span> <span data-ttu-id="e3a18-271">服務之間存在不同的主要階層。</span><span class="sxs-lookup"><span data-stu-id="e3a18-271">Different key hierarchies exist between services.</span></span> <span data-ttu-id="e3a18-272">金鑰演算法也會在每個適用服務階層中的可用性機碼和其他機碼之間有所不同。</span><span class="sxs-lookup"><span data-stu-id="e3a18-272">Key algorithms also differ between availability keys and other keys in the hierarchy of each applicable service.</span></span> <span data-ttu-id="e3a18-273">不同服務使用的可用性金鑰演算法如下：</span><span class="sxs-lookup"><span data-stu-id="e3a18-273">The availability key algorithms used by the different services are as follows:</span></span>

- <span data-ttu-id="e3a18-274">Exchange Online 和商務用 Skype 可用性金鑰使用 AES-256。</span><span class="sxs-lookup"><span data-stu-id="e3a18-274">The Exchange Online and Skype for Business availability keys use AES-256.</span></span>

- <span data-ttu-id="e3a18-275">SharePoint 線上、商務 OneDrive 和團隊檔案可用性機碼使用 RSA-2048。</span><span class="sxs-lookup"><span data-stu-id="e3a18-275">The SharePoint Online, OneDrive for Business, and Teams files availability keys use RSA-2048.</span></span>

### <a name="encryption-ciphers-used-to-encrypt-keys-for-exchange-online-and-skype-for-business"></a><span data-ttu-id="e3a18-276">加密密碼，用來加密 Exchange Online 和商務用 Skype 的金鑰</span><span class="sxs-lookup"><span data-stu-id="e3a18-276">Encryption ciphers used to encrypt keys for Exchange Online and Skype for Business</span></span>

![Exchange Online 客戶機碼的加密密碼](../media/customerkeyencryptionhierarchiesexchangeskype.png)

### <a name="encryption-ciphers-used-to-encrypt-keys-for-sharepoint-online-and-onedrive-for-business"></a><span data-ttu-id="e3a18-278">用來加密 SharePoint 線上和商務 OneDrive 的金鑰的加密密碼</span><span class="sxs-lookup"><span data-stu-id="e3a18-278">Encryption ciphers used to encrypt keys for SharePoint Online and OneDrive for Business</span></span>

![SharePoint Online 客戶機碼的加密密碼](../media/customerkeyencryptionhierarchiessharepointonedriveteamsfiles.png)

## <a name="related-articles"></a><span data-ttu-id="e3a18-280">相關文章</span><span class="sxs-lookup"><span data-stu-id="e3a18-280">Related articles</span></span>

- [<span data-ttu-id="e3a18-281">使用 Office 365 的客戶金鑰服務加密</span><span class="sxs-lookup"><span data-stu-id="e3a18-281">Service encryption with Customer Key for Office 365</span></span>](customer-key-overview.md)

- [<span data-ttu-id="e3a18-282">設定 Office 365 的客戶金鑰</span><span class="sxs-lookup"><span data-stu-id="e3a18-282">Set up Customer Key for Office 365</span></span>](customer-key-set-up.md)

- [<span data-ttu-id="e3a18-283">管理 Office 365 的客戶金鑰</span><span class="sxs-lookup"><span data-stu-id="e3a18-283">Manage Customer Key for Office 365</span></span>](customer-key-manage.md)

- [<span data-ttu-id="e3a18-284">滾動或輪替客戶金鑰或可用性金鑰</span><span class="sxs-lookup"><span data-stu-id="e3a18-284">Roll or rotate a Customer Key or an availability key</span></span>](customer-key-availability-key-roll.md)
