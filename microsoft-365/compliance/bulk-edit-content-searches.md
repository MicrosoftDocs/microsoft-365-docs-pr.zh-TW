---
title: 大量編輯內容搜尋
f1.keywords:
- NOCSH
ms.author: markjjo
author: markjjo
manager: laurawi
ms.date: 12/29/2016
audience: Admin
ms.topic: article
ms.service: O365-seccomp
localization_priority: Normal
search.appverid:
- MOE150
- MET150
ms.assetid: 39e4654a-9588-41f6-892b-c33ab57bfbe2
ms.custom:
- seo-marvel-apr2020
description: 在安全性與合規性中心使用大量搜尋編輯器，快速變更一或多個內容搜尋的查詢和內容位置。
ms.openlocfilehash: 2bbe8248a82356a217557469b6639e28607be13e
ms.sourcegitcommit: a45cf8b887587a1810caf9afa354638e68ec5243
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 05/05/2020
ms.locfileid: "44035521"
---
# <a name="bulk-edit-content-searches"></a>大量編輯內容搜尋

您可以使用內容搜尋工具中的大量搜尋編輯器同時編輯多個搜尋。 使用此工具可讓您快速變更一或多個搜尋的查詢和內容位置。 然後，您可以重新執行搜尋並取得修改的搜尋的新預計搜尋結果。 編輯器也可讓您從 Microsoft Excel 檔案或文本檔案複製及貼上查詢和內容位置。 這表示您可以使用「搜尋統計資料」工具來查看一或多個搜尋的統計資料，將統計資料匯出至 CSV 檔案，您可以在其中編輯 Excel 中的查詢和內容位置。 然後，您可以使用大量搜尋編輯器，將修改過的查詢和內容位置新增至搜尋。 在您修訂一或多個搜尋之後，您可以重新開機並取得新的預估搜尋結果。
  
如需使用「搜尋統計資料」工具的詳細資訊，請參閱[查看內容搜尋結果的關鍵字統計資料](view-keyword-statistics-for-content-search.md)。
  
## <a name="use-the-bulk-search-editor-to-change-queries"></a>使用大量搜尋編輯器變更查詢

1. 移至[https://protection.office.com](https://protection.office.com)，然後選取 [**搜尋** \> **內容搜尋**]。
    
2. 在搜尋清單中，選取一或多個搜尋，然後選取 [**大量搜尋編輯器** ![大量搜尋編輯器]](../media/1ddb3d18-2f00-4a7b-98a6-817ca5ec7014.png)按鈕。
    
    ![選取一或多個搜尋，然後選取 [大量搜尋編輯器]](../media/600c9716-89a2-4451-b111-fa7cfaad2006.png)
  
    下列資訊會顯示在大量搜尋編輯器的 [**查詢**] 頁面上。 
    
    ![[大量搜尋編輯器] 頁面會顯示所選搜尋的查詢](../media/189659af-cc78-4479-b0bc-a93decad2f6c.png)
  
    a. **搜尋**欄會顯示內容搜尋的名稱。 如先前所述，您可以編輯查詢以進行多個搜尋。 
    
    b. [**查詢**] 欄會顯示**搜尋**欄中所列之內容搜尋的查詢。 如果使用關鍵字清單功能建立查詢，關鍵字會以文字 * * `(c:s)`分隔 **。這表示關鍵字是由**OR**運算子所連接。此外，如果查詢包含條件，關鍵字和條件會以文字 * * `(c:c)`分隔**。 這表示關鍵字（或關鍵字階段）依**and**運算子連接至條件。 例如，在先前的螢幕擷取畫面中，針對搜尋 ContosoSearch1，等價`customer (c:s) pricing(c:c)(date=2000-01-01..2016-09-30)`的 KQL 查詢會是。 `(customer OR pricing) AND (date=2002-01-01..2016-09-30)`
    
3. 若要編輯查詢，請選取您要變更的查詢儲存格，並執行下列其中一項操作。 當您選取儲存格時，儲存格會以藍色方塊界定。
    
   - 在儲存格中輸入新的查詢。 您無法編輯查詢的一部分。 您必須輸入整個查詢。
    
      或者
    
    - 在儲存格中貼上新的查詢。 這假設您已從檔案（例如文字檔或 Excel 檔案）複製查詢文字。
    
4. 在 [**查詢**] 頁面上編輯一或多個查詢之後，請選取 [**儲存**]。
    
    修訂的查詢會顯示在所選搜尋的 [**查詢**] 欄中。 
    
5. 選取 [**關閉**] 以關閉 [大量搜尋編輯器]。 
    
6. 在 [**內容搜尋**] 頁面上，選取您編輯的搜尋，然後選取 [**開始**搜尋]，以使用修訂過的查詢重新開機搜尋。 
    
以下是使用大量搜尋編輯器編輯查詢的一些秘訣：
  
- 將現有的查詢（使用**Ctrl C** ）複製到文字檔。 編輯文字檔中的查詢，然後將修改後的查詢複製並貼上（使用**Ctrl + V** ）回到 [**查詢**] 頁面上的儲存格。 
    
- 您也可以從其他應用程式（例如 Microsoft Word 或 Microsoft Excel）複製查詢。 不過，您可能會無意中使用大量搜尋編輯器將不支援的字元新增至查詢。 避免不支援字元的最佳方式，只是在 [**查詢**] 頁面的儲存格中輸入查詢。 您也可以複製 Word 或 Excel 中的查詢，然後在純文字編輯器（例如 Microsoft Notepad）上將其貼到檔案。 然後儲存文字檔，並在**編碼**下拉式清單中選取**ANSI** 。 這會移除任何格式及不支援的字元。 然後，您可以將查詢從文本檔案複製並貼到 [**查詢**] 頁面。 
    
  
## <a name="use-the-bulk-search-editor-to-change-content-locations"></a>使用大量搜尋編輯器變更內容位置

1. 在大量搜尋編輯器中選取一個或多個選取的搜尋時，選取 [**啟用大容量位置編輯器**]，然後選取頁面上顯示的**位置**連結。 
    
    下列資訊會顯示在大量搜尋編輯器的 [**位置**] 頁面上。 
    
    ![選取 [啟用大容量位置編輯器]，然後選取 [位置]，以新增或移除內容位置](../media/a5a468ce-bd63-4c53-bc37-ff64cf769e59.png)
  
    a. **要搜尋的信箱**此區段會顯示每個選取的內容搜尋的欄，以及搜尋中所包含之每個信箱的資料行。 核取記號表示該信箱已包含在搜尋中。 您可以在空白列中輸入信箱的電子郵件地址，然後選取您想要新增的內容搜尋核取方塊，將信箱新增至搜尋。 或者，您可以清除此核取方塊從搜尋移除信箱。
    
    b. **SharePoint 要搜尋的網站**此區段會針對每個選取內容搜尋中包含的每個 SharePoint 和 OneDrive 網站顯示一列。 核取記號表示該網站包含在搜尋中。 您可以在空白資料列中輸入網站的 URL，然後選取您想要新增的內容搜尋核取方塊，將網站新增至搜尋。 或者，您可以清除此核取方塊，從搜尋移除網站。
    
    c. **其他搜尋選項**此區段指出搜尋中是否包含未編制索引的專案和公用資料夾。 若要加入，請確定已選取此核取方塊。 若要移除，請清除核取方塊。
    
2. 在 [**位置**] 頁面上編輯一或多個區段之後，請選取 [**儲存**]。
    
    修訂的內容位置會顯示在所選搜尋的適當區段中。
    
3. 選取 [**關閉**] 以關閉 [大量搜尋編輯器]。 
    
4. 在 [**內容搜尋**] 頁面上，選取您編輯的搜尋，然後選取 [**啟動**搜尋]，以使用修訂的內容位置來重新開機搜尋。 
    
以下是使用大量搜尋編輯器編輯內容位置的一些秘訣：
  
- 您可以編輯「內容搜尋」來搜尋組織中的所有信箱或網站，只要在 [信箱] 的空白列**中輸入 [** **搜尋**] 或 [ **SharePoint 要搜尋的網站**] 區段，然後選取此核取方塊。 
    
- 您可以將多個內容位置新增至一或多個搜尋，方法是從文字檔或 Excel 檔案中複製多個資料列，然後在 [**位置**] 頁面上的區段中貼上這些資料列。 在您新增位置之後，請務必針對您想要新增位置的每個搜尋，選取此核取方塊。 
    
    > [!TIP]
    > 若要為您組織中的所有使用者產生電子郵件地址清單，請在步驟2的步驟2中執行 PowerShell 命令[：產生使用者清單](search-the-mailbox-and-onedrive-for-business-for-a-list-of-users.md#step-2-generate-a-list-of-users)。 或者遵循下列步驟，[取得組織中所有使用者 OneDrive URLs 的清單](https://docs.microsoft.com/onedrive/list-onedrive-urls)，以產生您組織中的所有商務網站 OneDrive 清單。 請注意，您必須附加組織 MySite 網域的 URL （例如， https://contoso-my.sharepoint.com)到腳本所建立之商務網站的 OneDrive。 在您具有商務網站的電子郵件地址或 OneDrive 清單後，您可以複製並貼到大量搜尋編輯器中的 [**位置**] 頁面。 
  
- 在 [大量搜尋編輯器] 中選取 [**儲存**] 以儲存變更之後，您新增至搜尋的信箱電子郵件地址就會得到驗證。 如果電子郵件地址不存在，則會顯示錯誤訊息，指出無法找到信箱。 未驗證網站的 URLs。 
  

