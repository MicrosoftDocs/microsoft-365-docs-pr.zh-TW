---
title: 大量編輯內容搜尋
f1.keywords:
- NOCSH
ms.author: markjjo
author: markjjo
manager: laurawi
ms.date: 12/29/2016
audience: Admin
ms.topic: article
ms.service: O365-seccomp
localization_priority: Normal
search.appverid:
- MOE150
- MET150
ms.assetid: 39e4654a-9588-41f6-892b-c33ab57bfbe2
ms.custom:
- seo-marvel-apr2020
description: 在安全性與合規性中心使用大量搜尋編輯器，快速變更一或多個內容搜尋的查詢和內容位置。
ms.openlocfilehash: f6331bad19e95fd1d7039d5da72349906d3614b8
ms.sourcegitcommit: 48195345b21b409b175d68acdc25d9f2fc4fc5f1
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/30/2021
ms.locfileid: "53227384"
---
# <a name="bulk-edit-content-searches"></a><span data-ttu-id="ef96a-103">大量編輯內容搜尋</span><span class="sxs-lookup"><span data-stu-id="ef96a-103">Bulk edit Content Searches</span></span>

<span data-ttu-id="ef96a-104">您可以使用內容搜尋工具中的大量搜尋編輯器同時編輯多個搜尋。</span><span class="sxs-lookup"><span data-stu-id="ef96a-104">You can use the Bulk Search Editor in the Content Search tool to edit multiple searches at the same time.</span></span> <span data-ttu-id="ef96a-105">使用此工具可讓您快速變更一或多個搜尋的查詢和內容位置。</span><span class="sxs-lookup"><span data-stu-id="ef96a-105">Using this tool lets you quickly change the query and content locations for one or more searches.</span></span> <span data-ttu-id="ef96a-106">然後，您可以重新執行搜尋並取得修改的搜尋的新預計搜尋結果。</span><span class="sxs-lookup"><span data-stu-id="ef96a-106">Then you can rerun the searches and get new estimated search results for the revised searches.</span></span> <span data-ttu-id="ef96a-107">編輯器也可讓您從 Microsoft Excel 檔或文本檔案複製及貼上查詢和內容位置。</span><span class="sxs-lookup"><span data-stu-id="ef96a-107">The editor also lets you copy and paste queries and content locations from a Microsoft Excel file or text file.</span></span> <span data-ttu-id="ef96a-108">這表示您可以使用「搜尋統計資料」工具來查看一或多個搜尋的統計資料，將統計資料匯出至 CSV 檔案，您可以在其中編輯 Excel 中的查詢和內容位置。</span><span class="sxs-lookup"><span data-stu-id="ef96a-108">This means you can use the Search Statistics tool to view the statistics of one or more searches, export the statistics to a CSV file, where you can edit the queries and content locations in Excel.</span></span> <span data-ttu-id="ef96a-109">然後，您可以使用大量搜尋編輯器，將修改過的查詢和內容位置新增至搜尋。</span><span class="sxs-lookup"><span data-stu-id="ef96a-109">Then you use the Bulk Search Editor to add the revised queries and content locations to the searches.</span></span> <span data-ttu-id="ef96a-110">在您修訂一或多個搜尋之後，您可以重新開機並取得新的預估搜尋結果。</span><span class="sxs-lookup"><span data-stu-id="ef96a-110">After you've revised one or more searches, you can restart them and get new estimated search results.</span></span>

<span data-ttu-id="ef96a-111">如需使用「搜尋統計資料」工具的詳細資訊，請參閱 [查看內容搜尋結果的關鍵字統計資料](view-keyword-statistics-for-content-search.md)。</span><span class="sxs-lookup"><span data-stu-id="ef96a-111">For more information about using the Search Statistics tool, see [View keyword statistics for Content Search results](view-keyword-statistics-for-content-search.md).</span></span>

## <a name="use-the-bulk-search-editor-to-change-queries"></a><span data-ttu-id="ef96a-112">使用大量搜尋編輯器變更查詢</span><span class="sxs-lookup"><span data-stu-id="ef96a-112">Use the Bulk Search Editor to change queries</span></span>

1. <span data-ttu-id="ef96a-113">移至 <https://protection.office.com> ，然後選取 [ **搜尋** \> **內容搜尋**]。</span><span class="sxs-lookup"><span data-stu-id="ef96a-113">Go to <https://protection.office.com>, and then select **Search** \> **Content search**.</span></span>

2. <span data-ttu-id="ef96a-114">在搜尋清單中，選取一或多個搜尋，然後選取 [ **大量搜尋編輯器** ![ 大量搜尋編輯器] 按鈕 ](../media/1ddb3d18-2f00-4a7b-98a6-817ca5ec7014.png) 。</span><span class="sxs-lookup"><span data-stu-id="ef96a-114">In the list of searches, select one or more searches, and then select **Bulk Search Editor** ![Bulk Search Editor button](../media/1ddb3d18-2f00-4a7b-98a6-817ca5ec7014.png).</span></span>

    ![選取一或多個搜尋，然後選取 [大量搜尋編輯器]](../media/600c9716-89a2-4451-b111-fa7cfaad2006.png)

    <span data-ttu-id="ef96a-116">下列資訊會顯示在大量搜尋編輯器的 [ **查詢** ] 頁面上。</span><span class="sxs-lookup"><span data-stu-id="ef96a-116">The following information is displayed on the **Queries** page of the Bulk Search Editor.</span></span>

    ![[大量搜尋編輯器] 頁面會顯示所選搜尋的查詢](../media/189659af-cc78-4479-b0bc-a93decad2f6c.png)

    <span data-ttu-id="ef96a-118">a.</span><span class="sxs-lookup"><span data-stu-id="ef96a-118">a.</span></span> <span data-ttu-id="ef96a-119">**搜尋** 欄會顯示內容搜尋的名稱。</span><span class="sxs-lookup"><span data-stu-id="ef96a-119">The **Search** column displays the name of the Content Search.</span></span> <span data-ttu-id="ef96a-120">如先前所述，您可以編輯查詢以進行多個搜尋。</span><span class="sxs-lookup"><span data-stu-id="ef96a-120">As previously stated, you can edit the query for multiple searches.</span></span>

    <span data-ttu-id="ef96a-121">b.</span><span class="sxs-lookup"><span data-stu-id="ef96a-121">b.</span></span> <span data-ttu-id="ef96a-122">[ **查詢** ] 欄會顯示 **搜尋** 欄中所列之內容搜尋的查詢。</span><span class="sxs-lookup"><span data-stu-id="ef96a-122">The **Query** column displays the query for the Content Search listed in the **Search** column.</span></span> <span data-ttu-id="ef96a-123">如果使用關鍵字清單功能建立查詢，關鍵字會以文字分隔 **`(c:s)`** 。</span><span class="sxs-lookup"><span data-stu-id="ef96a-123">If the query was created using the keyword list feature, the keywords are separated by the text **`(c:s)`**.</span></span> <span data-ttu-id="ef96a-124">這表示關鍵字是由 **OR** 運算子所連接。</span><span class="sxs-lookup"><span data-stu-id="ef96a-124">This indicates that the keywords are connected by the **OR** operator.</span></span> <span data-ttu-id="ef96a-125">此外，如果查詢包含條件，關鍵字和條件會以文字分隔 **`(c:c)`** 。</span><span class="sxs-lookup"><span data-stu-id="ef96a-125">Additionally, if the query includes conditions, the keywords and the conditions are separated by the text **`(c:c)`**.</span></span> <span data-ttu-id="ef96a-126">這表示關鍵字 (或關鍵字階段) 依 **and** 運算子連接至條件。</span><span class="sxs-lookup"><span data-stu-id="ef96a-126">This indicates that the keywords (or keyword phases) are connected to the conditions by the **AND** operator.</span></span> <span data-ttu-id="ef96a-127">例如，在先前的螢幕擷取畫面中，針對搜尋 ContosoSearch1，等價的 KQL 查詢會 `customer (c:s) pricing(c:c)(date=2000-01-01..2016-09-30)` 是  `(customer OR pricing) AND (date=2002-01-01..2016-09-30)` 。</span><span class="sxs-lookup"><span data-stu-id="ef96a-127">For example, in the previous screenshot the for search ContosoSearch1, the KQL query that is equivalent to `customer (c:s) pricing(c:c)(date=2000-01-01..2016-09-30)` would be  `(customer OR pricing) AND (date=2002-01-01..2016-09-30)`.</span></span>

3. <span data-ttu-id="ef96a-128">若要編輯查詢，請選取您要變更的查詢儲存格，並執行下列其中一項操作。</span><span class="sxs-lookup"><span data-stu-id="ef96a-128">To edit a query, select in the cell of the query that you want to change and doing one of the following things.</span></span> <span data-ttu-id="ef96a-129">當您選取儲存格時，儲存格會以藍色方塊界定。</span><span class="sxs-lookup"><span data-stu-id="ef96a-129">The cell is bordered by a blue box when you select it.</span></span>

   - <span data-ttu-id="ef96a-130">在儲存格中輸入新的查詢。</span><span class="sxs-lookup"><span data-stu-id="ef96a-130">Type the new query in the cell.</span></span> <span data-ttu-id="ef96a-131">您無法編輯查詢的一部分。</span><span class="sxs-lookup"><span data-stu-id="ef96a-131">You can't edit a portion of the query.</span></span> <span data-ttu-id="ef96a-132">您必須輸入整個查詢。</span><span class="sxs-lookup"><span data-stu-id="ef96a-132">You have to type the entire query.</span></span>

      <span data-ttu-id="ef96a-133">或</span><span class="sxs-lookup"><span data-stu-id="ef96a-133">Or</span></span>

   - <span data-ttu-id="ef96a-134">在儲存格中貼上新的查詢。</span><span class="sxs-lookup"><span data-stu-id="ef96a-134">Paste a new query in the cell.</span></span> <span data-ttu-id="ef96a-135">這假設您已從檔案（例如文字檔或 Excel 檔案）複製查詢文字。</span><span class="sxs-lookup"><span data-stu-id="ef96a-135">This assumes that you've copied the query text from a file, such as a text file or an Excel file.</span></span>

4. <span data-ttu-id="ef96a-136">在 [ **查詢** ] 頁面上編輯一或多個查詢之後，請選取 [ **儲存**]。</span><span class="sxs-lookup"><span data-stu-id="ef96a-136">After you've edited one or more queries on the **Queries** page, select **Save**.</span></span>

    <span data-ttu-id="ef96a-137">修訂的查詢會顯示在所選搜尋的 [ **查詢** ] 欄中。</span><span class="sxs-lookup"><span data-stu-id="ef96a-137">The revised query is displayed in the **Query** column for the selected search.</span></span>

5. <span data-ttu-id="ef96a-138">選取 [ **關閉** ] 以關閉 [大量搜尋編輯器]。</span><span class="sxs-lookup"><span data-stu-id="ef96a-138">Select **Close** to close the Bulk Search Editor.</span></span>

6. <span data-ttu-id="ef96a-139">在 [ **內容搜尋** ] 頁面上，選取您編輯的搜尋，然後選取 [ **開始** 搜尋]，以使用修訂過的查詢重新開機搜尋。</span><span class="sxs-lookup"><span data-stu-id="ef96a-139">On the **Content search** page, select the search that you edited, and select **Start** search to restart the search using the revised query.</span></span>

<span data-ttu-id="ef96a-140">以下是使用大量搜尋編輯器編輯查詢的一些秘訣：</span><span class="sxs-lookup"><span data-stu-id="ef96a-140">Here are some tips for editing queries using the Bulk Search Editor:</span></span>

- <span data-ttu-id="ef96a-141">使用 **ctrl-c**) 將現有的查詢 (複製到文字檔。</span><span class="sxs-lookup"><span data-stu-id="ef96a-141">Copy the existing query (by using **Ctrl C**) to a text file.</span></span> <span data-ttu-id="ef96a-142">編輯文字檔中的查詢，然後複製修訂過的查詢，並 (使用 **Ctrl + V**) 回到 [ **查詢** ] 頁面上的儲存格。</span><span class="sxs-lookup"><span data-stu-id="ef96a-142">Edit the query in the text file, and then copy the revised query and paste it (using **Ctrl V**) back into the cell on the **Queries** page.</span></span>

- <span data-ttu-id="ef96a-143">您也可以複製來自其他應用程式的查詢 (例如 Microsoft Word 或 Microsoft Excel) 。</span><span class="sxs-lookup"><span data-stu-id="ef96a-143">You can also copy queries from other applications (such as Microsoft Word or Microsoft Excel).</span></span> <span data-ttu-id="ef96a-144">不過，您可能會無意中使用大量搜尋編輯器將不支援的字元新增至查詢。</span><span class="sxs-lookup"><span data-stu-id="ef96a-144">However, you might inadvertently add unsupported characters to a query using the Bulk Search Editor.</span></span> <span data-ttu-id="ef96a-145">避免不支援字元的最佳方式，只是在 [ **查詢** ] 頁面的儲存格中輸入查詢。</span><span class="sxs-lookup"><span data-stu-id="ef96a-145">The best way to prevent unsupported characters is to just type the query in a cell on the **Queries** page.</span></span> <span data-ttu-id="ef96a-146">或者，您可以複製 Word 或 Excel 中的查詢，然後在純文字編輯器（例如 Microsoft 記事本）中將其貼上。</span><span class="sxs-lookup"><span data-stu-id="ef96a-146">Or you can copy a query from Word or Excel and then paste it to file in a plain text editor, such as Microsoft Notepad.</span></span> <span data-ttu-id="ef96a-147">然後儲存文字檔，並在 **編碼** 下拉式清單中選取 **ANSI** 。</span><span class="sxs-lookup"><span data-stu-id="ef96a-147">Then save the text file and select **ANSI** in the **Encoding** drop-down list.</span></span> <span data-ttu-id="ef96a-148">這會移除任何格式及不支援的字元。</span><span class="sxs-lookup"><span data-stu-id="ef96a-148">This removes any formatting and unsupported characters.</span></span> <span data-ttu-id="ef96a-149">然後，您可以將查詢從文本檔案複製並貼到 [ **查詢** ] 頁面。</span><span class="sxs-lookup"><span data-stu-id="ef96a-149">Then you can copy and paste the query from the text file to the **Queries** page.</span></span>

## <a name="use-the-bulk-search-editor-to-change-content-locations"></a><span data-ttu-id="ef96a-150">使用大量搜尋編輯器變更內容位置</span><span class="sxs-lookup"><span data-stu-id="ef96a-150">Use the Bulk Search Editor to change content locations</span></span>

1. <span data-ttu-id="ef96a-151">在大量搜尋編輯器中選取一個或多個選取的搜尋時，選取 [ **啟用大容量位置編輯器**]，然後選取頁面上顯示的 **位置** 連結。</span><span class="sxs-lookup"><span data-stu-id="ef96a-151">In the Bulk Search Editor for one or more selected searches, select **Enable bulk location editor**, and then select the **Locations** link that is displayed on the page.</span></span>

    <span data-ttu-id="ef96a-152">下列資訊會顯示在大量搜尋編輯器的 [ **位置** ] 頁面上。</span><span class="sxs-lookup"><span data-stu-id="ef96a-152">The following information is displayed on the **Locations** page of the Bulk Search Editor.</span></span>

    ![選取 [啟用大容量位置編輯器]，然後選取 [位置]，以新增或移除內容位置](../media/a5a468ce-bd63-4c53-bc37-ff64cf769e59.png)

    <span data-ttu-id="ef96a-154">a.</span><span class="sxs-lookup"><span data-stu-id="ef96a-154">a.</span></span> <span data-ttu-id="ef96a-155">**要搜尋的信箱** 此區段會顯示每個選取的內容搜尋的欄，以及搜尋中所包含之每個信箱的資料行。</span><span class="sxs-lookup"><span data-stu-id="ef96a-155">**Mailboxes to search** This section displays a column for each selected Content Search and a row for each mailbox that's included in the search.</span></span> <span data-ttu-id="ef96a-156">核取記號表示該信箱已包含在搜尋中。</span><span class="sxs-lookup"><span data-stu-id="ef96a-156">A check mark indicates that the mailbox is included in the search.</span></span> <span data-ttu-id="ef96a-157">您可以在空白列中輸入信箱的電子郵件地址，然後選取您想要新增的內容搜尋核取方塊，將信箱新增至搜尋。</span><span class="sxs-lookup"><span data-stu-id="ef96a-157">You can add mailboxes to a search by typing the email address of the mailbox in a blank row and then selecting the check box for the Content Search that you want to add it to.</span></span> <span data-ttu-id="ef96a-158">或者，您可以清除此核取方塊從搜尋移除信箱。</span><span class="sxs-lookup"><span data-stu-id="ef96a-158">Or you can remove a mailbox from a search by clearing the check box.</span></span>

    <span data-ttu-id="ef96a-159">b.</span><span class="sxs-lookup"><span data-stu-id="ef96a-159">b.</span></span> <span data-ttu-id="ef96a-160">**SharePoint 要搜尋的網站** 此區段會針對每個選取內容搜尋中包含的每個 SharePoint 和 OneDrive 網站顯示一列。</span><span class="sxs-lookup"><span data-stu-id="ef96a-160">**SharePoint sites to search** This section displays a row for each SharePoint and OneDrive site that's included in each selected Content Search.</span></span> <span data-ttu-id="ef96a-161">核取記號表示該網站包含在搜尋中。</span><span class="sxs-lookup"><span data-stu-id="ef96a-161">A check mark indicates that the site is included in the search.</span></span> <span data-ttu-id="ef96a-162">您可以在空白資料列中輸入網站的 URL，然後選取您想要新增的內容搜尋核取方塊，將網站新增至搜尋。</span><span class="sxs-lookup"><span data-stu-id="ef96a-162">You can add sites to a search by typing the URL for the site in a blank row and then selecting the check box for the Content Search that you want to add it to.</span></span> <span data-ttu-id="ef96a-163">或者，您可以清除此核取方塊，從搜尋移除網站。</span><span class="sxs-lookup"><span data-stu-id="ef96a-163">Or you can remove a site from a search by clearing the check box.</span></span>

    <span data-ttu-id="ef96a-164">c.</span><span class="sxs-lookup"><span data-stu-id="ef96a-164">c.</span></span> <span data-ttu-id="ef96a-165">**其他搜尋選項** 此區段指出搜尋中是否包含未編制索引的專案和公用資料夾。</span><span class="sxs-lookup"><span data-stu-id="ef96a-165">**Other search options** This section indicates whether unindexed items and public folders are included in the search.</span></span> <span data-ttu-id="ef96a-166">若要加入，請確定已選取此核取方塊。</span><span class="sxs-lookup"><span data-stu-id="ef96a-166">To include them, make sure the check box is selected.</span></span> <span data-ttu-id="ef96a-167">若要移除，請清除核取方塊。</span><span class="sxs-lookup"><span data-stu-id="ef96a-167">To remove them, clear the check box.</span></span>

2. <span data-ttu-id="ef96a-168">在 [ **位置** ] 頁面上編輯一或多個區段之後，請選取 [ **儲存**]。</span><span class="sxs-lookup"><span data-stu-id="ef96a-168">After you've edited one or more of the sections on the **Locations** page, select **Save**.</span></span>

    <span data-ttu-id="ef96a-169">修訂的內容位置會顯示在所選搜尋的適當區段中。</span><span class="sxs-lookup"><span data-stu-id="ef96a-169">The revised content locations are displayed in the appropriate section for the selected searches.</span></span>

3. <span data-ttu-id="ef96a-170">選取 [ **關閉** ] 以關閉 [大量搜尋編輯器]。</span><span class="sxs-lookup"><span data-stu-id="ef96a-170">Select **Close** to close the Bulk Search Editor.</span></span>

4. <span data-ttu-id="ef96a-171">在 [ **內容搜尋** ] 頁面上，選取您編輯的搜尋，然後選取 [ **啟動** 搜尋]，以使用修訂的內容位置來重新開機搜尋。</span><span class="sxs-lookup"><span data-stu-id="ef96a-171">On the **Content search** page, select the search that you edited, and select **Start** search to restart the search using the revised content locations.</span></span>

<span data-ttu-id="ef96a-172">以下是使用大量搜尋編輯器編輯內容位置的一些秘訣：</span><span class="sxs-lookup"><span data-stu-id="ef96a-172">Here are some tips for editing content locations using the Bulk Search Editor:</span></span>

- <span data-ttu-id="ef96a-173">您可以編輯「內容搜尋」來搜尋組織中的所有信箱或網站，只要在 [信箱] 的空白列 **中輸入 [** **搜尋**] 或 [ **SharePoint 要搜尋的網站**] 區段，然後選取此核取方塊。</span><span class="sxs-lookup"><span data-stu-id="ef96a-173">You can edit Content Searches to search all mailboxes or sites in the organization by typing **All** in a blank row in the **Mailboxes to search** or **SharePoint sites to search** section and then selecting the check box.</span></span>

- <span data-ttu-id="ef96a-174">您可以從文字檔或 Excel 檔中複製多個資料列，然後將其貼到 [**位置**] 頁面上的區段中，將多個內容位置新增至一或多個搜尋。</span><span class="sxs-lookup"><span data-stu-id="ef96a-174">You can add multiple content locations to one or more searches by copying multiple rows from a text file or an Excel file and then pasting them in a section on the **Locations** page.</span></span> <span data-ttu-id="ef96a-175">在您新增位置之後，請務必針對您想要新增位置的每個搜尋，選取此核取方塊。</span><span class="sxs-lookup"><span data-stu-id="ef96a-175">After you add new locations, be sure to select the check box for each search that you want add the location to.</span></span>

    > [!TIP]
    > <span data-ttu-id="ef96a-176">若要為您組織中的所有使用者產生電子郵件地址清單，請在步驟2的步驟2中執行 PowerShell 命令 [：產生使用者清單](search-the-mailbox-and-onedrive-for-business-for-a-list-of-users.md#step-2-generate-a-list-of-users)。</span><span class="sxs-lookup"><span data-stu-id="ef96a-176">To generate a list of email addresses for all the users in your organization, run the PowerShell command in Step 2 in [Step 2: Generate a list of users](search-the-mailbox-and-onedrive-for-business-for-a-list-of-users.md#step-2-generate-a-list-of-users).</span></span> <span data-ttu-id="ef96a-177">或者遵循下列步驟，[取得組織中所有使用者 OneDrive URLs](/onedrive/list-onedrive-urls)的清單，以產生組織中所有商務用 OneDrive 網站的清單。</span><span class="sxs-lookup"><span data-stu-id="ef96a-177">Or follow the steps in [Get a list of all user OneDrive URLs in your organization](/onedrive/list-onedrive-urls) to generate a list of all OneDrive for Business sites in your organization.</span></span> <span data-ttu-id="ef96a-178">請注意，您必須將組織 MySite 網域 (的 URL 附加 https://contoso-my.sharepoint.com) 到腳本所建立的商務用 OneDrive 網站中（例如）。</span><span class="sxs-lookup"><span data-stu-id="ef96a-178">Note that you'll have to append the URL for your organization's MySite domain (for example, https://contoso-my.sharepoint.com) to the OneDrive for Business sites that's created by the script.</span></span> <span data-ttu-id="ef96a-179">在您具有電子郵件地址或商務用 OneDrive 網站清單後，您可以複製並貼到大量搜尋編輯器中的 [**位置**] 頁面。</span><span class="sxs-lookup"><span data-stu-id="ef96a-179">After you have list of email addresses or OneDrive for Business sites, you can copy and paste them to the **Locations** page in the Bulk Search Editor.</span></span>

- <span data-ttu-id="ef96a-180">在 [大量搜尋編輯器] 中選取 [ **儲存** ] 以儲存變更之後，您新增至搜尋的信箱電子郵件地址就會得到驗證。</span><span class="sxs-lookup"><span data-stu-id="ef96a-180">After you select **Save** to save changes in Bulk Search Editor, the email address for mailboxes that you added to a search will be validated.</span></span> <span data-ttu-id="ef96a-181">如果電子郵件地址不存在，則會顯示錯誤訊息，指出無法找到信箱。</span><span class="sxs-lookup"><span data-stu-id="ef96a-181">If the email address doesn't exist, an error message is displayed saying the mailbox can't be located.</span></span> <span data-ttu-id="ef96a-182">未驗證網站的 URLs。</span><span class="sxs-lookup"><span data-stu-id="ef96a-182">URLs for sites aren't validated.</span></span>
