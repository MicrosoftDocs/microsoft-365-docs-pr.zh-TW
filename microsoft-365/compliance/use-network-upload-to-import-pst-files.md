---
title: 使用網路上傳匯入組織的 PST 檔案
f1.keywords:
- NOCSH
ms.author: markjjo
author: markjjo
manager: laurawi
audience: Admin
ms.topic: article
ms.service: O365-seccomp
localization_priority: Priority
ms.collection:
- Strat_O365_IP
- M365-security-compliance
search.appverid:
- MOE150
- MED150
- MET150
ms.assetid: 103f940c-0468-4e1a-b527-cc8ad13a5ea6
description: 適用於系統管理員：了解如何使用網路上傳將多個 PST 檔案大量匯入 Office 365 中的使用者信箱。
ms.openlocfilehash: 4420c2a684b020053bab88a14f46a73a795bd37d
ms.sourcegitcommit: 93e6bf1b541e22129f8c443051375d0ef1374150
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/13/2020
ms.locfileid: "42634621"
---
# <a name="use-network-upload-to-import-your-organizations-pst-files-to-office-365"></a><span data-ttu-id="30af0-103">使用網路上傳將組織的 PST 檔案匯入 Office 365</span><span class="sxs-lookup"><span data-stu-id="30af0-103">Use network upload to import your organization's PST files to Office 365</span></span>

> [!NOTE]
> <span data-ttu-id="30af0-104">本文適用於系統管理員。</span><span class="sxs-lookup"><span data-stu-id="30af0-104">This article is for administrators.</span></span> <span data-ttu-id="30af0-105">您是否正嘗試匯入 PST 檔案到自己的信箱？</span><span class="sxs-lookup"><span data-stu-id="30af0-105">Are you trying to import PST files to your own mailbox?</span></span> <span data-ttu-id="30af0-106">請參閱[從 Outlook .pst 檔案匯入電子郵件、連絡人和行事曆](https://go.microsoft.com/fwlink/p/?LinkID=785075)</span><span class="sxs-lookup"><span data-stu-id="30af0-106">See [Import email, contacts, and calendar from an Outlook .pst file](https://go.microsoft.com/fwlink/p/?LinkID=785075)</span></span>
  
<span data-ttu-id="30af0-107">以下是使用網路上傳將多個 PST 檔案大量匯入 Office 365 信箱所需的逐步指示。</span><span class="sxs-lookup"><span data-stu-id="30af0-107">Here are the step-by-step instructions required to use network upload to bulk-import multiple PST files to Office 365 mailboxes.</span></span> <span data-ttu-id="30af0-108">如需使用網路上傳將 PST 檔案大量匯入 Office 365 信箱的常見問題集，請參閱[使用網路上傳將 PST 檔案匯入的常見問題集](faqimporting-pst-files-to-office-365.md#using-network-upload-to-import-pst-files)。</span><span class="sxs-lookup"><span data-stu-id="30af0-108">For frequently asked questions about using network upload to bulk-import PST files to Office 365 mailboxes, see [FAQs for using network upload to import PST files](faqimporting-pst-files-to-office-365.md#using-network-upload-to-import-pst-files).</span></span>
  
[<span data-ttu-id="30af0-109">步驟 1：複製 SAS URL 和安裝 AzCopy</span><span class="sxs-lookup"><span data-stu-id="30af0-109">Step 1: Copy the SAS URL and install AzCopy</span></span>](#step-1-copy-the-sas-url-and-install-azcopy)

[<span data-ttu-id="30af0-110">步驟 2：將您的 PST 檔案上傳至 Office 365</span><span class="sxs-lookup"><span data-stu-id="30af0-110">Step 2: Upload your PST files to Office 365</span></span>](#step-2-upload-your-pst-files-to-office-365)

[<span data-ttu-id="30af0-111">(選用) 步驟 3：檢視上傳到 Office 365 的 PST 檔案清單</span><span class="sxs-lookup"><span data-stu-id="30af0-111">(Optional) Step 3: View a list of the PST files uploaded to Office 365</span></span>](#optional-step-3-view-a-list-of-the-pst-files-uploaded-to-office-365)

[<span data-ttu-id="30af0-112">步驟 4：建立 PST 匯入對應檔案</span><span class="sxs-lookup"><span data-stu-id="30af0-112">Step 4: Create the PST Import mapping file</span></span>](#step-4-create-the-pst-import-mapping-file)

[<span data-ttu-id="30af0-113">步驟 5：在 Office 365 內建立 PST 匯入工作</span><span class="sxs-lookup"><span data-stu-id="30af0-113">Step 5: Create a PST Import job in Office 365</span></span>](#step-5-create-a-pst-import-job-in-office-365)

[<span data-ttu-id="30af0-114">步驟 6：篩選資料，並開始 PST 匯入工作</span><span class="sxs-lookup"><span data-stu-id="30af0-114">Step 6: Filter data and start the PST Import job</span></span>](#step-6-filter-data-and-start-the-pst-import-job)

<span data-ttu-id="30af0-115">您只需執行步驟 1 一次就能將 PST 檔案匯入至 Office 365 信箱。</span><span class="sxs-lookup"><span data-stu-id="30af0-115">You have to perform Step 1 only once to import PST files to Office 365 mailboxes.</span></span> <span data-ttu-id="30af0-116">執行上述步驟後，每當您要上傳及匯入整批的 PST 檔案時，請遵循步驟 2 到步驟 6 的指示操作。</span><span class="sxs-lookup"><span data-stu-id="30af0-116">After you perform these steps, follow Step 2 through Step 6 each time you want to upload and import a batch of PST files.</span></span>

## <a name="before-you-begin"></a><span data-ttu-id="30af0-117">開始之前</span><span class="sxs-lookup"><span data-stu-id="30af0-117">Before you begin</span></span>
  
- <span data-ttu-id="30af0-118">您必須在 Exchange Online 中獲派信箱匯入匯出角色，才能將 PST 檔案匯入 Office 365 信箱。</span><span class="sxs-lookup"><span data-stu-id="30af0-118">You have to be assigned the Mailbox Import Export role in Exchange Online to import PST files to Office 365 mailboxes.</span></span> <span data-ttu-id="30af0-119">依預設，此角色不會指派給 Exchange Online 內的任何角色群組。</span><span class="sxs-lookup"><span data-stu-id="30af0-119">By default, this role isn't assigned to any role group in Exchange Online.</span></span> <span data-ttu-id="30af0-120">您可以將信箱匯入匯出角色新增到組織管理角色群組。</span><span class="sxs-lookup"><span data-stu-id="30af0-120">You can add the Mailbox Import Export role to the Organization Management role group.</span></span> <span data-ttu-id="30af0-121">或者，可以建立角色群組、指派信箱匯出匯入角色，然後將自己新增為成員。</span><span class="sxs-lookup"><span data-stu-id="30af0-121">Or you can create a role group, assign the Mailbox Import Export role, and then add yourself as a member.</span></span> <span data-ttu-id="30af0-122">如需詳細資訊，請參閱[管理角色群組](https://go.microsoft.com/fwlink/p/?LinkId=730688)之＜新增角色至角色群組＞或＜建立角色群組＞一節。</span><span class="sxs-lookup"><span data-stu-id="30af0-122">For more information, see the "Add a role to a role group" or the "Create a role group" sections in [Manage role groups](https://go.microsoft.com/fwlink/p/?LinkId=730688).</span></span>
    
    <span data-ttu-id="30af0-123">此外，若要在安全性與合規性中心建立匯入工作，必須符合以下其中一個條件：</span><span class="sxs-lookup"><span data-stu-id="30af0-123">Also, to create import jobs in the Security & Compliance Center, one of the following must be true:</span></span>
    
  - <span data-ttu-id="30af0-124">您必須在 Exchange Online 中獲派郵件收件者角色。</span><span class="sxs-lookup"><span data-stu-id="30af0-124">You have to be assigned the Mail Recipients role in Exchange Online.</span></span> <span data-ttu-id="30af0-125">根據預設，這個角色會指派給組織管理及收件者管理角色群組。</span><span class="sxs-lookup"><span data-stu-id="30af0-125">By default, this role is assigned to the Organization Management and Recipient Management roles groups.</span></span>
    
    <span data-ttu-id="30af0-126">或</span><span class="sxs-lookup"><span data-stu-id="30af0-126">Or</span></span>
    
  - <span data-ttu-id="30af0-127">您必須是您 Office365 組織中的全域系統管理員。</span><span class="sxs-lookup"><span data-stu-id="30af0-127">You have to be a global administrator in your Office 365 organization.</span></span>
    
  > [!TIP]
    > <span data-ttu-id="30af0-128">建議您在 Exchange Online 中建立新的角色群組，專門用來將 PST 檔案匯入 Office 365。</span><span class="sxs-lookup"><span data-stu-id="30af0-128">Consider creating a new role group in Exchange Online that's specifically intended for importing PST files to Office 365.</span></span> <span data-ttu-id="30af0-129">若要獲得匯入 PST 檔案所需的最低權限等級，請將信箱匯入匯出及郵件收件者角色指派到新的角色群組，然後新增成員。</span><span class="sxs-lookup"><span data-stu-id="30af0-129">For the minimum level of privileges required to import PST files, assign the Mailbox Import Export and Mail Recipients roles to the new role group, and then add members.</span></span>
  
- <span data-ttu-id="30af0-130">將 PST 檔案匯入 Office 365 的唯一支援的方法是使用 AzCopy 工具，如本主題中所述。</span><span class="sxs-lookup"><span data-stu-id="30af0-130">The only supported method for importing PST files to Office 365 is to use the AzCopy tool, as described in this topic.</span></span> <span data-ttu-id="30af0-131">您無法使用 Azure 儲存體總管直接將 PST 檔案上傳至 Azure 儲存體區域。</span><span class="sxs-lookup"><span data-stu-id="30af0-131">You can't use the Azure Storage Explorer to upload PST files directly to the Azure Storage area.</span></span>
    
- <span data-ttu-id="30af0-132">您必須將要欲匯入至 Office365 的 PST 檔案儲存於檔案伺服器上，或是貴組織的共用資料夾。</span><span class="sxs-lookup"><span data-stu-id="30af0-132">You need to store the PST files that you want to import to Office 365 on a file server or shared folder in your organization.</span></span> <span data-ttu-id="30af0-133">在步驟 2 中，您會執行 AzCopy 工具，以將儲存於檔案伺服器或是共用資料夾上的 PST 檔案上傳至 Office 365。</span><span class="sxs-lookup"><span data-stu-id="30af0-133">In Step 2, you run the AzCopy tool to upload the PST files that are stored on a file server or shared folder to Office 365.</span></span>
    
- <span data-ttu-id="30af0-134">大型 PST 檔案可能會影響 PST 匯入程序的效能。</span><span class="sxs-lookup"><span data-stu-id="30af0-134">Large PST files may impact the performance of the PST import process.</span></span> <span data-ttu-id="30af0-135">我們建議您在步驟 2 中上傳到 Azure 儲存位置的每個 PST 檔案都不應超過 20 GB。</span><span class="sxs-lookup"><span data-stu-id="30af0-135">So we recommend that each PST file you upload to the Azure Storage location in Step 2 should be no larger than 20 GB.</span></span>

- <span data-ttu-id="30af0-136">此程序包含複製及儲存包含存取金鑰的 URL 複本。</span><span class="sxs-lookup"><span data-stu-id="30af0-136">This procedure involves copying and saving a copy of a URL that contains an access key.</span></span> <span data-ttu-id="30af0-137">此資訊將在步驟 2 中用於上傳 PST 檔案，如果要檢視上傳到 Office 365 的 PST 檔案清單，則會在步驟 3 中使用。</span><span class="sxs-lookup"><span data-stu-id="30af0-137">This information will be used in Step 2 to upload your PST files, and in Step 3 if you want to view a list of the PST files uploaded to Office 365.</span></span> <span data-ttu-id="30af0-138">請務必採取預防措施來保護此 URL，就如同您保護密碼或其他安全性相關資訊一樣。</span><span class="sxs-lookup"><span data-stu-id="30af0-138">Be sure to take precautions to protect this URL like you would protect passwords or other security-related information.</span></span> <span data-ttu-id="30af0-139">例如，您可能會將其儲存於受密碼保護的 Microsoft Word 文件內，或是儲存於已加密的 USB 磁碟機中。</span><span class="sxs-lookup"><span data-stu-id="30af0-139">For example, you might save it to a password-protected Microsoft Word document or to an encrypted USB drive.</span></span> <span data-ttu-id="30af0-140">請參閱[相關資訊](#more-information)一節，以取得此 URL 和金鑰組合的範例。</span><span class="sxs-lookup"><span data-stu-id="30af0-140">See the [More information](#more-information) section for an example of this combined URL and key.</span></span>
    
- <span data-ttu-id="30af0-141">您否可以將 PST 檔案匯入 Office 365 中的非作用中信箱。</span><span class="sxs-lookup"><span data-stu-id="30af0-141">You can import PST files to an inactive mailbox in Office 365.</span></span> <span data-ttu-id="30af0-142">您可以透過在 PST 匯入對應檔案的 `Mailbox` 參數中指定非作用中信箱的 GUID 來執行此操作。</span><span class="sxs-lookup"><span data-stu-id="30af0-142">You do this by specifying the GUID of the inactive mailbox in the  `Mailbox` parameter in the PST Import mapping file.</span></span> <span data-ttu-id="30af0-143">如需詳細資訊，請參閱本主題中**指示**索引標籤上的步驟 4。</span><span class="sxs-lookup"><span data-stu-id="30af0-143">See Step 4 on the **Instructions** tab in this topic for information.</span></span> 
    
- <span data-ttu-id="30af0-144">您可以在 Exchange 混合部署中為主要信箱位於內部部署的使用者，將 PST 檔案匯入雲端型封存信箱。</span><span class="sxs-lookup"><span data-stu-id="30af0-144">In an Exchange hybrid deployment, you can import PST files to a cloud-based archive mailbox for a user whose primary mailbox is on-premises.</span></span> <span data-ttu-id="30af0-145">您可以透過在 PST 匯入對應檔案中執行以下操作來進行：</span><span class="sxs-lookup"><span data-stu-id="30af0-145">You do this by doing the following in the PST Import mapping file:</span></span>
    
  - <span data-ttu-id="30af0-146">在 `Mailbox` 參數中指定使用者內部部署信箱的電子郵件地址。</span><span class="sxs-lookup"><span data-stu-id="30af0-146">Specify the email address for the user's on-premises mailbox in the  `Mailbox` parameter.</span></span>
    
  - <span data-ttu-id="30af0-147">在 `IsArchive` 參數上指定 **TRUE** 值。</span><span class="sxs-lookup"><span data-stu-id="30af0-147">Specify the **TRUE** value in the  `IsArchive` parameter.</span></span>
    
    <span data-ttu-id="30af0-148">如需詳細資訊，請參閱[步驟 4](#step-4-create-the-pst-import-mapping-file)。</span><span class="sxs-lookup"><span data-stu-id="30af0-148">See [Step 4](#step-4-create-the-pst-import-mapping-file) for more information.</span></span>
    
- <span data-ttu-id="30af0-149">PST 檔案匯入到 Office 365 信箱之後，信箱的暫停保留設定會開啟為無限期。</span><span class="sxs-lookup"><span data-stu-id="30af0-149">After PST files are imported to an Office 365 mailbox, the retention hold setting for the mailbox is turned on for an indefinite duration.</span></span> <span data-ttu-id="30af0-150">這表示在關閉暫停保留或設定日期來關閉暫停之前，系統不會處理指派給信箱的保留原則。</span><span class="sxs-lookup"><span data-stu-id="30af0-150">This means that the retention policy assigned to the mailbox won't be processed until you turn off the retention hold or set a date to turn off the hold.</span></span> <span data-ttu-id="30af0-151">為什麼這麼做？</span><span class="sxs-lookup"><span data-stu-id="30af0-151">Why do we do this?</span></span> <span data-ttu-id="30af0-152">如果匯入信箱的郵件是舊郵件，則可能會被永久刪除 (清除)，因為根據信箱設定的保留設定，這些郵件的保留期限已過期。</span><span class="sxs-lookup"><span data-stu-id="30af0-152">If messages imported to a mailbox are old, they might be permanently deleted (purged) because their retention period has expired based on the retention settings configured for the mailbox.</span></span> <span data-ttu-id="30af0-153">將信箱置於暫停保留狀態可讓信箱擁有者有時間管理這些新匯入的郵件，或者讓您有時間變更信箱的保留設定。</span><span class="sxs-lookup"><span data-stu-id="30af0-153">Placing the mailbox on retention hold gives the mailbox owner time to manage these newly imported messages or give you time to change the retention settings for the mailbox.</span></span> <span data-ttu-id="30af0-154">有關管理暫停保留的建議，請參閱本主題中的[相關資訊](#more-information)章節。</span><span class="sxs-lookup"><span data-stu-id="30af0-154">See the [More information](#more-information) section in this topic for suggestions about managing the retention hold.</span></span>
    
- <span data-ttu-id="30af0-155">根據預設，Office 365 信箱可接收的郵件大小上限為 35 MB。</span><span class="sxs-lookup"><span data-stu-id="30af0-155">By default, the maximum message size that can be received by an Office 365 mailbox is 35 MB.</span></span> <span data-ttu-id="30af0-156">這是因為信箱的 *MaxReceiveSize* 屬性的預設值設定為 35 MB。</span><span class="sxs-lookup"><span data-stu-id="30af0-156">That's because the default value for the  *MaxReceiveSize*  property for a mailbox is set to 35 MB.</span></span> <span data-ttu-id="30af0-157">然而，Office 365 中的接收郵件大小上限為 150 MB。</span><span class="sxs-lookup"><span data-stu-id="30af0-157">However, the limit for the maximum message receive size in Office 365 is 150 MB.</span></span> <span data-ttu-id="30af0-158">因此，如果匯入的 PST 檔案包含大於 35 MB 的項目，Office 365 匯入服務將自動將目標信箱上的 \*MaxReceiveSize \* 的屬性值變更為 150 MB。</span><span class="sxs-lookup"><span data-stu-id="30af0-158">So if you import a PST file that contains an item larger than 35 MB, the Office 365 Import service we will automatically change the value of the  *MaxReceiveSize*  property on the target mailbox to 150 MB.</span></span> <span data-ttu-id="30af0-159">這樣就可將最大 150 MB 的郵件匯入使用者信箱。</span><span class="sxs-lookup"><span data-stu-id="30af0-159">This allows messages up to 150 MB to be imported to user mailboxes.</span></span>
    
    > [!TIP]
    > <span data-ttu-id="30af0-160">若要辨識信箱的郵件接收大小，可以在 Exchange Online PowerShell 中執行此命令：`Get-Mailbox <user mailbox> | FL MaxReceiveSize`。</span><span class="sxs-lookup"><span data-stu-id="30af0-160">To identify the message receive size for a mailbox, you can run this command in Exchange Online PowerShell:  `Get-Mailbox <user mailbox> | FL MaxReceiveSize`.</span></span>

## <a name="step-1-copy-the-sas-url-and-install-azcopy"></a><span data-ttu-id="30af0-161">步驟 1：複製 SAS URL 和安裝 AzCopy</span><span class="sxs-lookup"><span data-stu-id="30af0-161">Step 1: Copy the SAS URL and install AzCopy</span></span>

<span data-ttu-id="30af0-162">第一個步驟是下載並安裝 AzCopy 工具，這是您在步驟 2 中將 PST 檔案上傳至 Office 365 所執行的工具。</span><span class="sxs-lookup"><span data-stu-id="30af0-162">The first step is to download and install the AzCopy tool, which is the tool that you run in Step 2 to upload PST files to Office 365.</span></span> <span data-ttu-id="30af0-163">您也會複製組織的 SAS URL。</span><span class="sxs-lookup"><span data-stu-id="30af0-163">You also copy the SAS URL for your organization.</span></span> <span data-ttu-id="30af0-164">此 URL 結合了組織的 Microsoft 雲端中，Azure 儲存體位置的網路 URL 和共用存取簽章 (SAS) 金鑰。</span><span class="sxs-lookup"><span data-stu-id="30af0-164">This URL is a combination of the network URL for the Azure Storage location in the Microsoft cloud for your organization and a Shared Access Signature (SAS) key.</span></span> <span data-ttu-id="30af0-165">此金鑰提供您將 PST 檔案上傳至 Azure 儲存體位置所需要的權限。</span><span class="sxs-lookup"><span data-stu-id="30af0-165">This key provides you with the necessary permissions to upload PST files to your Azure Storage location.</span></span> <span data-ttu-id="30af0-166">請務必採取預防措施來保護 SAS URL。</span><span class="sxs-lookup"><span data-stu-id="30af0-166">Be sure to take precautions to protect the SAS URL.</span></span> <span data-ttu-id="30af0-167">其對您的組織來說獨一無二，並將用於步驟 2。</span><span class="sxs-lookup"><span data-stu-id="30af0-167">It's unique to your organization and will be used in Step 2.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="30af0-168">若要使用本文中記錄的網路上傳方法和命令語法來匯入 PST 檔案，您必須使用可在以下程序之步驟 6b 中下載的 AzCopy 版本。</span><span class="sxs-lookup"><span data-stu-id="30af0-168">To import PST files using the network upload method and command syntax documented in this article, you must use the version of AzCopy that can be downloaded in step 6b in the following procedure.</span></span> <span data-ttu-id="30af0-169">您也可以從[這裡](https://aka.ms/downloadazcopy)下載該相同版本的 AzCopy。</span><span class="sxs-lookup"><span data-stu-id="30af0-169">You can also download that same version of AzCopy from [here](https://aka.ms/downloadazcopy).</span></span> <span data-ttu-id="30af0-170">不支援使用不同版本的 AzCopy。</span><span class="sxs-lookup"><span data-stu-id="30af0-170">Using a different version of AzCopy isn't supported.</span></span>
  
1. <span data-ttu-id="30af0-171">前往 [https://protection.office.com](https://protection.office.com)，然後使用您 Office 365 組織中系統管理員帳戶的認證來登入。</span><span class="sxs-lookup"><span data-stu-id="30af0-171">Go to [https://protection.office.com](https://protection.office.com) and sign in using the credentials for an administrator account in your Office 365 organization.</span></span> 
    
2. <span data-ttu-id="30af0-172">在「安全性與合規性中心」的左窗格中，按一下 **[資料控管]** \> **[匯入]** \> **[匯入 PST 檔案]**。</span><span class="sxs-lookup"><span data-stu-id="30af0-172">In the left pane of the Security & Compliance Center, click **Information governance** \> **Import** \> **Import PST files**.</span></span>
    
    > [!NOTE]
    > <span data-ttu-id="30af0-173">您必須獲派適當的權限，才能存取 [安全性與合規性中心] 中的 [匯入]\*\*\*\* 頁面。</span><span class="sxs-lookup"><span data-stu-id="30af0-173">You have to be assigned the appropriate permissions to access the **Import** page in the Security & Compliance Center.</span></span> <span data-ttu-id="30af0-174">如需詳細資訊，請參與**開始之前**這一節。</span><span class="sxs-lookup"><span data-stu-id="30af0-174">See the **Before you begin** section for more information.</span></span> 
    
3. <span data-ttu-id="30af0-175">按一下 **[匯入 PST 檔案]** 頁面上的 ![[新增圖示]](../media/ITPro-EAC-AddIcon.gif) \*\* [新增匯入工作]\*\*。</span><span class="sxs-lookup"><span data-stu-id="30af0-175">On the **Import PST files** page, click ![Add Icon](../media/ITPro-EAC-AddIcon.gif) **New import job**.</span></span>
    
    <span data-ttu-id="30af0-176">即會顯示匯入工作精靈。</span><span class="sxs-lookup"><span data-stu-id="30af0-176">The import job wizard is displayed.</span></span>
    
4. <span data-ttu-id="30af0-177">為 PST 匯入工作輸入名稱，然後按一下 [下一步]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="30af0-177">Type a name for the PST import job, and then click **Next**.</span></span> <span data-ttu-id="30af0-178">請使用小寫字母、數字、連字號和底線。</span><span class="sxs-lookup"><span data-stu-id="30af0-178">Use lowercase letters, numbers, hyphens, and underscores.</span></span> <span data-ttu-id="30af0-179">無法使用大寫字母，且名稱中不得包含空格。</span><span class="sxs-lookup"><span data-stu-id="30af0-179">You can't use uppercase letters or include spaces in the name.</span></span>
    
5. <span data-ttu-id="30af0-180">在 [您要上傳或傳送資料？]\*\*\*\* 頁面上、按一下 [上傳您的資料]\*\*\*\*，然後按一下 [下一步]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="30af0-180">On the **Do you want to upload or ship data?** page, click **Upload your data** and then click **Next**.</span></span>
    
    ![按一下 [上傳您的資料] 來建立網路上傳匯入工作。](../media/e59f9dc3-ccde-44ff-ac38-c4e39d76ae85.png)
  
6. <span data-ttu-id="30af0-182">在 [匯入資料]\*\*\*\* 頁面上，執行以下兩個動作：</span><span class="sxs-lookup"><span data-stu-id="30af0-182">On the **Import data** page, do the following two things:</span></span> 
    
    ![在 [匯入資料] 頁面上複製 SAS URL 並下載 AzCopy 工具](../media/74411014-ec4b-4e25-9065-404c934cce17.png)
  
    <span data-ttu-id="30af0-184">a.</span><span class="sxs-lookup"><span data-stu-id="30af0-184">a.</span></span> <span data-ttu-id="30af0-185">在步驟 2，按一下 [顯示網路上傳 SAS URL]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="30af0-185">In step 2, click **Show network upload SAS URL**.</span></span> <span data-ttu-id="30af0-186">顯示 SAS URL 後，按一下 [複製至剪貼簿]\*\*\*\* 然後貼上，並儲存到檔案中以便日後存取。</span><span class="sxs-lookup"><span data-stu-id="30af0-186">After the SAS URL is displayed, click **Copy to clipboard** and then paste it and save it to a file so you can access it later.</span></span>
    
    <span data-ttu-id="30af0-187">b.</span><span class="sxs-lookup"><span data-stu-id="30af0-187">b.</span></span> <span data-ttu-id="30af0-188">在步驟 3，按一下 **[下載 Azure AzCopy]** 以下載並安裝 AzCopy 工具。</span><span class="sxs-lookup"><span data-stu-id="30af0-188">In step 3, click **Download Azure AzCopy** to download and install the AzCopy tool.</span></span> <span data-ttu-id="30af0-189">在快顯視窗中，按一下 [執行]\*\*\*\* 來安裝 AzCopy。</span><span class="sxs-lookup"><span data-stu-id="30af0-189">In the pop-up window, click **Run** to install AzCopy.</span></span> 
    
> [!NOTE]
> <span data-ttu-id="30af0-190">您可以讓 [匯入資料]\*\*\*\* 頁面保持開啟 (以防您需要再次複製 SAS URL) 或按一下 [取消]\*\*\*\* 來關閉。</span><span class="sxs-lookup"><span data-stu-id="30af0-190">You can leave the **Import data** page open (in case you need to copy the SAS URL again) or click **Cancel** to close it.</span></span> 
 
## <a name="step-2-upload-your-pst-files-to-office-365"></a><span data-ttu-id="30af0-191">步驟 2：將您的 PST 檔案上傳至 Office 365</span><span class="sxs-lookup"><span data-stu-id="30af0-191">Step 2: Upload your PST files to Office 365</span></span>

<span data-ttu-id="30af0-192">現在您已準備好使用 AzCopy.exe 工具將 PST 檔案上傳至 Office365。</span><span class="sxs-lookup"><span data-stu-id="30af0-192">Now you're ready to use the AzCopy.exe tool to upload PST files to Office 365.</span></span> <span data-ttu-id="30af0-193">此工具會上傳並儲存這些檔案至 Microsoft 雲端內的 Azure 儲存體位置。</span><span class="sxs-lookup"><span data-stu-id="30af0-193">This tool uploads and stores them in an Azure Storage location in the Microsoft cloud.</span></span> <span data-ttu-id="30af0-194">如之前所說明，上傳 PST 檔案的 Azure 儲存體位置與 Office 365 組織所在的地區性 Microsoft 資料中心是同一個。</span><span class="sxs-lookup"><span data-stu-id="30af0-194">As previously explained, the Azure Storage location that you upload your PST files to resides in the same regional Microsoft datacenter where your Office 365 organization is located.</span></span> <span data-ttu-id="30af0-195">若要完成此步驟，PST 檔案必須位於組織的檔案共用內或檔案伺服器中。</span><span class="sxs-lookup"><span data-stu-id="30af0-195">To complete this step, the PST files have to be located in a file share or file server in your organization.</span></span> <span data-ttu-id="30af0-196">這就是此程序中所謂的來源目錄。</span><span class="sxs-lookup"><span data-stu-id="30af0-196">This is known as the source directory in this procedure.</span></span> <span data-ttu-id="30af0-197">每次執行 AzCopy 工具時，您可指定不同的來源目錄。</span><span class="sxs-lookup"><span data-stu-id="30af0-197">Each time you run the AzCopy tool, you can specify a different source directory.</span></span> 

> [!NOTE]
> <span data-ttu-id="30af0-198">如之前所述，在步驟 2 中上傳到 Azure 儲存位置的每個 PST 檔案都不應超過 20 GB。</span><span class="sxs-lookup"><span data-stu-id="30af0-198">As previously stated, each PST file that you upload to the Azure Storage location should be no larger than 20 GB.</span></span> <span data-ttu-id="30af0-199">大於 20 GB 的 PST 檔案可能會影響您在步驟 6 中啟動的 PST 匯入程序效能。</span><span class="sxs-lookup"><span data-stu-id="30af0-199">PST files larger than 20 GB may impact the performance of the PST import process that you start in Step 6.</span></span>

1. <span data-ttu-id="30af0-200">在您的本機電腦上開啟 [命令提示字元]。</span><span class="sxs-lookup"><span data-stu-id="30af0-200">Open a Command Prompt on your local computer.</span></span>
    
2. <span data-ttu-id="30af0-201">移至您在步驟 1 中安裝 AzCopy.exe 工具的目錄。</span><span class="sxs-lookup"><span data-stu-id="30af0-201">Go to the directory where you installed the AzCopy.exe tool in Step 1.</span></span> <span data-ttu-id="30af0-202">如果您將工具安裝於預設位置，請前往 `%ProgramFiles(x86)%\Microsoft SDKs\Azure\AzCopy`。</span><span class="sxs-lookup"><span data-stu-id="30af0-202">If you installed the tool in the default location, go to `%ProgramFiles(x86)%\Microsoft SDKs\Azure\AzCopy`.</span></span>
    
3. <span data-ttu-id="30af0-203">執行下列命令將 PST 檔案上傳至 Office365。</span><span class="sxs-lookup"><span data-stu-id="30af0-203">Run the following command to upload the PST files to Office 365.</span></span>

    ```powershell
    AzCopy.exe /Source:<Location of PST files> /Dest:<SAS URL> /V:<Log file location> /Y
    ```

    > [!IMPORTANT] 
    > <span data-ttu-id="30af0-204">您必須在上一個命令中指定目錄作為來源位置；您無法指定個別 PST 檔案。</span><span class="sxs-lookup"><span data-stu-id="30af0-204">You must specify a directory as the source location in the previous command; you can't specify an individual PST file.</span></span> <span data-ttu-id="30af0-205">系統會上傳來源目錄中的所有 PST 檔案。</span><span class="sxs-lookup"><span data-stu-id="30af0-205">All PST files in the source directory will be uploaded.</span></span>
 
    <span data-ttu-id="30af0-206">下表說明了 AzCopy.exe 參數與其需要的值。</span><span class="sxs-lookup"><span data-stu-id="30af0-206">The following table describes the AzCopy.exe parameters and their required values.</span></span> <span data-ttu-id="30af0-207">您在先前步驟中所取得的資訊，會在這些參數內的值中使用。</span><span class="sxs-lookup"><span data-stu-id="30af0-207">The information you obtained in the previous step is used in the values for these parameters.</span></span>
    
    |<span data-ttu-id="30af0-208">**參數**</span><span class="sxs-lookup"><span data-stu-id="30af0-208">**Parameter**</span></span>|<span data-ttu-id="30af0-209">**描述**</span><span class="sxs-lookup"><span data-stu-id="30af0-209">**Description**</span></span>|<span data-ttu-id="30af0-210">**範例**</span><span class="sxs-lookup"><span data-stu-id="30af0-210">**Example**</span></span>|
    |:-----|:-----|:-----|
    | `/Source:` <br/> |<span data-ttu-id="30af0-211">指定貴組織內的來源目錄，而其包含將上傳至 Office365 的 PST 檔案。</span><span class="sxs-lookup"><span data-stu-id="30af0-211">Specifies the source directory in your organization that contains the PST files that will be uploaded to Office 365.</span></span>  <br/> <span data-ttu-id="30af0-212">請務必使用雙引號 (" ") 括住此參數的值。</span><span class="sxs-lookup"><span data-stu-id="30af0-212">Be sure to surround the value of this parameter with double-quotation marks (" ").</span></span>  <br/> | `/Source:"\\FILESERVER01\PSTs"` <br/> |
    | `/Dest:` <br/> |<span data-ttu-id="30af0-213">指定您在步驟 1 中所取得的 SAS URL。</span><span class="sxs-lookup"><span data-stu-id="30af0-213">Specifies the SAS URL that you obtained in Step 1.</span></span>  <br/> <span data-ttu-id="30af0-214">請務必使用雙引號 (" ") 括住此參數的值。</span><span class="sxs-lookup"><span data-stu-id="30af0-214">Be sure to surround the value of this parameter with double-quotation marks (" ").</span></span><br/><br/><span data-ttu-id="30af0-215">**注意事項：** 如果您在指令碼或批次檔案中使用 SAS URL，必須注意需要逸出的特定字元。</span><span class="sxs-lookup"><span data-stu-id="30af0-215">**Note:** If you use the SAS URL in a script or batch file, you need to watch out for certain characters that need to be escaped.</span></span> <span data-ttu-id="30af0-216">例如，您必須將 `%` 變更為 `%%`，並且將 `&` 變更為 `^&`。</span><span class="sxs-lookup"><span data-stu-id="30af0-216">For example, you have to change `%` to `%%` and change `&` to `^&`.</span></span><br/><br/><span data-ttu-id="30af0-217">**秘訣：**(可選) 您可以在 Azure 儲存體位置指定子資料夾以上傳 PST 檔案。</span><span class="sxs-lookup"><span data-stu-id="30af0-217">**Tip:** (Optional) You can specify a subfolder in the Azure Storage location to upload the PST files to.</span></span> <span data-ttu-id="30af0-218">您可以透過在 SAS URL 中新增子資料夾位置 (在 “ingestiondata” 之後) 來執行此操作。</span><span class="sxs-lookup"><span data-stu-id="30af0-218">You do this by adding a subfolder location (after "ingestiondata") in the SAS URL.</span></span> <span data-ttu-id="30af0-219">第一個範例未指定子資料夾。</span><span class="sxs-lookup"><span data-stu-id="30af0-219">The first example doesn't specify a subfolder.</span></span> <span data-ttu-id="30af0-220">這表示 PST 將會上傳到 Azure 儲存體位置的根目錄 (名為 *ingestiondata*)。</span><span class="sxs-lookup"><span data-stu-id="30af0-220">That means the PSTs are uploaded to the root (named  *ingestiondata*) of the Azure Storage location.</span></span> <span data-ttu-id="30af0-221">第二個範例會將 PST 檔案上傳到 Azure 儲存體位置的根目錄的子資料夾中 (名為 *PSTFiles*)。</span><span class="sxs-lookup"><span data-stu-id="30af0-221">The second example uploads the PST files to a subfolder (named  *PSTFiles*) in the root of the Azure Storage location.</span></span>  <br/> | `/Dest:"https://3c3e5952a2764023ad14984.blob.core.windows.net/ingestiondata?sv=2012-02-12&amp;se=9999-12-31T23%3A59%3A59Z&amp;sr=c&amp;si=IngestionSasForAzCopy201601121920498117&amp;sig=Vt5S4hVzlzMcBkuH8bH711atBffdrOS72TlV1mNdORg%3D"` <br/> <span data-ttu-id="30af0-222">或</span><span class="sxs-lookup"><span data-stu-id="30af0-222">Or</span></span>  <br/>  `/Dest:"https://3c3e5952a2764023ad14984.blob.core.windows.net/ingestiondata/PSTFiles?sv=2012-02-12&amp;se=9999-12-31T23%3A59%3A59Z&amp;sr=c&amp;si=IngestionSasForAzCopy201601121920498117&amp;sig=Vt5S4hVzlzMcBkuH8bH711atBffdrOS72TlV1mNdORg%3D"` <br/> |
    | `/V:` <br/> |<span data-ttu-id="30af0-p128">將詳細狀態訊息輸出到記錄檔。根據預設，在 %LocalAppData%\Microsoft\Azure\AzCopy 中，詳細資訊記錄檔的名稱為 AzCopyVerbose.log。如果您在此選項中指定現有檔案位置，詳細資訊記錄檔會附加至該檔案。</span><span class="sxs-lookup"><span data-stu-id="30af0-p128">Outputs verbose status messages into a log file. By default, the verbose log file is named AzCopyVerbose.log in %LocalAppData%\Microsoft\Azure\AzCopy. If you specify an existing file location for this option, the verbose log will be appended to that file.</span></span>  <br/> <span data-ttu-id="30af0-226">請務必使用雙引號 (" ") 括住此參數的值。</span><span class="sxs-lookup"><span data-stu-id="30af0-226">Be sure to surround the value of this parameter with double-quotation marks (" ").</span></span>  <br/> | `/V:"c:\Users\Admin\Desktop\Uploadlog.log"` <br/> |
    | `/S` <br/> |<span data-ttu-id="30af0-227">此選擇性參數會指定遞迴模式，因此 AzCopy 工具會複製位於來源目錄之子資料夾下的 PST 檔案，該來源目錄是由 `/Source:` 參數所指定。</span><span class="sxs-lookup"><span data-stu-id="30af0-227">This optional switch specifies the recursive mode so that the AzCopy tool copies PSTs files that are located in subfolders in the source directory that is specified by the  `/Source:` parameter.</span></span>  <br/> <span data-ttu-id="30af0-228">**注意：** 若您包含此參數，在上傳完成後，子資料夾中的 PST 檔案將在 Azure 儲存體位置中具有不同的檔案路徑名稱。</span><span class="sxs-lookup"><span data-stu-id="30af0-228">**Note:** If you include this switch, PST files in subfolders will have a different file pathname in the Azure Storage location after they're uploaded.</span></span> <span data-ttu-id="30af0-229">您將必須在於步驟 4 中建立的 CSV 檔案中，指定確切的檔案路徑名稱。</span><span class="sxs-lookup"><span data-stu-id="30af0-229">You'll have to specify the exact file pathname in the CSV file that you create in Step 4.</span></span>  <br/> | `/S` <br/> |
    | `/Y` <br/> |<span data-ttu-id="30af0-230">當將 PST 檔案上傳到 Azure 儲存體位置時，此必要參數可允許使用唯寫 SA 權杖。</span><span class="sxs-lookup"><span data-stu-id="30af0-230">This required switch allows the use of write-only SAS tokens when you upload the PST files to the Azure Storage location.</span></span> <span data-ttu-id="30af0-231">您在步驟 1 中取得的 SAS URL (並由 `/Dest:` 參數指定) 就是唯寫 SA URL，因此您必須包含此參數。</span><span class="sxs-lookup"><span data-stu-id="30af0-231">The SAS URL you obtained in step 1 (and specified in  `/Dest:` parameter) is a write-only SAS URL, which is why you must include this switch.</span></span> <span data-ttu-id="30af0-232">唯寫 SA URL 不會防止您使用 Azure 儲存體總管來檢視上傳到 Azure 儲存體位置的 PST 檔案清單。</span><span class="sxs-lookup"><span data-stu-id="30af0-232">A write-only SAS URL won't prevent you from using the Azure Storage Explorer to view a list of the PST files uploaded to the Azure Storage location.</span></span>  <br/> | `/Y` <br/> |

<span data-ttu-id="30af0-233">這是 AzCopy.exe 工具針對各個參數使用實際值的語法範例︰</span><span class="sxs-lookup"><span data-stu-id="30af0-233">Here's an example of the syntax for the AzCopy.exe tool using actual values for each parameter:</span></span>
    
```powershell
  AzCopy.exe /Source:"\\FILESERVER1\PSTs" /Dest:"https://3c3e5952a2764023ad14984.blob.core.windows.net/ingestiondata?sv=2012-02-12&amp;se=9999-12-31T23%3A59%3A59Z&amp;sr=c&amp;si=IngestionSasForAzCopy201601121920498117&amp;sig=Vt5S4hVzlzMcBkuH8bH711atBffdrOS72TlV1mNdORg%3D" /V:"c:\Users\Admin\Desktop\AzCopy1.log" /Y
```

<span data-ttu-id="30af0-p131">在您執行命令後，便會顯示 PST 檔案上傳進度的狀態訊息。最終狀態訊息會顯示已成功上傳的檔案總數。</span><span class="sxs-lookup"><span data-stu-id="30af0-p131">After you run the command, status messages are displayed that show the progress of uploading the PST files. A final status message shows the total number of files that were successfully uploaded.</span></span>

> [!TIP]
> <span data-ttu-id="30af0-236">在您成功地執行 AzCopy.exe 命令，且確認所有的參數皆正確之後，將命令列語法複本儲存至相同的 (受保護) 檔案內，也就是您在步驟 1 複製所取得資訊的檔案。</span><span class="sxs-lookup"><span data-stu-id="30af0-236">After you successfully run the AzCopy.exe command and verify that all the parameters are correct, save a copy of the command line syntax to the same (secured) file where you copied the information you obtained in Step 1.</span></span> <span data-ttu-id="30af0-237">每當您想要執行 AzCopy.exe 工具將 PST 檔案上傳至 Office365 時，您就可以複製此命令並在「命令提示字元」內貼上。</span><span class="sxs-lookup"><span data-stu-id="30af0-237">Then you can copy and paste this command in a Command Prompt each time that you want to run the AzCopy.exe tool to upload PST files to Office 365.</span></span> <span data-ttu-id="30af0-238">唯一您可能需要變更的值，就是 `/Source:` 參數的值。</span><span class="sxs-lookup"><span data-stu-id="30af0-238">The only value you might have to change are the ones for the  `/Source:` parameter.</span></span> <span data-ttu-id="30af0-239">這視 PST 檔案所在的來源目錄而定。</span><span class="sxs-lookup"><span data-stu-id="30af0-239">This depends on the source directory where the PST files are located.</span></span>

## <a name="optional-step-3-view-a-list-of-the-pst-files-uploaded-to-office-365"></a><span data-ttu-id="30af0-240">(選用) 步驟 3：檢視上傳到 Office 365 的 PST 檔案清單</span><span class="sxs-lookup"><span data-stu-id="30af0-240">(Optional) Step 3: View a list of the PST files uploaded to Office 365</span></span>

<span data-ttu-id="30af0-241">這是一個選擇性的步驟，您可以安裝並使用 Microsoft Azure 儲存體總管 (這是免費的開放原始碼工具) 來檢視您已上傳到 Azure blob 的 PST 檔案清單。</span><span class="sxs-lookup"><span data-stu-id="30af0-241">As an optional step, you can install and use the Microsoft Azure Storage Explorer (which is a free, open-source tool) to view the list of the PST files that you've uploaded to the Azure blob.</span></span> <span data-ttu-id="30af0-242">以下為執行這項作業的兩個好處：</span><span class="sxs-lookup"><span data-stu-id="30af0-242">There are two good reasons to do this:</span></span>
  
- <span data-ttu-id="30af0-243">確認您組織中共用資料夾或檔案伺服器的 PST 檔案已成功上傳到 Azure blob。</span><span class="sxs-lookup"><span data-stu-id="30af0-243">Verify that PST files from the shared folder or file server in your organization were successfully uploaded to the Azure blob.</span></span>
    
- <span data-ttu-id="30af0-244">確認每個上傳到 Azure blob 之 PST 檔案的檔名 (以及子資料夾路徑名稱，如果您有採用)。</span><span class="sxs-lookup"><span data-stu-id="30af0-244">Verify the filename (and the subfolder pathname if you included one) for each PST file uploaded to the Azure blob.</span></span> <span data-ttu-id="30af0-245">當您要在下一個步驟中建立 PST 對應檔案時，這項功能很有幫助，因為您必須指定每個 PST 檔案的資料夾路徑名稱及檔名。</span><span class="sxs-lookup"><span data-stu-id="30af0-245">This is helpful when you're creating the PST mapping file in the next step because you have to specify both the folder pathname and filename for each PST file.</span></span> <span data-ttu-id="30af0-246">驗證這些名稱有助於減少 PST 對應檔中的潛在錯誤。</span><span class="sxs-lookup"><span data-stu-id="30af0-246">Verifying these names can help reduce potential errors in your PST mapping file.</span></span>
    
<span data-ttu-id="30af0-247">Microsoft Azure 儲存體總管位於 [預覽] 中。</span><span class="sxs-lookup"><span data-stu-id="30af0-247">The Microsoft Azure Storage Explorer is in Preview.</span></span>
  
> [!IMPORTANT]
> <span data-ttu-id="30af0-248">您無法使用 Azure 儲存體總管來上傳或修改 PST 檔案。</span><span class="sxs-lookup"><span data-stu-id="30af0-248">You can't use the Azure Storage Explorer to upload or modify PST files.</span></span> <span data-ttu-id="30af0-249">使用 AzCopy 將 PST 檔案匯入到 Office 365 是唯一支援的方法。</span><span class="sxs-lookup"><span data-stu-id="30af0-249">The only supported method for importing PST files to Office 365 is to use AzCopy.</span></span> <span data-ttu-id="30af0-250">此外，您無法刪除已上傳到 Azure Blob 的 PST 檔案。</span><span class="sxs-lookup"><span data-stu-id="30af0-250">Also, you can't delete PST files that you've uploaded to the Azure blob.</span></span> <span data-ttu-id="30af0-251">如果您嘗試刪除 PST 檔案，您會收到沒有必要權限的相關錯誤。</span><span class="sxs-lookup"><span data-stu-id="30af0-251">If you try to delete a PST file, you'll receive an error about not having the required permissions.</span></span> <span data-ttu-id="30af0-252">請注意，所有的 PST 檔案會自動從您的 Azure 儲存體刪除。</span><span class="sxs-lookup"><span data-stu-id="30af0-252">Note that all PST files are automatically deleted from your Azure storage area.</span></span> <span data-ttu-id="30af0-253">如果目前沒有進行中的匯入工作，則 **ingestiondata** 容器中的所有 PST 檔案都會在最近的匯入工作建立完成後 30 天刪除。</span><span class="sxs-lookup"><span data-stu-id="30af0-253">If there are no import jobs in progress, then all PST files in the **ingestiondata** container are deleted 30 days after the most recent import job was created.</span></span>
  
<span data-ttu-id="30af0-254">若要安裝 Azure 儲存體總管並連線到您 Azure 儲存體區域：</span><span class="sxs-lookup"><span data-stu-id="30af0-254">To install the Azure Storage Explorer and connect to your Azure Storage area:</span></span>
  
1. <span data-ttu-id="30af0-255">下載並安裝 [Microsoft Azure 儲存體總管工具](https://go.microsoft.com/fwlink/p/?LinkId=544842)。</span><span class="sxs-lookup"><span data-stu-id="30af0-255">Download and install the [Microsoft Azure Storage Explorer tool](https://go.microsoft.com/fwlink/p/?LinkId=544842).</span></span>
    
2. <span data-ttu-id="30af0-256">啟動 Microsoft Azure 儲存體總管工具、以滑鼠右鍵按一下左邊窗格中的 [儲存體帳戶]\*\*\*\*，然後再按一下 [連線至 Azure 儲存體]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="30af0-256">Start the Microsoft Azure Storage Explorer, right-click **Storage Accounts** in the left pane, and then click **Connect to Azure Storage**.</span></span>
    
    ![以滑鼠右鍵按一下 [儲存體帳戶]，接著按一下 [連線至 Azure 儲存體]](../media/75b80cc3-c336-4f96-ad32-54ac9b96a7af.png)
  
3. <span data-ttu-id="30af0-258">按一下 [使用共用存取簽章 (SAS) URI 或連線字串]\*\*\*\*，然後按一下 [下一步]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="30af0-258">Click **Use a shared access signature (SAS) URI or connection string** and click **Next**.</span></span>
    
4. <span data-ttu-id="30af0-259">按一下 [使用 SAS URI]\*\*\*\*，將您於步驟 1 取得的 SAS URL 貼上 [URI]\*\*\*\* 下的方塊中，然後按一下 [下一步]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="30af0-259">Click **Use a SAS URI**, paste the SAS URL that you obtained in Step 1 into the box under **URI**, and then click **Next**.</span></span>
    
5. <span data-ttu-id="30af0-260">在 [連線摘要]\*\*\*\* 頁面上，您可檢閱連線資訊、然後按一下 [連線]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="30af0-260">On the **Connection summary** page, you can review the connection information, and then click **Connect**.</span></span>
    
    <span data-ttu-id="30af0-261">**Ingestiondata** 容器已開啟。</span><span class="sxs-lookup"><span data-stu-id="30af0-261">The **ingestiondata** container is opened.</span></span> <span data-ttu-id="30af0-262">其中包含您在步驟 2 中上傳的 PST 檔案。</span><span class="sxs-lookup"><span data-stu-id="30af0-262">It contains the PST files that you uploaded in Step 2.</span></span> <span data-ttu-id="30af0-263">**ingestiondata** 容器位於 [儲存體帳戶]\*\*\*\* \> \*\* (附加 SAS 的服務) \> [Blob 容器]\*\*\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="30af0-263">The **ingestiondata** container is located under **Storage Accounts** \> **(SAS-Attached Services)** \> **Blob Containers**.</span></span> 
    
    ![[Azure 儲存體總管] 會顯示您上傳的 PST 檔案清單](../media/12376fed-13a5-4a09-8fe6-e819e011b334.png)
  
6. <span data-ttu-id="30af0-265">當您使用 Microsoft Azure 儲存體總管完成後，以滑鼠右鍵按一下 [ingestiondata]\*\*\*\*，然後按一下 [中斷連線]\*\*\*\* 來中斷 Azure 儲存體區域的連線。</span><span class="sxs-lookup"><span data-stu-id="30af0-265">When you're finished using the Microsoft Azure Storage Explorer, right-click **ingestiondata**, and then click **Detach** to disconnect from your Azure Storage area.</span></span> <span data-ttu-id="30af0-266">否則，您會在下一次嘗試附加時收到錯誤。</span><span class="sxs-lookup"><span data-stu-id="30af0-266">Otherwise, you'll receive an error the next time you try to attach.</span></span> 
    
    ![以滑鼠右鍵按一下 [擷取]，然後按一下 [中斷連線]，以中斷與 Azure 儲存體區域之間的連線](../media/1e8e5e95-4215-4ce4-a13d-ab5f826a0510.png)
  
## <a name="step-4-create-the-pst-import-mapping-file"></a><span data-ttu-id="30af0-268">步驟 4：建立 PST 匯入對應檔案</span><span class="sxs-lookup"><span data-stu-id="30af0-268">Step 4: Create the PST Import mapping file</span></span>

<span data-ttu-id="30af0-269">在已為 Office 365 組織將 PST 檔案上傳至 Azure 儲存體位置後，下一步便是建立逗點分隔值 (CSV) 檔案，以指定 PST 檔案將匯入至哪些使用者信箱。</span><span class="sxs-lookup"><span data-stu-id="30af0-269">After the PST files have been uploaded to the Azure Storage location for your Office 365 organization, the next step is to create a comma-separated value (CSV) file that specifies which user mailboxes the PST files will be imported to.</span></span> <span data-ttu-id="30af0-270">當您建立 PST 匯入工作時，您將會在下一個步驟提交 CSV 檔案。</span><span class="sxs-lookup"><span data-stu-id="30af0-270">You'll submit this CSV file in the next step when you create a PST Import job.</span></span>
  
1. <span data-ttu-id="30af0-271">[下載 PST 匯入對應檔案的副本](https://go.microsoft.com/fwlink/p/?LinkId=544717)。</span><span class="sxs-lookup"><span data-stu-id="30af0-271">[Download a copy of the PST Import mapping file](https://go.microsoft.com/fwlink/p/?LinkId=544717).</span></span>
    
2. <span data-ttu-id="30af0-p139">開啟或儲存 CSV 檔案到您的本機電腦。下列範例顯示了一個已完成的 PST 匯入對應檔案 (在「記事本」中開啟)。若使用 Microsoft Excel 來編輯 CSV 檔案會較為簡單。</span><span class="sxs-lookup"><span data-stu-id="30af0-p139">Open or save the CSV file to your local computer. The following example shows a completed PST Import mapping file (opened in NotePad). It's much easier to use Microsoft Excel to edit the CSV file.</span></span>

    ```text
    Workload,FilePath,Name,Mailbox,IsArchive,TargetRootFolder,ContentCodePage,SPFileContainer,SPManifestContainer,SPSiteUrl
    Exchange,,annb.pst,annb@contoso.onmicrosoft.com,FALSE,/,,,,
    Exchange,,annb_archive.pst,annb@contoso.onmicrosoft.com,TRUE,,,,,
    Exchange,,donh.pst,donh@contoso.onmicrosoft.com,FALSE,/,,,,
    Exchange,,donh_archive.pst,donh@contoso.onmicrosoft.com,TRUE,,,,,
    Exchange,PSTFiles,pilarp.pst,pilarp@contoso.onmicrosoft.com,FALSE,/,,,,
    Exchange,PSTFiles,pilarp_archive.pst,pilarp@contoso.onmicrosoft.com,TRUE,/ImportedPst,,,,
    Exchange,PSTFiles,tonyk.pst,tonyk@contoso.onmicrosoft.com,FALSE,,,,,
    Exchange,PSTFiles,tonyk_archive.pst,tonyk@contoso.onmicrosoft.com,TRUE,/ImportedPst,,,,
    Exchange,PSTFiles,zrinkam.pst,zrinkam@contoso.onmicrosoft.com,FALSE,,,,,
    Exchange,PSTFiles,zrinkam_archive.pst,zrinkam@contoso.onmicrosoft.com,TRUE,/ImportedPst,,,,
    ```
    
    <span data-ttu-id="30af0-275">CSV 檔案的第一列或「標題列」會列出參數，PST 匯入服務將使用這些參數來匯入 PST 檔案至使用者信箱。</span><span class="sxs-lookup"><span data-stu-id="30af0-275">The first row, or header row, of the CSV file lists the parameters that will be used by the PST Import service to import the PST files to user mailboxes.</span></span> <span data-ttu-id="30af0-276">每個參數名稱都是以逗號分隔。</span><span class="sxs-lookup"><span data-stu-id="30af0-276">Each parameter name is separated by a comma.</span></span> <span data-ttu-id="30af0-277">在標題列下的每一列，代表了要匯入 PST 檔案至特定信箱的參數值。</span><span class="sxs-lookup"><span data-stu-id="30af0-277">Each row under the header row represents the parameter values for importing a PST file to a specific mailbox.</span></span> <span data-ttu-id="30af0-278">您需要為每個要匯入至使用者信箱的 PST 檔案設定一列。</span><span class="sxs-lookup"><span data-stu-id="30af0-278">You need a row for each PST file that you want to import to a user mailbox.</span></span> <span data-ttu-id="30af0-279">請務必在對應檔案中，使用您的實際資料來取代預留位置資料。</span><span class="sxs-lookup"><span data-stu-id="30af0-279">Be sure to replace the placeholder data in the mapping file with your actual data.</span></span>

   <span data-ttu-id="30af0-280">**請注意：** 不要在標頭列以及 SharePoint 參數中作任何變更，在 PST 匯入過程中會忽略這些項目。</span><span class="sxs-lookup"><span data-stu-id="30af0-280">**Note:** Don't change anything in the header row, including the SharePoint parameters; they will be ignored during the PST Import process.</span></span> 

 3. <span data-ttu-id="30af0-281">使用下列表格的資訊，將所需的資訊填入 CSV 檔案。</span><span class="sxs-lookup"><span data-stu-id="30af0-281">Use the information in the following table to populate the CSV file with the required information.</span></span>


    |<span data-ttu-id="30af0-282">**參數**</span><span class="sxs-lookup"><span data-stu-id="30af0-282">**Parameter**</span></span>|<span data-ttu-id="30af0-283">**描述**</span><span class="sxs-lookup"><span data-stu-id="30af0-283">**Description**</span></span>|<span data-ttu-id="30af0-284">**範例**</span><span class="sxs-lookup"><span data-stu-id="30af0-284">**Example**</span></span>|
    |:-----|:-----|:-----|
    | `Workload` <br/> |<span data-ttu-id="30af0-285">指定資料將會匯入至哪個 Office 365 服務。</span><span class="sxs-lookup"><span data-stu-id="30af0-285">Specifies the Office 365 service that data will be imported to.</span></span> <span data-ttu-id="30af0-286">若要將 PST 檔案匯入至使用者信箱，請使用 `Exchange`。</span><span class="sxs-lookup"><span data-stu-id="30af0-286">To import PST files to user mailboxes, use  `Exchange`.</span></span>  <br/> | `Exchange` <br/> |
    | `FilePath` <br/> |<span data-ttu-id="30af0-287">指定在 Azure 儲存體位置的資料夾位置，也就是在步驟 2 中上傳 PST 檔案的位置。</span><span class="sxs-lookup"><span data-stu-id="30af0-287">Specifies the folder location in the Azure Storage location that you uploaded the PST files to in Step 2.</span></span>  <br/> <span data-ttu-id="30af0-288">若您並未在步驟 2 的 `/Dest:` 參數中加入選擇性子資料夾名稱，請在 CSV 檔案將此參數保留空白。</span><span class="sxs-lookup"><span data-stu-id="30af0-288">If you didn't include an optional subfolder name in the SAS URL in the  `/Dest:` parameter in Step 2, leave this parameter blank in the CSV file.</span></span> <span data-ttu-id="30af0-289">如果您包含子資料夾名稱，則請於此參數內指定 (請參閱第二個範例)。</span><span class="sxs-lookup"><span data-stu-id="30af0-289">If you included a subfolder name, specify it in this parameter (see the second example).</span></span> <span data-ttu-id="30af0-290">此參數值區分大小寫。</span><span class="sxs-lookup"><span data-stu-id="30af0-290">The value for this parameter is case-sensitive.</span></span>  <br/> <span data-ttu-id="30af0-291">或者，「不要」\*\* 在 `FilePath` 參數值中包含 "ingestiondata"。</span><span class="sxs-lookup"><span data-stu-id="30af0-291">Either way,  *don't*  include "ingestiondata" in the value for the  `FilePath` parameter.</span></span>  <br/><br/> <span data-ttu-id="30af0-292">**重要：** 如果在步驟 2 的 `/Dest:` 參數的 SAS URL 中包含可選的子資料夾名稱，則檔案路徑名稱的大小寫必須與您使用的大小寫相同。</span><span class="sxs-lookup"><span data-stu-id="30af0-292">**Important:** The case for the file path name must be the same as the case you used if you included an optional subfolder name in the SAS URL in the  `/Dest:` parameter in Step 2.</span></span> <span data-ttu-id="30af0-293">例如，如果您在步驟 2 中使用 `PSTFiles` 作為子資料夾名稱，然後在 CSV 檔案的 `FilePath` 參數中使用 `pstfiles`，則 PST檔案的匯入將失敗。</span><span class="sxs-lookup"><span data-stu-id="30af0-293">For example, if you used  `PSTFiles` for the subfolder name in Step 2 and then use  `pstfiles` in the  `FilePath` parameter in CSV file, the import for the PST file will fail.</span></span> <span data-ttu-id="30af0-294">請務必在這兩個案例中使用相同的大小寫。</span><span class="sxs-lookup"><span data-stu-id="30af0-294">Be sure to use the same case in both instances.</span></span>  <br/> |<span data-ttu-id="30af0-295">(保留空白)</span><span class="sxs-lookup"><span data-stu-id="30af0-295">(leave blank)</span></span>  <br/> <span data-ttu-id="30af0-296">或</span><span class="sxs-lookup"><span data-stu-id="30af0-296">Or</span></span>  <br/>  `PSTFiles` <br/> |
    | `Name` <br/> |<span data-ttu-id="30af0-297">指定將匯入至使用者信箱的 PST 檔案名稱。</span><span class="sxs-lookup"><span data-stu-id="30af0-297">Specifies the name of the PST file that will be imported to the user mailbox.</span></span> <span data-ttu-id="30af0-298">此參數值區分大小寫。</span><span class="sxs-lookup"><span data-stu-id="30af0-298">The value for this parameter is case-sensitive.</span></span>  <br/> <br/><span data-ttu-id="30af0-299">**重要：** CSV 檔案中 PST 檔案名稱的大小寫必須與步驟 2 中上傳到 Azure 儲存體位置的 PST 檔案相同。</span><span class="sxs-lookup"><span data-stu-id="30af0-299">**Important:** The case for the PST file name in the CSV file must be the same as the PST file that was uploaded to the Azure Storage location in Step 2.</span></span> <span data-ttu-id="30af0-300">例如，如果在 CSV 檔案中的 `Name` 參數中使用 `annb.pst`，但實際的 PST 檔案名稱為 `AnnB.pst`，則該 PST 檔案的匯入將失敗。</span><span class="sxs-lookup"><span data-stu-id="30af0-300">For example, if you use  `annb.pst` in the  `Name` parameter in the CSV file, but the name of the actual PST file is  `AnnB.pst`, the import for that PST file will fail.</span></span> <span data-ttu-id="30af0-301">請確認 CSV 檔案中的 PST 名稱使用與實際 PST 檔案相同的大小寫。</span><span class="sxs-lookup"><span data-stu-id="30af0-301">Be sure that the name of the PST in the CSV file uses the same case as the actual PST file.</span></span>  <br/> | `annb.pst` <br/> |
    | `Mailbox` <br/> |<span data-ttu-id="30af0-302">指定將匯入 PST 檔案的信箱電子郵件地址。</span><span class="sxs-lookup"><span data-stu-id="30af0-302">Specifies the email address of the mailbox that the PST file will be imported to.</span></span> <span data-ttu-id="30af0-303">您無法指定公用資料夾，因為 PST 匯入服務不支援將 PST 檔案匯入公用資料夾。</span><span class="sxs-lookup"><span data-stu-id="30af0-303">You can't specify a public folder because the PST Import Service doesn't support importing PST files to public folders.</span></span>  <br/> <span data-ttu-id="30af0-304">若要將 PST 檔案匯入非作用中的信箱，您必須為此參數指定信箱 GUID。</span><span class="sxs-lookup"><span data-stu-id="30af0-304">To import a PST file to an inactive mailbox, you have to specify the mailbox GUID for this parameter.</span></span> <span data-ttu-id="30af0-305">若要取得此 GUID，請在 Exchange Online 中執行下列 PowerShell 命令：`Get-Mailbox <identity of inactive mailbox> -InactiveMailboxOnly | FL Guid`</span><span class="sxs-lookup"><span data-stu-id="30af0-305">To obtain this GUID, run the following PowerShell command in Exchange Online:  `Get-Mailbox <identity of inactive mailbox> -InactiveMailboxOnly | FL Guid`</span></span> <br/> <br/><span data-ttu-id="30af0-306">**注意：** 有時候，您可能會有多個信箱具有相同的電子郵件地址，其中一個信箱是作用中信箱，另一個信箱則處於虛刪除 (或非作用中) 狀態。</span><span class="sxs-lookup"><span data-stu-id="30af0-306">**Note:** Sometimes you might have multiple mailboxes with the same email address, where one mailbox is an active mailbox and the other mailbox is in a soft-deleted (or inactive) state.</span></span> <span data-ttu-id="30af0-307">在這些情況下，您必須指定信箱 GUID，以唯一識別要匯入 PST 檔案的目的地信箱。</span><span class="sxs-lookup"><span data-stu-id="30af0-307">In these situations, you have to specify the mailbox GUID to uniquely identify the mailbox to import the PST file to.</span></span> <span data-ttu-id="30af0-308">若要取得作用中信箱的此 GUID，請執行下列 PowerShell 命令：`Get-Mailbox <identity of active mailbox> | FL Guid`</span><span class="sxs-lookup"><span data-stu-id="30af0-308">To obtain this GUID for active mailboxes, run the following PowerShell command:  `Get-Mailbox <identity of active mailbox> | FL Guid`.</span></span> <span data-ttu-id="30af0-309">若要取得虛刪除 (或非作用中) 信箱的 GUID，請執行此命令：`Get-Mailbox <identity of soft-deleted or inactive mailbox> -SoftDeletedMailbox | FL Guid`。</span><span class="sxs-lookup"><span data-stu-id="30af0-309">To obtain the GUID for soft-deleted (or inactive) mailboxes, run this command  `Get-Mailbox <identity of soft-deleted or inactive mailbox> -SoftDeletedMailbox | FL Guid`.</span></span>  <br/> | `annb@contoso.onmicrosoft.com` <br/> <span data-ttu-id="30af0-310">或</span><span class="sxs-lookup"><span data-stu-id="30af0-310">Or</span></span>  <br/>  `2d7a87fe-d6a2-40cc-8aff-1ebea80d4ae7` <br/> |
    | `IsArchive` <br/> | <span data-ttu-id="30af0-311">指定是否要匯入 PST 檔案至使用者的封存信箱。</span><span class="sxs-lookup"><span data-stu-id="30af0-311">Specifies whether to import the PST file to the user's archive mailbox.</span></span> <span data-ttu-id="30af0-312">其中有兩個選項：</span><span class="sxs-lookup"><span data-stu-id="30af0-312">There are two options:</span></span>  <br/><br/><span data-ttu-id="30af0-313">**FALSE：** 將 PST 檔案匯入使用者的主要信箱。</span><span class="sxs-lookup"><span data-stu-id="30af0-313">**FALSE:** Imports the PST file to the user's primary mailbox.</span></span>  <br/> <span data-ttu-id="30af0-314">**TRUE：** 將 PST 檔案匯入使用者的封存信箱。</span><span class="sxs-lookup"><span data-stu-id="30af0-314">**TRUE:** Imports the PST file to the user's archive mailbox.</span></span> <span data-ttu-id="30af0-315">這會假設[使用者的封存信箱已啟用](enable-archive-mailboxes.md)。</span><span class="sxs-lookup"><span data-stu-id="30af0-315">This assumes that the [user's archive mailbox is enabled](enable-archive-mailboxes.md).</span></span> <br/><br/><span data-ttu-id="30af0-316">如果您將此參數設為 `TRUE`，則使用者的封存信箱不會啟用，該使用者的匯入工作會因此失敗。</span><span class="sxs-lookup"><span data-stu-id="30af0-316">If you set this parameter to  `TRUE` and the user's archive mailbox isn't enabled, the import for that user will fail.</span></span> <span data-ttu-id="30af0-317">如果某個使用者的匯入工作失敗 (原因是其封存並未啟用，且此屬性設為 `TRUE`)，匯入工作中的其他使用者不會受到影響。</span><span class="sxs-lookup"><span data-stu-id="30af0-317">If an import fails for one user (because their archive isn't enabled and this property is set to  `TRUE`), the other users in the import job won't be affected.</span></span>  <br/>  <span data-ttu-id="30af0-318">如果您將此參數保留空白，則 PST 檔案會匯入到使用者的主要信箱。</span><span class="sxs-lookup"><span data-stu-id="30af0-318">If you leave this parameter blank, the PST file is imported to the user's primary mailbox.</span></span>  <br/> <br/><span data-ttu-id="30af0-319">**注意：** 若要替主要信箱是內部部署的使用者將 PST 檔案匯入至雲端式封存信箱，只要為此參數指定 `TRUE`，然後替 `Mailbox` 參數指定該使用者之內部部署信箱的電子郵件地址即可。</span><span class="sxs-lookup"><span data-stu-id="30af0-319">**Note:** To import a PST file to a cloud-based archive mailbox for a user whose primary mailbox is on-premises, just specify  `TRUE` for this parameter and specify the email address for the user's on-premises mailbox for the  `Mailbox` parameter.</span></span>  <br/> | `FALSE` <br/> <span data-ttu-id="30af0-320">或</span><span class="sxs-lookup"><span data-stu-id="30af0-320">Or</span></span>  <br/>  `TRUE` <br/> |
    | `TargetRootFolder` <br/> | <span data-ttu-id="30af0-321">指定要匯入 PST 檔案的信箱資料夾。</span><span class="sxs-lookup"><span data-stu-id="30af0-321">Specifies the mailbox folder that the PST file is imported to.</span></span>  <br/> <br/> <span data-ttu-id="30af0-322">若此參數保留空白，PST 檔案將會匯入至名為「已匯入」\*\*\*\* 的新資料夾，其位於信箱的根層級 (與「收件匣」資料夾及其他預設信箱資料夾為相同層級)。</span><span class="sxs-lookup"><span data-stu-id="30af0-322">If you leave this parameter blank, the PST file will be imported to a new folder named **Imported** at the root level of the mailbox (the same level as the Inbox folder and the other default mailbox folders).</span></span>  <br/> <br/> <span data-ttu-id="30af0-323">如果您指定 `/`，PST 檔案中的資料夾和項目會匯入目標信箱或封存中的資料夾結構的最上層。</span><span class="sxs-lookup"><span data-stu-id="30af0-323">If you specify  `/`, the folders and items in the PST file are imported to the top of the folder structure in the target mailbox or archive.</span></span> <span data-ttu-id="30af0-324">如果目標信箱中有資料夾 (例如，[收件匣]、[寄件備份] 和 [刪除的郵件] 等預設資料夾)，系統會將 PST 中該資料夾的項目合併到目標信箱現有的資料夾。</span><span class="sxs-lookup"><span data-stu-id="30af0-324">If a folder exists in the target mailbox (for example, default folders such as Inbox, Sent Items, and Deleted Items), the items in that folder in the PST are merged into the existing folder in the target mailbox.</span></span> <span data-ttu-id="30af0-325">例如，如果 PST 檔案包含 [收件匣] 資料夾，該資料夾中的項目會匯入到目標信箱中的 [收件匣] 資料夾。</span><span class="sxs-lookup"><span data-stu-id="30af0-325">For example, if the PST file contains an Inbox folder, items in that folder are imported to the Inbox folder in the target mailbox.</span></span> <span data-ttu-id="30af0-326">如果新資料夾不存在於目標信箱的資料夾結構中，則會建立新的資料夾。</span><span class="sxs-lookup"><span data-stu-id="30af0-326">New folders are created if they don't exist in the folder structure for the target mailbox.</span></span>  <br/><br/>  <span data-ttu-id="30af0-327">如果指定 `/<foldername>`，則 PST 檔案中的項目和資料夾會匯入為 *\<foldername\>* 的資料夾。</span><span class="sxs-lookup"><span data-stu-id="30af0-327">If you specify  `/<foldername>`, items and folders in the PST file are imported to a folder named  *\<foldername\>*  .</span></span> <span data-ttu-id="30af0-328">例如，如果使用 `/ImportedPst`，則會將項目匯入名為 **ImportedPst** 的資料夾。</span><span class="sxs-lookup"><span data-stu-id="30af0-328">For example, if you use  `/ImportedPst`, items would be imported to a folder named **ImportedPst**.</span></span> <span data-ttu-id="30af0-329">此資料夾將位於與 [收件匣] 資料夾相同層級的使用者信箱中。</span><span class="sxs-lookup"><span data-stu-id="30af0-329">This folder will be located in the user's mailbox at the same level as the Inbox folder.</span></span>  <br/><br/> <span data-ttu-id="30af0-330">**秘訣：** 請考慮執行一些測試批次來嘗試使用這個參數，如此您便能決定哪裡是匯入 PST 檔案的最佳資料夾位置。</span><span class="sxs-lookup"><span data-stu-id="30af0-330">**Tip:** Consider running a few test batches to experiment with this parameter so you can determine the best folder location to import PSTs files to.</span></span>  <br/> |<span data-ttu-id="30af0-331">(保留空白)</span><span class="sxs-lookup"><span data-stu-id="30af0-331">(leave blank)</span></span>  <br/> <span data-ttu-id="30af0-332">或</span><span class="sxs-lookup"><span data-stu-id="30af0-332">Or</span></span>  <br/>  `/` <br/> <span data-ttu-id="30af0-333">或</span><span class="sxs-lookup"><span data-stu-id="30af0-333">Or</span></span>  <br/>  `/ImportedPst` <br/> |
    | `ContentCodePage` <br/> |<span data-ttu-id="30af0-334">此選用參數可指定用於以 ANSI 檔案格式匯入 PST 檔案的字碼頁數值。</span><span class="sxs-lookup"><span data-stu-id="30af0-334">This optional parameter specifies a numeric value for the code page to use for importing PST files in the ANSI file format.</span></span> <span data-ttu-id="30af0-335">此參數用於從中文、日文和韓文 (CJK) 組織匯入 PST 檔案，因為這些語言通常使用雙位元字元集 (DBCS) 進行字元編碼。</span><span class="sxs-lookup"><span data-stu-id="30af0-335">This parameter is used for importing PST files from Chinese, Japanese, and Korean (CJK) organizations because these languages typically use a double byte character set (DBCS) for character encoding.</span></span> <span data-ttu-id="30af0-336">如果此參數不用於匯入使用 DBCS 作為信箱資料夾名稱的語言的 PST 檔案，則匯入後資料夾名稱通常會出現亂碼。</span><span class="sxs-lookup"><span data-stu-id="30af0-336">If this parameter isn't used to import PST files for languages that use DBCS for mailbox folder names, the folder names are often garbled after they're imported.</span></span>  <br/><br/> <span data-ttu-id="30af0-337">如需要用於此參數的支援值清單，請參閱[字碼頁識別碼](https://go.microsoft.com/fwlink/p/?LinkId=328514)。</span><span class="sxs-lookup"><span data-stu-id="30af0-337">For a list of supported values to use for this parameter, see [Code Page Identifiers](https://go.microsoft.com/fwlink/p/?LinkId=328514).</span></span>  <br/> <br/><span data-ttu-id="30af0-338">**注意：** 如前所述，這是一個選用參數，您不必將其包含在 CSV 檔案中。</span><span class="sxs-lookup"><span data-stu-id="30af0-338">**Note:** As previously stated, this is an optional parameter and you don't have to include it in the CSV file.</span></span> <span data-ttu-id="30af0-339">或者您可以包含它並在一或多列中將值保留為空白。</span><span class="sxs-lookup"><span data-stu-id="30af0-339">Or you can include it and leave the value blank for one or more rows.</span></span>  <br/> |<span data-ttu-id="30af0-340">(保留空白)</span><span class="sxs-lookup"><span data-stu-id="30af0-340">(leave blank)</span></span>  <br/> <span data-ttu-id="30af0-341">或</span><span class="sxs-lookup"><span data-stu-id="30af0-341">Or</span></span>  <br/>  <span data-ttu-id="30af0-342">`932` (為 ANSI/OEM 日文的字碼頁識別碼)</span><span class="sxs-lookup"><span data-stu-id="30af0-342">`932` (which is the code page identifier for ANSI/OEM Japanese)</span></span>  <br/> |
    | `SPFileContainer` <br/> |<span data-ttu-id="30af0-343">針對 PST 匯入，請將此參數保留空白。</span><span class="sxs-lookup"><span data-stu-id="30af0-343">For PST Import, leave this parameter blank.</span></span>  <br/> |<span data-ttu-id="30af0-344">不適用</span><span class="sxs-lookup"><span data-stu-id="30af0-344">Not applicable</span></span>  <br/> |
    | `SPManifestContainer` <br/> |<span data-ttu-id="30af0-345">針對 PST 匯入，請將此參數保留空白。</span><span class="sxs-lookup"><span data-stu-id="30af0-345">For PST Import, leave this parameter blank.</span></span>  <br/> |<span data-ttu-id="30af0-346">不適用</span><span class="sxs-lookup"><span data-stu-id="30af0-346">Not applicable</span></span>  <br/> |
    | `SPSiteUrl` <br/> |<span data-ttu-id="30af0-347">針對 PST 匯入，請將此參數保留空白。</span><span class="sxs-lookup"><span data-stu-id="30af0-347">For PST Import, leave this parameter blank.</span></span>  <br/> |<span data-ttu-id="30af0-348">不適用</span><span class="sxs-lookup"><span data-stu-id="30af0-348">Not applicable</span></span>  <br/> |

## <a name="step-5-create-a-pst-import-job-in-office-365"></a><span data-ttu-id="30af0-349">步驟 5：在 Office 365 中建立 PST 匯入工作</span><span class="sxs-lookup"><span data-stu-id="30af0-349">Step 5: Create a PST Import job in Office 365</span></span>

<span data-ttu-id="30af0-350">下一個步驟是在 Office 365 的匯入服務中，建立 PST 匯入工作。</span><span class="sxs-lookup"><span data-stu-id="30af0-350">The next step is to create the PST Import job in the Import service in Office 365.</span></span> <span data-ttu-id="30af0-351">如先前所解釋，您會提交在步驟 4 中所建立的 PST 匯入對應檔案。</span><span class="sxs-lookup"><span data-stu-id="30af0-351">As previously explained, you submit the PST Import mapping file that you created in Step 4.</span></span> <span data-ttu-id="30af0-352">在您建立工作後，Office 365 會分析 PST 檔案中的資料，然後讓您篩選實際匯入 PST 匯入對應檔案中指定信箱的資料 (請參閱[步驟 6](#step-6-filter-data-and-start-the-pst-import-job))。</span><span class="sxs-lookup"><span data-stu-id="30af0-352">After you create the job, Office 365 analyzes the data in the PST files and then gives you an opportunity to filter the data that actually gets imported to the mailboxes specified in the PST import mapping file (see [Step 6](#step-6-filter-data-and-start-the-pst-import-job)).</span></span>
  
1. <span data-ttu-id="30af0-353">前往 [https://protection.office.com](https://protection.office.com)，然後使用您 Office 365 組織中系統管理員帳戶的認證來登入。</span><span class="sxs-lookup"><span data-stu-id="30af0-353">Go to [https://protection.office.com](https://protection.office.com) and sign in using the credentials for an administrator account in your Office 365 organization.</span></span> 
    
2. <span data-ttu-id="30af0-354">在「安全性與合規性中心」的左窗格中，按一下 **[資料控管] > [匯入] > [匯入 PST 檔案]**。</span><span class="sxs-lookup"><span data-stu-id="30af0-354">In the left pane of the Security & Compliance Center, click **Information governance > Import > Import PST files**.</span></span>
    
3. <span data-ttu-id="30af0-355">按一下 **[匯入 PST 檔案]** 頁面上的 ![[新增圖示]](../media/ITPro-EAC-AddIcon.gif) \*\* [新增匯入工作]\*\*。</span><span class="sxs-lookup"><span data-stu-id="30af0-355">On the **Import PST files** page, click ![Add Icon](../media/ITPro-EAC-AddIcon.gif) **New import job**.</span></span>
    
    <span data-ttu-id="30af0-356">**注意：** 您必須獲派適當的權限，才能存取 [安全性與合規性中心] 中的 [匯入]\*\*\*\* 頁面來建立匯入工作。</span><span class="sxs-lookup"><span data-stu-id="30af0-356">**Note:** You have to be assigned the appropriate permissions to access the **Import** page in the Security & Compliance Center to create an import job.</span></span> <span data-ttu-id="30af0-357">如需詳細資訊，請參與**開始之前**這一節。</span><span class="sxs-lookup"><span data-stu-id="30af0-357">See the **Before you begin** section for more information.</span></span> 
    
4. <span data-ttu-id="30af0-358">為 PST 匯入工作輸入名稱，然後按一下 [下一步]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="30af0-358">Type a name for the PST import job, and then click **Next**.</span></span> <span data-ttu-id="30af0-359">請使用小寫字母、數字、連字號和底線。</span><span class="sxs-lookup"><span data-stu-id="30af0-359">Use lowercase letters, numbers, hyphens, and underscores.</span></span> <span data-ttu-id="30af0-360">無法使用大寫字母，且名稱中不得包含空格。</span><span class="sxs-lookup"><span data-stu-id="30af0-360">You can't use uppercase letters or include spaces in the name.</span></span>
    
5. <span data-ttu-id="30af0-361">在 [您要上傳或傳送資料？]\*\*\*\* 頁面上、按一下 [上傳您的資料]\*\*\*\*，然後按一下 [下一步]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="30af0-361">On the **Do you want to upload or ship data?** page, click **Upload your data** and then click **Next**.</span></span>
    
    ![按一下 [上傳您的資料] 來建立網路上傳匯入工作。](../media/e59f9dc3-ccde-44ff-ac38-c4e39d76ae85.png)
  
6. <span data-ttu-id="30af0-363">在步驟 4 中的 [匯入資料]\*\*\*\* 頁面中，按一下 [我已完成上傳檔案]\*\*\*\* 和 [我可以存取對應檔案]\*\*\*\* 核取方塊，接著按 [下一步]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="30af0-363">In step 4 on the **Import data** page, click the **I'm done uploading my files** and **I have access to the mapping file** check boxes, and then click **Next**.</span></span>
    
    ![按一下步驟 4 的兩個核取方塊。](../media/9f2427e8-3af2-4e27-95e6-a9f08430d3d8.png)
  
7. <span data-ttu-id="30af0-365">在 [選取對應檔案]\*\*\*\* 頁面上，按一下 [選取對應檔案]\*\*\*\* 以提交您在步驟 4 中建立的 PST 匯入對應檔案。</span><span class="sxs-lookup"><span data-stu-id="30af0-365">On the **Select the mapping file** page, click **Select mapping file** to submit the PST Import mapping file that you created in Step 4.</span></span> 
    
    ![按一下 [選取對應檔案] 來提交為匯入工作建立的 CSV 檔案](../media/d30b1d73-80bb-491e-a642-a21673d06889.png)
  
8. <span data-ttu-id="30af0-367">在 CSV 檔案名稱出現於 [對應檔案名稱]\*\*\*\* 後，按一下 [驗證]\*\*\*\* 來檢查您的 CSV 檔是否有錯誤。</span><span class="sxs-lookup"><span data-stu-id="30af0-367">After the name of the CSV file appears under **Mapping file name**, click **Validate** to check your CSV file for errors.</span></span> 
    
    ![按一下 [驗證] 檢查 CSV 檔是否有錯誤](../media/4680999d-5538-4059-b878-2736a5445037.png)
  
    <span data-ttu-id="30af0-369">CSV 檔案必須成功通過驗證，才能建立 PST 匯入工作。</span><span class="sxs-lookup"><span data-stu-id="30af0-369">The CSV file has to be successfully validated to create a PST Import job.</span></span> <span data-ttu-id="30af0-370">檔案名稱成功驗證後會變更為綠色。</span><span class="sxs-lookup"><span data-stu-id="30af0-370">The file name is changed to green after it's successfully validated.</span></span> <span data-ttu-id="30af0-371">如果驗證失敗，按一下 [檢視記錄] \*\*\*\* 連結。</span><span class="sxs-lookup"><span data-stu-id="30af0-371">If the validation fails, click the **View log** link.</span></span> <span data-ttu-id="30af0-372">驗證錯誤報告隨即開啟，並針對檔案中每一列有問題項目提供錯誤訊息。</span><span class="sxs-lookup"><span data-stu-id="30af0-372">A validation error report is opened, with an error message for each row in the file that failed.</span></span>
    
9. <span data-ttu-id="30af0-373">PST 對應檔案驗證成功後，請檢閱條款和條件文件，然後按一下核取方塊。</span><span class="sxs-lookup"><span data-stu-id="30af0-373">After the PST mapping file is successfully validated, read the terms and conditions document, and then click the checkbox.</span></span>
    
10. <span data-ttu-id="30af0-374">按一下 [儲存]\*\*\*\* 提交工作，並在工作成功建立後按一下 [關閉]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="30af0-374">Click **Save** to submit the job, and then click **Close** after the job is successfully created.</span></span> 
    
    <span data-ttu-id="30af0-375">狀態彈出頁面隨即顯示，狀態為 **[分析中]**，而新匯入工作會顯示在 **[匯入 PST 檔案]** 頁面的清單中。</span><span class="sxs-lookup"><span data-stu-id="30af0-375">A status flyout page is displayed, with a status of **Analysis in progress** and the new import job is displayed in the list on the **Import PST files** page.</span></span> 
    
11. <span data-ttu-id="30af0-376">按一下 [重新整理]\*\*\*\* [重新整理圖示]![](../media/O365-MDM-Policy-RefreshIcon.gif) 以更新顯示於 [狀態] \*\*\*\* 欄位的狀態資訊。</span><span class="sxs-lookup"><span data-stu-id="30af0-376">Click **Refresh** ![Refresh icon](../media/O365-MDM-Policy-RefreshIcon.gif) to update the status information that's displayed in the **Status** column.</span></span> <span data-ttu-id="30af0-377">分析完成並準備匯入資料後，狀態將變更為 [分析完成]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="30af0-377">When the analysis is complete and the data is ready to be imported, the status is changed to **Analysis completed**.</span></span>
    
    <span data-ttu-id="30af0-378">您可以按一下匯入作業以顯示狀態彈出頁面，其中會包含有關匯入工作的更多詳細訊息，例如對應檔案中列出的每個 PST 檔案的狀態。</span><span class="sxs-lookup"><span data-stu-id="30af0-378">You can click the import job to display the status flyout page, which contains more detailed information about the import job such as the status of each PST file listed in the mapping file.</span></span>
 
## <a name="step-6-filter-data-and-start-the-pst-import-job"></a><span data-ttu-id="30af0-379">步驟 6：篩選資料，並開始 PST 匯入工作</span><span class="sxs-lookup"><span data-stu-id="30af0-379">Step 6: Filter data and start the PST Import job</span></span>

<span data-ttu-id="30af0-380">在步驟 5 建立匯入工作後，Office 365 會以安全的方式分析 PST 檔案中的資料，來識別 PST 檔案所含項目的保存時間和各種訊息類型。</span><span class="sxs-lookup"><span data-stu-id="30af0-380">After you create the import job in Step 5, Office 365 analyzes the data in the PST files (in a safe and secure manner) by identifying the age of the items and the different message types included in the PST files.</span></span> <span data-ttu-id="30af0-381">分析完成且準備好匯入資料後，您可以選擇匯入 PST 檔案中所包含的所有資料，或設定控制匯入資料的篩選條件來調整要匯入的資料。</span><span class="sxs-lookup"><span data-stu-id="30af0-381">When the analysis is completed and the data is ready to import, you have the option to import all the data contained in the PST files or you can trim the data that's imported by setting filters that control what data gets imported.</span></span>
  
1. <span data-ttu-id="30af0-382">在安全性與合規性中心中的 **[匯入 PST 檔案]** 頁面上，為您在步驟 5 建立的匯入工作按一下 **[準備好匯入到 Office 365]**。</span><span class="sxs-lookup"><span data-stu-id="30af0-382">On the **Import PST files** page in the Security & Compliance Center, click **Ready to import to Office 365** for the import job that you created in Step 5.</span></span> 
    
    ![在您建立的匯入工作旁按一下 [準備好匯入到 Office 365]](../media/5760aac3-300b-4e31-b894-253c42a4b82b.png)
  
    <span data-ttu-id="30af0-384">隨即會顯示彈出頁面，以及關於該匯入工作的 PST 檔案資訊和其他資訊。</span><span class="sxs-lookup"><span data-stu-id="30af0-384">A fly out page is displayed with information about the PST files and other information about the import job.</span></span>
    
2. <span data-ttu-id="30af0-385">在彈出頁面上，按一下 [匯入到 Office 365]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="30af0-385">On the flyout page, click **Import to Office 365**.</span></span>
    
    <span data-ttu-id="30af0-386">隨即會顯示 [篩選您的資料]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="30af0-386">The **Filter your data** page is displayed.</span></span> <span data-ttu-id="30af0-387">它包含 Office 365 對 PST 檔案執行分析後所產生的資料見解，包括有關資料壽命的資訊。</span><span class="sxs-lookup"><span data-stu-id="30af0-387">It contains the data insights resulting from the analysis performed on the PST files by Office 365, including information about the age of the data.</span></span> <span data-ttu-id="30af0-388">此時，您可以選擇篩選要匯入的資料或按原樣匯入所有資料。</span><span class="sxs-lookup"><span data-stu-id="30af0-388">At this point, you have the option to filter the data that will be imported or import all the data as is.</span></span> 
    
    ![您可以修剪 PST 檔案中的資料或匯入所有資料](../media/287fc030-99e9-417b-ace7-f64617ea5d4e.png)
  
3. <span data-ttu-id="30af0-390">執行下列其中一項動作：</span><span class="sxs-lookup"><span data-stu-id="30af0-390">Do one of the following:</span></span>
    
    <span data-ttu-id="30af0-391">a.</span><span class="sxs-lookup"><span data-stu-id="30af0-391">a.</span></span> <span data-ttu-id="30af0-392">若要修剪您匯入的資料，請按一下 [是，我要在匯入前先篩選]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="30af0-392">To trim the data that you import, click **Yes, I want to filter it before importing**.</span></span>
    
    <span data-ttu-id="30af0-393">如需篩選 PST 檔案中的資料，然後開始匯入工作的逐步說明，請參閱[將 PST 檔案匯入 Office 365 時篩選資料](filter-data-when-importing-pst-files.md)。</span><span class="sxs-lookup"><span data-stu-id="30af0-393">For detailed step-by-step instructions about filtering the data in the PST files and then starting the import job, see [Filter data when importing PST files to Office 365](filter-data-when-importing-pst-files.md).</span></span>
    
    <span data-ttu-id="30af0-394">或</span><span class="sxs-lookup"><span data-stu-id="30af0-394">Or</span></span>
    
    <span data-ttu-id="30af0-395">b.</span><span class="sxs-lookup"><span data-stu-id="30af0-395">b.</span></span> <span data-ttu-id="30af0-396">若要匯入 PST 檔案中的所有資料，請按一下 [否，我想要匯入所有項目]\*\*\*\*，再按一下 [下一步]\*\*\*\*。</span><span class="sxs-lookup"><span data-stu-id="30af0-396">To import all data in the PST files, click **No, I want to import everything,** and click **Next**.</span></span>
    
4. <span data-ttu-id="30af0-397">如果選擇匯入所有資料，請按一下 [匯入資料]\*\*\*\* 以開始匯入工作。</span><span class="sxs-lookup"><span data-stu-id="30af0-397">If you chose to import all the data, click **Import data** to start the import job.</span></span> 
    
    <span data-ttu-id="30af0-398">匯入工作的狀態會顯示在 **[匯入 PST 檔案]** 頁面。</span><span class="sxs-lookup"><span data-stu-id="30af0-398">The status of the import job is display on the **Import PST files** page.</span></span> <span data-ttu-id="30af0-399">按一下 ![重新整理圖示](../media/O365-MDM-Policy-RefreshIcon.gif) [重新整理]\*\*\*\* 以更新 [狀態] \*\*\*\* 欄位中顯示的狀態資訊。</span><span class="sxs-lookup"><span data-stu-id="30af0-399">Click ![Refresh icon](../media/O365-MDM-Policy-RefreshIcon.gif) **Refresh** to update the status information that's displayed in the **Status** column.</span></span> <span data-ttu-id="30af0-400">按一下 [匯入工作] 以顯示狀態彈出頁面，這會顯示匯入的每個 PST 檔案的狀態資訊。</span><span class="sxs-lookup"><span data-stu-id="30af0-400">Click the import job to display the status flyout page, which displays status information about each PST file being imported.</span></span> 

## <a name="how-the-import-process-works"></a><span data-ttu-id="30af0-401">程序的運作方式</span><span class="sxs-lookup"><span data-stu-id="30af0-401">How the import process works</span></span>
  
<span data-ttu-id="30af0-402">您可以使用網路上傳選項和 Office 365 匯入服務將 PST 檔案大量匯入到使用者信箱。</span><span class="sxs-lookup"><span data-stu-id="30af0-402">You can use the network upload option and the Office 365 Import service to bulk-import PST files to user mailboxes.</span></span> <span data-ttu-id="30af0-403">網路上傳表示，您將 PST 檔案上傳至 Microsoft 雲端中的暫時儲存體區域。</span><span class="sxs-lookup"><span data-stu-id="30af0-403">Network upload means that you upload the PST files a temporary storage area in the Microsoft cloud.</span></span> <span data-ttu-id="30af0-404">然後 Office 365 匯入服務會從儲存體區域將 PST 檔案複製到目標使用者信箱。</span><span class="sxs-lookup"><span data-stu-id="30af0-404">Then the Office 365 Import service copies the PST files from the storage area to the target user mailboxes.</span></span>
  
<span data-ttu-id="30af0-405">以下是將 PST 檔案匯入 Office 365 中的信箱時使用網路上傳的程序說明。</span><span class="sxs-lookup"><span data-stu-id="30af0-405">Here's an illustration and description of the network upload process to import PST files to mailboxes in Office 365.</span></span>
  
![使用網路上傳將 PST 檔案匯入 Office 365 的工作流程](../media/9e05a19e-1e7a-4f1f-82df-9118f51588c4.png)
  
1. <span data-ttu-id="30af0-407">**將 PST 匯入工具和金鑰下載到私人 Azure 儲存體位置：** 第一個步驟是下載 AzCopy 命令列工具和存取金鑰，以用於將 PST 檔案上傳到 Microsoft 雲端中 Azure 儲存體位置。</span><span class="sxs-lookup"><span data-stu-id="30af0-407">**Download the PST import tool and key to private Azure Storage location:** The first step is to download the AzCopy command-line tool and an access key used to upload the PST files to an Azure Storage location in the Microsoft cloud.</span></span> <span data-ttu-id="30af0-408">您可以從安全性與合規性中心的[匯入]\*\*\*\* 頁面取得這些工具和金鑰。</span><span class="sxs-lookup"><span data-stu-id="30af0-408">You obtain these from the **Import** page in the Security & Compliance Center.</span></span> <span data-ttu-id="30af0-409">金鑰 (稱為安全存取簽章 (SAS)) 會提供您必要的權限，以將 PST 檔案上傳到私人且安全的 Azure 儲存體位置。</span><span class="sxs-lookup"><span data-stu-id="30af0-409">The key (called a secure access signature (SAS) key, provides you with the necessary permissions to upload PST files to a private and secure Azure Storage location.</span></span> <span data-ttu-id="30af0-410">此存取金鑰專屬於貴組織，並可在 PST 檔案上傳到 Microsoft 雲端後，協助防止未經授權存取 PST 檔案。</span><span class="sxs-lookup"><span data-stu-id="30af0-410">This access key is unique to your organization and helps prevent unauthorized access to your PST files after they're uploaded to the Microsoft cloud.</span></span> <span data-ttu-id="30af0-411">將 PST 檔案匯入至 Office 365 不會要求貴組織具有不同的 Azure 訂閱。</span><span class="sxs-lookup"><span data-stu-id="30af0-411">Importing PST files to Office 365 doesn't require your organization to have a separate Azure subscription.</span></span> 
    
2. <span data-ttu-id="30af0-412">**將 PST 檔案上傳到 Azure 儲存體位置：** 下一個步驟是使用 AzCopy.exe 工具 (於步驟 1 中下載) 將您的 PST 檔案上傳並儲存在 Azure 儲存體位置，該位置位於與 Office 365 組織所在位置相同的 Microsoft 資料中心。</span><span class="sxs-lookup"><span data-stu-id="30af0-412">**Upload the PST files to the Azure Storage location:** The next step is to use the AzCopy.exe tool (downloaded in step 1) to upload and store your PST files in an Azure Storage location that resides in the same regional Microsoft datacenter where your Office 365 organization is located.</span></span> <span data-ttu-id="30af0-413">若要上傳，您想要匯入 Office 365 的 PST 檔案必須位於組織中的檔案共用或檔案伺服器。</span><span class="sxs-lookup"><span data-stu-id="30af0-413">To upload them, the PST files that you want to import to Office 365 have to be located in a file share or file server in your organization.</span></span>
    
    <span data-ttu-id="30af0-414">可以執行一個選用步驟，以便在 PST 檔案上傳到 Azure 儲存體位置後檢視檔案清單。</span><span class="sxs-lookup"><span data-stu-id="30af0-414">There's an optional step that you can perform to view the list of PST files after they're uploaded to the Azure Storage location.</span></span>
    
3. <span data-ttu-id="30af0-415">**建立 PST 匯入對應檔案：** 將 PST 檔案上傳到 Azure 儲存體位置後，下一個步驟是建立逗點分隔值 (CSV) 檔案，以指定要匯入 PST 檔案的使用者信箱，請注意，PST 檔案可匯入使用者的主要信箱或封存信箱。</span><span class="sxs-lookup"><span data-stu-id="30af0-415">**Create a PST import mapping file:** After the PST files have been uploaded to the Azure Storage location, the next step is to create a comma-separated value (CSV) file that specifies which user mailboxes the PST files will be imported to, note that a PST file can be imported to a user's primary mailbox or their archive mailbox.</span></span> <span data-ttu-id="30af0-416">Office 365 匯入服務會使用 CSV 檔案中的資訊來匯入 PST 檔案。</span><span class="sxs-lookup"><span data-stu-id="30af0-416">The Office 365 Import service uses the information in the CSV file to import the PST files.</span></span>
    
4. <span data-ttu-id="30af0-417">**建立 PST 匯入工作：** 下一個步驟是在安全性與合規性中心的 **[匯入 PST 檔案]** 頁面建立 PST 匯入工作，然後提交上一個步驟中建立的 PST 匯入對應檔案。</span><span class="sxs-lookup"><span data-stu-id="30af0-417">**Create a PST import job:** The next step is to create a PST import job on the **Import PST files** page in the Security & Compliance Center and submit the PST import mapping file created in the previous step.</span></span> <span data-ttu-id="30af0-418">建立匯入工作後，Office 365 會分析 PST 檔案中的資料，然後讓您設定篩選條件，以控制哪些資料會實際匯入 PST 匯入對應檔案中指定的信箱。</span><span class="sxs-lookup"><span data-stu-id="30af0-418">After you create the import job, Office 365 analyzes the data in the PST files and then gives you an opportunity to set filters that control what data actually gets imported to the mailboxes specified in the PST import mapping file.</span></span> 
    
5. <span data-ttu-id="30af0-419">**篩選將匯入信箱的 PST 資料：** 建立匯入工作並開始後，Office 365 會透過識別 PST 檔案中包含的項目的壽命和不同的訊息類型安全地分析 PST 檔案中的資料。</span><span class="sxs-lookup"><span data-stu-id="30af0-419">**Filter the PST data that will be imported to mailboxes:** After the import job is created and started, Office 365 analyzes the data in the PST files (safely and securely) by identifying the age of the items and the different message types included in the PST files.</span></span> <span data-ttu-id="30af0-420">分析完成且準備好匯入資料後，您可以選擇匯入 PST 檔案中所包含的所有資料，或設定控制匯入資料的篩選條件來調整要匯入的資料。</span><span class="sxs-lookup"><span data-stu-id="30af0-420">When the analysis is completed and the data is ready to import, you have the option to import all the data contained in the PST files or you can trim the data that's imported by setting filters that control what data gets imported.</span></span>
    
6. <span data-ttu-id="30af0-421">**開始 PST 匯入工作：** 開始匯入工作後，Office 365 會使用 PST 匯入對應檔案中的資訊，將 PST 檔案從 Azure 儲存體位置匯入至使用者信箱。</span><span class="sxs-lookup"><span data-stu-id="30af0-421">**Start the PST import job:** After the import job is started, Office 365 uses the information in the PST import mapping file to import the PSTs files from the he Azure Storage location to user mailboxes.</span></span> <span data-ttu-id="30af0-422">匯入工作的狀態資訊 (包括匯入的每個 PST 檔案的相關資訊) 會顯示在安全性與合規性中心的 **[匯入 PST 檔案]** 頁面。</span><span class="sxs-lookup"><span data-stu-id="30af0-422">Status information about the import job (including information about each PST file being imported) is displayed on the **Import PST files** page in the Security & Compliance Center.</span></span> <span data-ttu-id="30af0-423">匯入工作完成時，工作的狀態會設為**完成**。</span><span class="sxs-lookup"><span data-stu-id="30af0-423">When the import job is finished, the status for the job is set to **Complete**.</span></span>
  
## <a name="more-information"></a><span data-ttu-id="30af0-424">詳細資訊</span><span class="sxs-lookup"><span data-stu-id="30af0-424">More information</span></span>

- <span data-ttu-id="30af0-425">為什麼要將 PST 檔案匯入 Office 365？</span><span class="sxs-lookup"><span data-stu-id="30af0-425">Why import PST files to Office 365?</span></span>
    
  - <span data-ttu-id="30af0-426">這是將組織的封存訊息資料匯入 Office 365 的好方法。</span><span class="sxs-lookup"><span data-stu-id="30af0-426">It's a good way to import your organization's archival messaging data to Office 365.</span></span>
    
  - <span data-ttu-id="30af0-427">訊息資料儲存在雲端上，因此使用者從所有的裝置都能取得資料。</span><span class="sxs-lookup"><span data-stu-id="30af0-427">The data is available to the user from all devices because it's stored in the cloud.</span></span>
    
  - <span data-ttu-id="30af0-428">它允許您將 Office 365 合規性功能應用於匯入的 PST 檔案中的資料，進而有助於滿足組織的合規性需求。</span><span class="sxs-lookup"><span data-stu-id="30af0-428">It helps address compliance needs of your organization by letting you apply Office 365 compliance features to the data from the PST files that you imported.</span></span> <span data-ttu-id="30af0-429">這包括：</span><span class="sxs-lookup"><span data-stu-id="30af0-429">This includes:</span></span>
    
  - <span data-ttu-id="30af0-430">啟用[封存信箱](enable-archive-mailboxes.md) 和[自動延長封存](enable-unlimited-archiving.md)，為使用者提供額外的信箱儲存空間，以儲存您匯入的資料。</span><span class="sxs-lookup"><span data-stu-id="30af0-430">Enabling [archive mailboxes](enable-archive-mailboxes.md) and [auto-expanding archiving](enable-unlimited-archiving.md) to give users additional mailbox storage space to store the data that you imported.</span></span> 
    
  - <span data-ttu-id="30af0-431">將信箱置於[訴訟資料暫留](https://go.microsoft.com/fwlink/?linkid=856286)，以保留您匯入的資料。</span><span class="sxs-lookup"><span data-stu-id="30af0-431">Placing mailboxes on [Litigation Hold](https://go.microsoft.com/fwlink/?linkid=856286) to retain the data that you imported.</span></span> 
    
  - <span data-ttu-id="30af0-432">使用 [Microsoft eDiscovery](search-for-content.md) 工具搜尋您匯入的資料。</span><span class="sxs-lookup"><span data-stu-id="30af0-432">Using Microsoft [eDiscovery tools](search-for-content.md) to search the data that you imported.</span></span> 
    
  - <span data-ttu-id="30af0-433">使用 [Office 365 保留原則](retention-policies.md) 控制匯入資料的保留時間，以及保留期間到期後要採取的動作。</span><span class="sxs-lookup"><span data-stu-id="30af0-433">Using [Office 365 retention policies](retention-policies.md) to control how long the data that you imported will be retained, and what action to take after the retention period expires.</span></span> 
    
  - <span data-ttu-id="30af0-434">搜尋 [Office 365 稽核記錄](search-the-audit-log-in-security-and-compliance.md)，以尋找會影響您匯入資料的信箱相關事件。</span><span class="sxs-lookup"><span data-stu-id="30af0-434">Searching the [Office 365 audit log](search-the-audit-log-in-security-and-compliance.md) for mailbox-related events that affect the data that you imported.</span></span> 
    
  - <span data-ttu-id="30af0-435">將資料匯入[非作用中信箱](create-and-manage-inactive-mailboxes.md)以封存資料，來符合合規性目的。</span><span class="sxs-lookup"><span data-stu-id="30af0-435">Importing data to [inactive mailboxes](create-and-manage-inactive-mailboxes.md) to archive data for compliance purposes.</span></span> 
    
  - <span data-ttu-id="30af0-436">使用[資料遺失防護原則](data-loss-prevention-policies.md)來防止敏感資料洩露到組織外部。</span><span class="sxs-lookup"><span data-stu-id="30af0-436">Using [data loss prevention policies](data-loss-prevention-policies.md) to prevent sensitive data from leaking outside your organization.</span></span> 
  
- <span data-ttu-id="30af0-437">以下是在步驟 1 所取得的共用存取簽章(SAS) URL 範例。</span><span class="sxs-lookup"><span data-stu-id="30af0-437">Here's an example of the Shared Access Signature (SAS) URL that's obtained in Step 1.</span></span> <span data-ttu-id="30af0-438">此範例也包含您在 AzCopy.exe 工具中，用來將 PST 檔案上傳至 Office 365 所執行命令的語法。</span><span class="sxs-lookup"><span data-stu-id="30af0-438">This example also contains the syntax for the command that you run in the AzCopy.exe tool to upload PST files to Office 365.</span></span> <span data-ttu-id="30af0-439">請務必採取預防措施來保護 SAS URL，就如同您保護密碼或其他安全性相關的資訊一樣。</span><span class="sxs-lookup"><span data-stu-id="30af0-439">Be sure to take precautions to protect the SAS URL just like you would protect passwords or other security-related information.</span></span>

    ```text
    SAS URL: https://3c3e5952a2764023ad14984.blob.core.windows.net/ingestiondata?sv=2012-02-12&amp;se=9999-12-31T23%3A59%3A59Z&amp;sr=c&amp;si=IngestionSasForAzCopy201601121920498117&amp;sig=Vt5S4hVzlzMcBkuH8bH711atBffdrOS72TlV1mNdORg%3D

    AzCopy.exe /Source:<Location of PST files> /Dest:<SAS URL> /V:<Log file location> /Y

    EXAMPLES

    This example uploads PST files to the root of the Azure storage location:

    AzCopy.exe /Source:"\\FILESERVER1\PSTs" /Dest:"https://3c3e5952a2764023ad14984.blob.core.windows.net/ingestiondata?sv=2012-02-12&amp;se=9999-12-31T23%3A59%3A59Z&amp;sr=c&amp;si=IngestionSasForAzCopy201601121920498117&amp;sig=Vt5S4hVzlzMcBkuH8bH711atBffdrOS72TlV1mNdORg%3D" /V:"c:\Users\Admin\Desktop\AzCopy1.log" /Y
    
    This example uploads PST files to a subfolder named PSTFiles  in the Azure storage location:

    AzCopy.exe /Source:"\\FILESERVER1\PSTs" /Dest:"https://3c3e5952a2764023ad14984.blob.core.windows.net/ingestiondata/PSTFiles?sv=2012-02-12&amp;se=9999-12-31T23%3A59%3A59Z&amp;sr=c&amp;si=IngestionSasForAzCopy201601121920498117&amp;sig=Vt5S4hVzlzMcBkuH8bH711atBffdrOS72TlV1mNdORg%3D" /V:"c:\Users\Admin\Desktop\AzCopy1.log" /Y
    ```

- <span data-ttu-id="30af0-440">如先前說明，PST 檔案匯入到信箱之後， Office 365 匯入服務的暫停保留設定會開啟 (為無限期)。</span><span class="sxs-lookup"><span data-stu-id="30af0-440">As previously explained, the Office 365 Import service turns on the retention hold setting (for an indefinite duration) after PST files are imported to a mailbox.</span></span> <span data-ttu-id="30af0-441">這表示 *RetentionHoldEnabled* 屬性設定為 **True**，因此系統不會處理指派給信箱的保留原則。</span><span class="sxs-lookup"><span data-stu-id="30af0-441">This means the  *RetentionHoldEnabled*  property is set to  **True** so that the retention policy assigned to the mailbox won't be processed.</span></span> <span data-ttu-id="30af0-442">防止刪除或封存原則可防止刪除或封存較舊的郵件，這讓信箱擁有者有時間管理新匯入的郵件。</span><span class="sxs-lookup"><span data-stu-id="30af0-442">This gives the mailbox owner time to manage the newly imported messages by preventing a deletion or archive policy from deleting or archiving older messages.</span></span> <span data-ttu-id="30af0-443">這裡是您管理此暫停保留可採取的一些步驟：</span><span class="sxs-lookup"><span data-stu-id="30af0-443">Here are some steps you can take to manage this retention hold:</span></span> 
    
    - <span data-ttu-id="30af0-444">一段時間之後，您可以執行 **Set-Mailbox -RetentionHoldEnabled $false** 命令來關閉暫停保留。</span><span class="sxs-lookup"><span data-stu-id="30af0-444">After a certain time, you can turn off the retention hold by running the **Set-Mailbox -RetentionHoldEnabled $false** command.</span></span> <span data-ttu-id="30af0-445">如需指示，請參閱[將信箱設為暫停保留](https://go.microsoft.com/fwlink/p/?LinkId=544749)。</span><span class="sxs-lookup"><span data-stu-id="30af0-445">For instructions, see [Place a mailbox on retention hold](https://go.microsoft.com/fwlink/p/?LinkId=544749).</span></span>
    
   - <span data-ttu-id="30af0-446">您可以設定暫停保留，讓它在未來某一天關閉。</span><span class="sxs-lookup"><span data-stu-id="30af0-446">You can configure the retention hold so that it's turned off on some date in the future.</span></span> <span data-ttu-id="30af0-447">方法是執行 **Set-Mailbox -EndDateForRetentionHold *date*** 命令。</span><span class="sxs-lookup"><span data-stu-id="30af0-447">You do this by running the **Set-Mailbox -EndDateForRetentionHold *date*** command.</span></span> <span data-ttu-id="30af0-448">例如，假設今天的日期是 2016 年 6 月 1 日，而您想要在 30 天時關閉暫停保留，您可以執行下列命令：**Set-Mailbox -EndDateForRetentionHold 7/1/2016**。</span><span class="sxs-lookup"><span data-stu-id="30af0-448">For example, assuming that today's date is June 1, 2016 and you want the retention hold turned off in 30 days, you would run the following command:  **Set-Mailbox -EndDateForRetentionHold 7/1/2016**.</span></span> <span data-ttu-id="30af0-449">在這個案例中，您會將 **RetentionHoldEnabled** 屬性設定成 *True*。</span><span class="sxs-lookup"><span data-stu-id="30af0-449">In this scenario, you would leave the  **RetentionHoldEnabled**  property set to  *True*.</span></span> <span data-ttu-id="30af0-450">如需詳細資訊，請參閱 [Set-Mailbox](https://go.microsoft.com/fwlink/p/?LinkId=150317)。</span><span class="sxs-lookup"><span data-stu-id="30af0-450">For more information, see [Set-Mailbox](https://go.microsoft.com/fwlink/p/?LinkId=150317).</span></span>
    
   - <span data-ttu-id="30af0-451">您可以變更指派給信箱的保留原則設定，讓匯入的舊項目不會被立即刪除或移至使用者的封存信箱。</span><span class="sxs-lookup"><span data-stu-id="30af0-451">You can change the settings for the retention policy that's assigned to the mailbox so that older items that were imported won't be immediately deleted or moved to the user's archive mailbox.</span></span> <span data-ttu-id="30af0-452">例如，您可以延長指派給信箱的刪除或封存原則的保留存留期。</span><span class="sxs-lookup"><span data-stu-id="30af0-452">For example, you could lengthen the retention age for a deletion or archive policy that's assigned to the mailbox.</span></span> <span data-ttu-id="30af0-453">在這個案例中，您會在變更保留原則設定之後，關閉信箱的暫停保留。</span><span class="sxs-lookup"><span data-stu-id="30af0-453">In this scenario, you would turn off the retention hold on the mailbox after you changed the settings of the retention policy.</span></span> <span data-ttu-id="30af0-454">如需詳細資訊，請參閱[設定您 Office 365 組織中的信箱封存和刪除原則](set-up-an-archive-and-deletion-policy-for-mailboxes.md)。</span><span class="sxs-lookup"><span data-stu-id="30af0-454">For more information, see [Set up an archive and deletion policy for mailboxes in your Office 365 organization](set-up-an-archive-and-deletion-policy-for-mailboxes.md).</span></span>
